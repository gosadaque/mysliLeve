!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Tabulator=t()}(this,function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}function a(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,o,a,r=s(e);if(t){var u=s(this).constructor;n=Reflect.construct(r,arguments,u)}else n=r.apply(this,arguments);return o=this,(a=n)&&("object"==typeof a||"function"==typeof a)?a:l(o)}}function h(e,t){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s,r=!0,l=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return r=e.done,e},e:function(e){l=!0,s=e},f:function(){try{r||null==a.return||a.return()}finally{if(l)throw s}}}}var c=function(){function e(n){t(this,e),this.table=n}return o(e,[{key:"reloadData",value:function(e,t){return this.table.dataLoader.load(e,void 0,void 0,void 0,t)}},{key:"langText",value:function(){var e;return(e=this.table.modules.localize).getText.apply(e,arguments)}},{key:"langBind",value:function(){var e;return(e=this.table.modules.localize).bind.apply(e,arguments)}},{key:"langLocale",value:function(){var e;return(e=this.table.modules.localize).getLocale.apply(e,arguments)}},{key:"commsConnections",value:function(){var e;return(e=this.table.modules.comms).getConnections.apply(e,arguments)}},{key:"commsSend",value:function(){var e;return(e=this.table.modules.comms).send.apply(e,arguments)}},{key:"layoutMode",value:function(){return this.table.modules.layout.getMode()}},{key:"layoutRefresh",value:function(){return this.table.modules.layout.layout()}},{key:"subscribe",value:function(){var e;return(e=this.table.eventBus).subscribe.apply(e,arguments)}},{key:"unsubscribe",value:function(){var e;return(e=this.table.eventBus).unsubscribe.apply(e,arguments)}},{key:"subscribed",value:function(e){return this.table.eventBus.subscribed(e)}},{key:"subscriptionChange",value:function(){var e;return(e=this.table.eventBus).subscriptionChange.apply(e,arguments)}},{key:"dispatch",value:function(){var e;return(e=this.table.eventBus).dispatch.apply(e,arguments)}},{key:"chain",value:function(){var e;return(e=this.table.eventBus).chain.apply(e,arguments)}},{key:"confirm",value:function(){var e;return(e=this.table.eventBus).confirm.apply(e,arguments)}},{key:"dispatchExternal",value:function(){var e;return(e=this.table.externalEvents).dispatch.apply(e,arguments)}},{key:"subscribedExternal",value:function(e){return this.table.externalEvents.subscribed(e)}},{key:"subscriptionChangeExternal",value:function(){var e;return(e=this.table.externalEvents).subscriptionChange.apply(e,arguments)}},{key:"options",value:function(e){return this.table.options[e]}},{key:"setOption",value:function(e,t){return void 0!==t&&(this.table.options[e]=t),this.table.options[e]}},{key:"module",value:function(e){return this.table.module(e)}}]),e}(),d=function(){function e(n){return t(this,e),this._column=n,this.type="ColumnComponent",new Proxy(this,{get:function(e,t,n){return void 0!==e[t]?e[t]:e._column.table.componentFunctionBinder.handle("column",e._column,t)}})}return o(e,[{key:"getElement",value:function(){return this._column.getElement()}},{key:"getDefinition",value:function(){return this._column.getDefinition()}},{key:"getField",value:function(){return this._column.getField()}},{key:"getTitleDownload",value:function(){return this._column.getTitleDownload()}},{key:"getCells",value:function(){var e=[];return this._column.cells.forEach(function(t){e.push(t.getComponent())}),e}},{key:"isVisible",value:function(){return this._column.visible}},{key:"show",value:function(){this._column.isGroup?this._column.columns.forEach(function(e){e.show()}):this._column.show()}},{key:"hide",value:function(){this._column.isGroup?this._column.columns.forEach(function(e){e.hide()}):this._column.hide()}},{key:"toggle",value:function(){this._column.visible?this.hide():this.show()}},{key:"delete",value:function(){return this._column.delete()}},{key:"getSubColumns",value:function(){var e=[];return this._column.columns.length&&this._column.columns.forEach(function(t){e.push(t.getComponent())}),e}},{key:"getParentColumn",value:function(){return this._column.parent instanceof g&&this._column.parent.getComponent()}},{key:"_getSelf",value:function(){return this._column}},{key:"scrollTo",value:function(){return this._column.table.columnManager.scrollToColumn(this._column)}},{key:"getTable",value:function(){return this._column.table}},{key:"move",value:function(e,t){var n=this._column.table.columnManager.findColumn(e);n?this._column.table.columnManager.moveColumn(this._column,n,t):console.warn("Move Error - No matching column found:",n)}},{key:"getNextColumn",value:function(){var e=this._column.nextColumn();return!!e&&e.getComponent()}},{key:"getPrevColumn",value:function(){var e=this._column.prevColumn();return!!e&&e.getComponent()}},{key:"updateDefinition",value:function(e){return this._column.updateDefinition(e)}},{key:"getWidth",value:function(){return this._column.getWidth()}},{key:"setWidth",value:function(e){var t;return t=!0===e?this._column.reinitializeWidth(!0):this._column.setWidth(e),this._column.table.columnManager.renderer.rerenderColumns(!0),t}}]),e}(),p={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,maxInitialWidth:void 0,cssClass:void 0,variableHeight:void 0,headerVertical:void 0,headerHozAlign:void 0,editableTitle:void 0},m=function(){function e(n){return t(this,e),this._cell=n,new Proxy(this,{get:function(e,t,n){return void 0!==e[t]?e[t]:e._cell.table.componentFunctionBinder.handle("cell",e._cell,t)}})}return o(e,[{key:"getValue",value:function(){return this._cell.getValue()}},{key:"getOldValue",value:function(){return this._cell.getOldValue()}},{key:"getInitialValue",value:function(){return this._cell.initialValue}},{key:"getElement",value:function(){return this._cell.getElement()}},{key:"getRow",value:function(){return this._cell.row.getComponent()}},{key:"getData",value:function(){return this._cell.row.getData()}},{key:"getField",value:function(){return this._cell.column.getField()}},{key:"getColumn",value:function(){return this._cell.column.getComponent()}},{key:"setValue",value:function(e,t){void 0===t&&(t=!0),this._cell.setValue(e,t)}},{key:"restoreOldValue",value:function(){this._cell.setValueActual(this._cell.getOldValue())}},{key:"restoreInitialValue",value:function(){this._cell.setValueActual(this._cell.initialValue)}},{key:"checkHeight",value:function(){this._cell.checkHeight()}},{key:"getTable",value:function(){return this._cell.table}},{key:"_getSelf",value:function(){return this._cell}}]),e}(),f=function(n){a(r,c);var s=u(r);function r(e,n){var o;return t(this,r),(o=s.call(this,e.table)).table=e.table,o.column=e,o.row=n,o.element=null,o.value=null,o.initialValue,o.oldValue=null,o.modules={},o.height=null,o.width=null,o.minWidth=null,o.component=null,o.loaded=!1,o.build(),o}return o(r,[{key:"build",value:function(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}},{key:"generateElement",value:function(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.element=this.element}},{key:"_configureCell",value:function(){var e=this.element,t=this.column.getField();e.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(e.style.display="inline-flex",e.style.alignItems=({top:"flex-start",bottom:"flex-end",middle:"center"})[this.column.vertAlign]||"",this.column.hozAlign&&(e.style.justifyContent=({left:"flex-start",right:"flex-end",center:"center"})[this.column.hozAlign]||"")),t&&e.setAttribute("tabulator-field",t),this.column.definition.cssClass&&this.column.definition.cssClass.split(" ").forEach(function(t){e.classList.add(t)}),this.dispatch("cell-init",this),this.column.visible||this.hide()}},{key:"_generateContents",value:function(){var t,n=this;switch(e(t=this.chain("cell-format",this,null,function(){return n.element.innerHTML=n.value}))){case"object":if(t instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(t)}else this.element.innerHTML="",null!=t&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",t);break;case"undefined":case"null":this.element.innerHTML="";break;default:this.element.innerHTML=t}}},{key:"cellRendered",value:function(){this.dispatch("cell-rendered",this)}},{key:"getElement",value:function(e){return this.loaded||(this.loaded=!0,e||this.layoutElement()),this.element}},{key:"getValue",value:function(){return this.value}},{key:"getOldValue",value:function(){return this.oldValue}},{key:"setValue",value:function(e,t,n){this.setValueProcessData(e,t,n)&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.column.definition.cellEdited&&this.column.definition.cellEdited.call(this.table,this.getComponent()),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}},{key:"setValueProcessData",value:function(e,t,n){var o=!1;return(this.value!==e||n)&&(o=!0,t&&(e=this.chain("cell-value-changing",[this,e],null,e))),this.setValueActual(e),o&&this.dispatch("cell-value-changed",this),o}},{key:"setValueActual",value:function(e){this.oldValue=this.value,this.value=e,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,e),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}},{key:"layoutElement",value:function(){this._generateContents(),this.dispatch("cell-layout",this)}},{key:"setWidth",value:function(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}},{key:"clearWidth",value:function(){this.width="",this.element.style.width=""}},{key:"getWidth",value:function(){return this.width||this.element.offsetWidth}},{key:"setMinWidth",value:function(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}},{key:"setMaxWidth",value:function(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}},{key:"checkHeight",value:function(){this.row.reinitializeHeight()}},{key:"clearHeight",value:function(){this.element.style.height="",this.height=null,this.dispatch("cell-height",this,"")}},{key:"setHeight",value:function(){this.height=this.row.height,this.element.style.height=this.row.heightStyled,this.dispatch("cell-height",this,this.row.heightStyled)}},{key:"getHeight",value:function(){return this.height||this.element.offsetHeight}},{key:"show",value:function(){this.element.style.display=this.column.vertAlign?"inline-flex":""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"delete",value:function(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}},{key:"getIndex",value:function(){return this.row.getCellIndex(this)}},{key:"getComponent",value:function(){return this.component||(this.component=new m(this)),this.component}}]),r}(),g=function(n){a(r,c);var s=u(r);function r(e,n){var o;return t(this,r),(o=s.call(this,n.table)).definition=e,o.parent=n,o.type="column",o.columns=[],o.cells=[],o.element=o.createElement(),o.contentElement=!1,o.titleHolderElement=!1,o.titleElement=!1,o.groupElement=o.createGroupElement(),o.isGroup=!1,o.hozAlign="",o.vertAlign="",o.field="",o.fieldStructure="",o.getFieldValue="",o.setFieldValue="",o.titleDownload=null,o.titleFormatterRendered=!1,o.mapDefinitions(),o.setField(o.definition.field),o.modules={},o.width=null,o.widthStyled="",o.maxWidth=null,o.maxWidthStyled="",o.maxInitialWidth=null,o.minWidth=null,o.minWidthStyled="",o.widthFixed=!1,o.visible=!0,o.component=null,o.definition.columns?(o.isGroup=!0,o.definition.columns.forEach(function(e,t){var n=new r(e,l(o));o.attachColumn(n)}),o.checkColumnVisibility()):n.registerColumnField(l(o)),o._initialize(),o.bindModuleColumns(),o}return o(r,[{key:"createElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-col"),e.setAttribute("role","columnheader"),e.setAttribute("aria-sort","none"),e}},{key:"createGroupElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-col-group-cols"),e}},{key:"mapDefinitions",value:function(){var e=this.table.options.columnDefaults;if(e)for(var t in e)void 0===this.definition[t]&&(this.definition[t]=e[t]);this.definition=this.table.columnManager.optionsList.generate(r.defaultOptionList,this.definition)}},{key:"checkDefinition",value:function(){var e=this;Object.keys(this.definition).forEach(function(t){-1===r.defaultOptionList.indexOf(t)&&console.warn("Invalid column definition option in '"+(e.field||e.definition.title)+"' column:",t)})}},{key:"setField",value:function(e){this.field=e,this.fieldStructure=e?this.table.options.nestedFieldSeparator?e.split(this.table.options.nestedFieldSeparator):[e]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}},{key:"registerColumnPosition",value:function(e){this.parent.registerColumnPosition(e)}},{key:"registerColumnField",value:function(e){this.parent.registerColumnField(e)}},{key:"reRegisterPosition",value:function(){this.isGroup?this.columns.forEach(function(e){e.reRegisterPosition()}):this.registerColumnPosition(this)}},{key:"_mapDepricatedFunctionality",value:function(){}},{key:"_initialize",value:function(){for(var e=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);e.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),"flip"===e.headerVertical&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._bindEvents(),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.dispatch("column-init",this)}},{key:"_bindEvents",value:function(){var e,t,n,o=this,a=this.definition;"function"==typeof a.headerClick&&this.element.addEventListener("click",function(e){a.headerClick(e,o.getComponent())}),"function"==typeof a.headerDblClick&&this.element.addEventListener("dblclick",function(e){a.headerDblClick(e,o.getComponent())}),"function"==typeof a.headerContext&&this.element.addEventListener("contextmenu",function(e){a.headerContext(e,o.getComponent())}),"function"==typeof a.headerTap&&(n=!1,this.element.addEventListener("touchstart",function(e){n=!0},{passive:!0}),this.element.addEventListener("touchend",function(e){n&&a.headerTap(e,o.getComponent()),n=!1})),"function"==typeof a.headerDblTap&&(e=null,this.element.addEventListener("touchend",function(t){e?(clearTimeout(e),e=null,a.headerDblTap(t,o.getComponent())):e=setTimeout(function(){clearTimeout(e),e=null},300)})),"function"==typeof a.headerTapHold&&(t=null,this.element.addEventListener("touchstart",function(e){clearTimeout(t),t=setTimeout(function(){clearTimeout(t),t=null,n=!1,a.headerTapHold(e,this.getComponent())},1e3)},{passive:!0}),this.element.addEventListener("touchend",function(e){clearTimeout(t),t=null}))}},{key:"_buildColumnHeader",value:function(){var e=this,t=this.definition;this.table,this.dispatch("column-layout",this),void 0!==t.visible&&(t.visible?this.show(!0):this.hide(!0)),t.cssClass&&t.cssClass.split(" ").forEach(function(t){e.element.classList.add(t)}),t.field&&this.element.setAttribute("tabulator-field",t.field),this.setMinWidth(parseInt(t.minWidth)),t.maxInitialWidth&&(this.maxInitialWidth=parseInt(t.maxInitialWidth)),t.maxWidth&&this.setMaxWidth(parseInt(t.maxWidth)),this.reinitializeWidth(),this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}},{key:"_buildColumnHeaderContent",value:function(){this.definition,this.table;var e=document.createElement("div");return e.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),e.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),e}},{key:"_buildColumnHeaderTitle",value:function(){var e=this,t=this.definition,n=document.createElement("div");if(n.classList.add("tabulator-col-title"),t.editableTitle){var o=document.createElement("input");o.classList.add("tabulator-title-editor"),o.addEventListener("click",function(e){e.stopPropagation(),o.focus()}),o.addEventListener("change",function(){t.title=o.value,e.dispatchExternal("columnTitleChanged",e.getComponent())}),n.appendChild(o),t.field?this.langBind("columns|"+t.field,function(e){o.value=e||t.title||"&nbsp;"}):o.value=t.title||"&nbsp;"}else t.field?this.langBind("columns|"+t.field,function(o){e._formatColumnHeaderTitle(n,o||t.title||"&nbsp;")}):this._formatColumnHeaderTitle(n,t.title||"&nbsp;");return n}},{key:"_formatColumnHeaderTitle",value:function(t,n){var o=this.chain("column-format",[this,n,t],null,function(){return n});switch(e(o)){case"object":o instanceof Node?t.appendChild(o):(t.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",o));break;case"undefined":case"null":t.innerHTML="";break;default:t.innerHTML=o}}},{key:"_buildGroupHeader",value:function(){var e=this;this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass&&this.definition.cssClass.split(" ").forEach(function(t){e.element.classList.add(t)}),this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}},{key:"_getFlatData",value:function(e){return e[this.field]}},{key:"_getNestedData",value:function(e){for(var t,n=e,o=this.fieldStructure,a=o.length,s=0;s<a&&(t=n=n[o[s]],n);s++);return t}},{key:"_setFlatData",value:function(e,t){this.field&&(e[this.field]=t)}},{key:"_setNestedData",value:function(e,t){for(var n=e,o=this.fieldStructure,a=o.length,s=0;s<a;s++)if(s==a-1)n[o[s]]=t;else{if(!n[o[s]]){if(void 0===t)break;n[o[s]]={}}n=n[o[s]]}}},{key:"attachColumn",value:function(e){this.groupElement?(this.columns.push(e),this.groupElement.appendChild(e.getElement()),e.columnRendered()):console.warn("Column Warning - Column being attached to another column instead of column group")}},{key:"verticalAlign",value:function(e,t){var n=this.parent.isGroup?this.parent.getGroupElement().clientHeight:t||this.parent.getHeadersElement().clientHeight;this.element.style.height=n+"px",this.dispatch("column-height",this,this.element.style.height),this.isGroup&&(this.groupElement.style.minHeight=n-this.contentElement.offsetHeight+"px"),this.isGroup||"top"===e||(this.element.style.paddingTop="bottom"===e?this.element.clientHeight-this.contentElement.offsetHeight+"px":(this.element.clientHeight-this.contentElement.offsetHeight)/2+"px"),this.columns.forEach(function(t){t.verticalAlign(e)})}},{key:"clearVerticalAlign",value:function(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach(function(e){e.clearVerticalAlign()}),this.dispatch("column-height",this,"")}},{key:"bindModuleColumns",value:function(){"rownum"==this.definition.formatter&&(this.table.rowManager.rowNumColumn=this)}},{key:"getElement",value:function(){return this.element}},{key:"getGroupElement",value:function(){return this.groupElement}},{key:"getField",value:function(){return this.field}},{key:"getTitleDownload",value:function(){return this.titleDownload}},{key:"getFirstColumn",value:function(){return this.isGroup?!!this.columns.length&&this.columns[0].getFirstColumn():this}},{key:"getLastColumn",value:function(){return this.isGroup?!!this.columns.length&&this.columns[this.columns.length-1].getLastColumn():this}},{key:"getColumns",value:function(){return this.columns}},{key:"getCells",value:function(){return this.cells}},{key:"getTopColumn",value:function(){return this.parent.isGroup?this.parent.getTopColumn():this}},{key:"getDefinition",value:function(e){var t=[];return this.isGroup&&e&&(this.columns.forEach(function(e){t.push(e.getDefinition(!0))}),this.definition.columns=t),this.definition}},{key:"checkColumnVisibility",value:function(){var e=!1;this.columns.forEach(function(t){t.visible&&(e=!0)}),e?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}},{key:"show",value:function(e,t){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(e){e.show()}),this.isGroup||null!==this.width||this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.renderer.rerenderColumns())}},{key:"hide",value:function(e,t){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(e){e.hide()}),this.dispatch("column-hide",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.renderer.rerenderColumns())}},{key:"matchChildWidths",value:function(){var e=0;this.contentElement&&this.columns.length&&(this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}),this.contentElement.style.maxWidth=e-1+"px",this.parent.isGroup&&this.parent.matchChildWidths())}},{key:"removeChild",value:function(e){var t=this.columns.indexOf(e);t>-1&&this.columns.splice(t,1),this.columns.length||this.delete()}},{key:"setWidth",value:function(e){this.widthFixed=!0,this.setWidthActual(e)}},{key:"setWidthActual",value:function(e){isNaN(e)&&(e=Math.floor(this.table.element.clientWidth/100*parseInt(e))),e=Math.max(this.minWidth,e),this.maxWidth&&(e=Math.min(this.maxWidth,e)),this.width=e,this.widthStyled=e?e+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach(function(e){e.setWidth()}),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this)}},{key:"checkCellHeights",value:function(){var e=[];this.cells.forEach(function(t){t.row.heightInitialized&&(null!==t.row.getElement().offsetParent?(e.push(t.row),t.row.clearCellHeight()):t.row.heightInitialized=!1)}),e.forEach(function(e){e.calcHeight()}),e.forEach(function(e){e.setCellHeight()})}},{key:"getWidth",value:function(){var e=0;return this.isGroup?this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}):e=this.width,e}},{key:"getHeight",value:function(){return Math.ceil(this.element.getBoundingClientRect().height)}},{key:"setMinWidth",value:function(e){this.minWidth=e,this.minWidthStyled=e?e+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach(function(e){e.setMinWidth()})}},{key:"setMaxWidth",value:function(e){this.maxWidth=e,this.maxWidthStyled=e?e+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach(function(e){e.setMaxWidth()})}},{key:"delete",value:function(){var e=this;return new Promise(function(t,n){e.isGroup&&e.columns.forEach(function(e){e.delete()}),e.dispatch("column-delete",e);for(var o=e.cells.length,a=0;a<o;a++)e.cells[0].delete();e.element.parentNode&&e.element.parentNode.removeChild(e.element),e.element=!1,e.contentElement=!1,e.titleElement=!1,e.groupElement=!1,e.parent.isGroup&&e.parent.removeChild(e),e.table.columnManager.deregisterColumn(e),e.table.columnManager.renderer.rerenderColumns(!0),t()})}},{key:"columnRendered",value:function(){this.titleFormatterRendered&&this.titleFormatterRendered(),this.dispatch("column-rendered",this)}},{key:"generateCell",value:function(e){var t=new f(this,e);return this.cells.push(t),t}},{key:"nextColumn",value:function(){var e=this.table.columnManager.findColumnIndex(this);return e>-1&&this._nextVisibleColumn(e+1)}},{key:"_nextVisibleColumn",value:function(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._nextVisibleColumn(e+1)}},{key:"prevColumn",value:function(){var e=this.table.columnManager.findColumnIndex(this);return e>-1&&this._prevVisibleColumn(e-1)}},{key:"_prevVisibleColumn",value:function(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._prevVisibleColumn(e-1)}},{key:"reinitializeWidth",value:function(e){this.widthFixed=!1,void 0===this.definition.width||e||this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(e),this.dispatch("column-width-fit-after",this)}},{key:"fitToData",value:function(e){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach(function(e){e.clearWidth()}));var t=this.element.offsetWidth;if((!this.width||!this.widthFixed)&&(this.cells.forEach(function(e){var n=e.getWidth();n>t&&(t=n)}),t)){var n=t+1;this.maxInitialWidth&&!e&&(n=Math.min(n,this.maxInitialWidth)),this.setWidthActual(n)}}}},{key:"updateDefinition",value:function(e){var t,n=this;return this.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(t=Object.assign(t=Object.assign({},this.getDefinition()),e),this.table.columnManager.addColumn(t,!1,this).then(function(e){return t.field==n.field&&(n.field=!1),n.delete().then(function(){return e.getComponent()})}))}},{key:"deleteCell",value:function(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}},{key:"getComponent",value:function(){return this.component||(this.component=new d(this)),this.component}}]),r}();g.defaultOptionList=p;var v=function(){function n(){t(this,n)}return o(n,null,[{key:"elVisible",value:function(e){return!(e.offsetWidth<=0&&e.offsetHeight<=0)}},{key:"elOffset",value:function(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}}},{key:"deepClone",value:function(t,n){var o=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s={}.__proto__,r=[].__proto__;for(var l in n||(n=Object.assign(Array.isArray(t)?[]:{},t)),t)(function(){var u=t[l],h=void 0,c=void 0;null==u||"object"!==e(u)||u.__proto__!==s&&u.__proto__!==r||((h=a.findIndex(function(e){return e.subject===u}))>-1?n[l]=a[h].copy:(c=Object.assign(Array.isArray(u)?[]:{},u),a.unshift({subject:u,copy:c}),n[l]=o.deepClone(u,c,a)))})();return n}}]),n}(),b=function(){function n(e,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t(this,n),this.table=e,this.msgType=o,this.registeredDefaults=Object.assign({},a)}return o(n,[{key:"register",value:function(e,t){this.registeredDefaults[e]=t}},{key:"generate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Object.assign({},this.registeredDefaults);if(Object.assign(o,t),!1!==n.debugInvalidOptions||this.table.options.debugInvalidOptions)for(var a in n)o.hasOwnProperty(a)||console.warn("Invalid "+this.msgType+" option:",a);for(var a in o)a in n?o[a]=n[a]:Array.isArray(o[a])?o[a]=Object.assign([],o[a]):"object"===e(o[a])&&null!==o[a]?o[a]=Object.assign({},o[a]):void 0===o[a]&&delete o[a];return o}}]),n}(),y=function(e){a(s,c);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).elementVertical=e.rowManager.element,o.elementHorizontal=e.columnManager.element,o.tableElement=e.rowManager.tableElement,o.verticalFillMode="fit",o}return o(s,[{key:"initialize",value:function(){}},{key:"clearRows",value:function(){}},{key:"clearColumns",value:function(){}},{key:"reinitializeColumnWidths",value:function(e){}},{key:"renderRows",value:function(){}},{key:"renderColumns",value:function(){}},{key:"rerenderRows",value:function(e){e&&e()}},{key:"rerenderColumns",value:function(e,t){}},{key:"renderRowCells",value:function(e){}},{key:"rerenderRowCells",value:function(e,t){}},{key:"scrollColumns",value:function(e,t){}},{key:"scrollRows",value:function(e,t){}},{key:"resize",value:function(){}},{key:"scrollToRow",value:function(e){}},{key:"scrollToRowNearestTop",value:function(e){}},{key:"visibleRows",value:function(e){return[]}},{key:"rows",value:function(){return this.table.rowManager.getDisplayRows()}},{key:"styleRow",value:function(e,t){var n=e.getElement();t%2?(n.classList.add("tabulator-row-even"),n.classList.remove("tabulator-row-odd")):(n.classList.add("tabulator-row-odd"),n.classList.remove("tabulator-row-even"))}},{key:"clear",value:function(){this.clearRows(),this.clearColumns()}},{key:"render",value:function(){this.renderRows(),this.renderColumns()}},{key:"rerender",value:function(e){this.rerenderRows(),this.rerenderColumns()}}]),s}(),w=function(e){a(s,y);var n=u(s);function s(e){return t(this,s),n.call(this,e)}return o(s,[{key:"renderRowCells",value:function(e){e.cells.forEach(function(t){e.element.appendChild(t.getElement()),t.cellRendered()})}},{key:"reinitializeColumnWidths",value:function(e){e.forEach(function(e){e.reinitializeWidth()})}}]),s}(),C=function(e){a(s,y);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).leftCol=0,o.rightCol=0,o.scrollLeft=0,o.vDomScrollPosLeft=0,o.vDomScrollPosRight=0,o.vDomPadLeft=0,o.vDomPadRight=0,o.fitDataColAvg=0,o.windowBuffer=200,o.visibleRows=null,o.initialized=!1,o.isFitData=!1,o.columns=[],o}return o(s,[{key:"initialize",value:function(){this.compatibilityCheck(),this.layoutCheck(),this.vertScrollListen()}},{key:"compatibilityCheck",value:function(){var e=this.options("columns"),t=!0;return"fitDataTable"==this.options("layout")&&(console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"),t=!1),this.options("responsiveLayout")&&(console.warn("Horizontal Virtual DOM is not compatible with responsive columns"),t=!1),this.options("rtl")&&(console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction"),t=!1),e&&e.find(function(e){return e.frozen})&&(console.warn("Horizontal Virtual DOM is not compatible with frozen columns"),t=!1),t}},{key:"layoutCheck",value:function(){this.isFitData=this.options("layout").startsWith("fitData")}},{key:"vertScrollListen",value:function(){this.subscribe("scroll-vertical",this.clearVisRowCache.bind(this)),this.subscribe("data-refreshed",this.clearVisRowCache.bind(this))}},{key:"clearVisRowCache",value:function(){this.visibleRows=null}},{key:"renderColumns",value:function(e,t){this.dataChange()}},{key:"scrollColumns",value:function(e,t){this.scrollLeft!=e&&(this.scrollLeft=e,this.scroll(e-(this.vDomScrollPosLeft+this.windowBuffer)))}},{key:"calcWindowBuffer",value:function(){var e=this.elementVertical.clientWidth;this.table.columnManager.columnsByIndex.forEach(function(t){if(t.visible){var n=t.getWidth();n>e&&(e=n)}}),this.windowBuffer=2*e}},{key:"rerenderColumns",value:function(e,t){var n=this,o={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol},a=0;e&&!this.initialized||(this.clear(),this.calcWindowBuffer(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.windowBuffer,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,this.table.columnManager.columnsByIndex.forEach(function(e){var t={};if(e.visible){var o=e.getWidth();t.leftPos=a,t.rightPos=a+o,t.width=o,n.isFitData&&(t.fitDataCheck=!e.modules.vdomHoz||e.modules.vdomHoz.fitDataCheck),a+o>n.vDomScrollPosLeft&&a<n.vDomScrollPosRight?(-1==n.leftCol&&(n.leftCol=n.columns.length,n.vDomPadLeft=a),n.rightCol=n.columns.length):-1!==n.leftCol&&(n.vDomPadRight+=o),n.columns.push(e),e.modules.vdomHoz=t,a+=o}}),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,t||e&&!this.reinitChanged(o)||this.reinitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft)}},{key:"renderRowCells",value:function(e){this.initialized?this.initializeRow(e):e.cells.forEach(function(t){e.element.appendChild(t.getElement()),t.cellRendered()})}},{key:"rerenderRowCells",value:function(e,t){this.reinitializeRow(e,t)}},{key:"reinitializeColumnWidths",value:function(e){for(var t=this.leftCol;t<=this.rightCol;t++)this.columns[t].reinitializeWidth()}},{key:"deinitialize",value:function(){this.initialized=!1}},{key:"clear",value:function(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}},{key:"dataChange",value:function(){var e,t,n=this,o=!1,a=0;if(this.isFitData){if(this.table.columnManager.columnsByIndex.forEach(function(e){!e.definition.width&&e.visible&&(o=!0)}),o&&o&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,t=this.chain("rows-sample",[1],[],function(){return n.table.rowManager.getDisplayRows()})[0])){for(e=t.getElement(),t.generateCells(),this.tableElement.appendChild(e),a=0;a<t.cells.length;a++){var s=t.cells[a];e.appendChild(s.getElement()),s.column.reinitializeWidth(),s.column.getWidth()}e.parentNode.removeChild(e),this.rerenderColumns(!1,!0)}}else"fitColumns"===this.options("layout")&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}},{key:"reinitChanged",value:function(e){var t=this,n=!0;return e.cols.length!==this.columns.length||e.leftCol!==this.leftCol||e.rightCol!==this.rightCol||(e.cols.forEach(function(e,o){e!==t.columns[o]&&(n=!1)}),!n)}},{key:"reinitializeRows",value:function(){var e=this;this.getVisibleRows().forEach(function(t){e.reinitializeRow(t,!0)})}},{key:"getVisibleRows",value:function(){return this.visibleRows||(this.visibleRows=this.table.rowManager.getVisibleRows()),this.visibleRows}},{key:"scroll",value:function(e){this.vDomScrollPosLeft+=e,this.vDomScrollPosRight+=e,Math.abs(e)>this.windowBuffer/2?this.rerenderColumns():e>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}},{key:"colPositionAdjust",value:function(e,t,n){for(var o=e;o<t;o++){var a=this.columns[o];a.modules.vdomHoz.leftPos+=n,a.modules.vdomHoz.rightPos+=n}}},{key:"fitDataColActualWidthCheck",value:function(e){var t,n;return e.modules.vdomHoz.fitDataCheck&&(e.reinitializeWidth(),(n=(t=e.getWidth())-e.modules.vdomHoz.width)&&(e.modules.vdomHoz.rightPos+=n,e.modules.vdomHoz.width=t,this.colPositionAdjust(this.columns.indexOf(e)+1,this.columns.length,n)),e.modules.vdomHoz.fitDataCheck=!1),n}},{key:"initializeRow",value:function(e){if("group"!==e.type){e.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol};for(var t=this.leftCol;t<=this.rightCol;t++){var n=this.columns[t];if(n&&n.visible){var o=e.getCell(n);e.getElement().appendChild(o.getElement()),o.cellRendered()}}}}},{key:"reinitializeRow",value:function(e,t){if("group"!==e.type&&(t||!e.modules.vdomHoz||e.modules.vdomHoz.leftCol!==this.leftCol||e.modules.vdomHoz.rightCol!==this.rightCol)){for(var n=e.getElement();n.firstChild;)n.removeChild(n.firstChild);this.initializeRow(e)}}}]),s}(),k=function(n){a(r,c);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).blockHozScrollEvent=!1,n.headersElement=null,n.element=null,n.columns=[],n.columnsByIndex=[],n.columnsByField={},n.scrollLeft=0,n.optionsList=new b(n.table,"column definition",p),n.renderer=null,n}return o(r,[{key:"initialize",value:function(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.element=this.createHeaderElement(),this.element.insertBefore(this.headersElement,this.element.firstChild),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this))}},{key:"initializeRenderer",value:function(){var e;(e="string"==typeof this.table.options.renderHorizontal?({virtual:C,basic:w})[this.table.options.renderHorizontal]:this.table.options.renderHorizontal)?(this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",table.options.renderHorizontal)}},{key:"createHeadersElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-headers"),e.setAttribute("role","row"),e}},{key:"createHeaderElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-header"),e.setAttribute("role","rowgroup"),this.table.options.headerVisible||e.classList.add("tabulator-header-hidden"),e}},{key:"getElement",value:function(){return this.element}},{key:"getHeadersElement",value:function(){return this.headersElement}},{key:"scrollHorizontal",value:function(e){var t=0,n=this.element.scrollWidth-this.table.element.clientWidth;this.element.scrollLeft=e,e>n?(t=e-n,this.element.style.marginLeft=-t+"px"):this.element.style.marginLeft=0,this.scrollLeft=e,this.renderer.scrollColumns(e)}},{key:"setColumns",value:function(e,t){for(var n=this;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),e.forEach(function(e,t){n._addColumn(e)}),this._reIndexColumns(),this.dispatch("columns-loaded"),this.renderer.rerenderColumns(!1,!0),this.redraw(!0)}},{key:"_addColumn",value:function(e,t,n){var o=new g(e,this),a=o.getElement(),s=n?this.findColumnIndex(n):n;if(n&&s>-1){var r=n.getTopColumn(),l=this.columns.indexOf(r),u=r.getElement();t?(this.columns.splice(l,0,o),u.parentNode.insertBefore(a,u)):(this.columns.splice(l+1,0,o),u.parentNode.insertBefore(a,u.nextSibling))}else t?(this.columns.unshift(o),this.headersElement.insertBefore(o.getElement(),this.headersElement.firstChild)):(this.columns.push(o),this.headersElement.appendChild(o.getElement()));return o.columnRendered(),o}},{key:"registerColumnField",value:function(e){e.definition.field&&(this.columnsByField[e.definition.field]=e)}},{key:"registerColumnPosition",value:function(e){this.columnsByIndex.push(e)}},{key:"_reIndexColumns",value:function(){this.columnsByIndex=[],this.columns.forEach(function(e){e.reRegisterPosition()})}},{key:"verticalAlignHeaders",value:function(){var e=this,t=0;this.columns.forEach(function(e){var n;e.clearVerticalAlign(),(n=e.getHeight())>t&&(t=n)}),this.columns.forEach(function(n){n.verticalAlign(e.table.options.columnHeaderVertAlign,t)}),this.table.rowManager.adjustTableSize()}},{key:"findColumn",value:function(t){return"object"!=e(t)?this.columnsByField[t]||!1:t instanceof g?t:t instanceof d?t._getSelf()||!1:"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&this.columns.find(function(e){return e.element===t})||!1}},{key:"getColumnByField",value:function(e){return this.columnsByField[e]}},{key:"getColumnsByFieldRoot",value:function(e){var t=this,n=[];return Object.keys(this.columnsByField).forEach(function(o){o.split(".")[0]===e&&n.push(t.columnsByField[o])}),n}},{key:"getColumnByIndex",value:function(e){return this.columnsByIndex[e]}},{key:"getFirstVisibleColumn",value:function(e){return(e=this.columnsByIndex.findIndex(function(e){return e.visible}))>-1&&this.columnsByIndex[e]}},{key:"getColumns",value:function(){return this.columns}},{key:"findColumnIndex",value:function(e){return this.columnsByIndex.findIndex(function(t){return e===t})}},{key:"getRealColumns",value:function(){return this.columnsByIndex}},{key:"traverse",value:function(e){this.columnsByIndex.forEach(function(t,n){e(t,n)})}},{key:"getDefinitions",value:function(e){var t=[];return this.columnsByIndex.forEach(function(n){(!e||e&&n.visible)&&t.push(n.getDefinition())}),t}},{key:"getDefinitionTree",value:function(){var e=[];return this.columns.forEach(function(t){e.push(t.getDefinition(!0))}),e}},{key:"getComponents",value:function(e){var t=[];return(e?this.columns:this.columnsByIndex).forEach(function(e){t.push(e.getComponent())}),t}},{key:"getWidth",value:function(){var e=0;return this.columnsByIndex.forEach(function(t){t.visible&&(e+=t.getWidth())}),e}},{key:"moveColumn",value:function(e,t,n){this.moveColumnActual(e,t,n),t.element.parentNode.insertBefore(e.element,t.element),n&&t.element.parentNode.insertBefore(t.element,e.element),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}},{key:"moveColumnActual",value:function(e,t,n){e.parent.isGroup?this._moveColumnInArray(e.parent.columns,e,t,n):this._moveColumnInArray(this.columns,e,t,n),this._moveColumnInArray(this.columnsByIndex,e,t,n,!0),this.renderer.rerenderColumns(!0),this.dispatch("column-moved",e,t,n),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",e.getComponent(),this.table.columnManager.getComponents())}},{key:"_moveColumnInArray",value:function(e,t,n,o,a){var s,r=e.indexOf(t);r>-1&&(e.splice(r,1),(s=e.indexOf(n))>-1?o&&(s+=1):s=r,e.splice(s,0,t),a&&(this.chain("column-moving-rows",[t,n,o],null,[])||[]).concat(this.table.rowManager.rows).forEach(function(e){if(e.cells.length){var t=e.cells.splice(r,1)[0];e.cells.splice(s,0,t)}}))}},{key:"scrollToColumn",value:function(e,t,n){var o=this,a=0,s=0,r=0,l=e.getElement();return new Promise(function(u,h){if(void 0===t&&(t=o.table.options.scrollToColumnPosition),void 0===n&&(n=o.table.options.scrollToColumnIfVisible),e.visible){switch(t){case"middle":case"center":r=-o.element.clientWidth/2;break;case"right":r=l.clientWidth-o.headersElement.clientWidth}if(!n&&(s=l.offsetLeft)>0&&s+l.offsetWidth<o.element.clientWidth)return!1;a=Math.max(Math.min(a=l.offsetLeft+r,o.table.rowManager.element.scrollWidth-o.table.rowManager.element.clientWidth),0),o.table.rowManager.scrollHorizontal(a),o.scrollHorizontal(a),u()}else console.warn("Scroll Error - Column not visible"),h("Scroll Error - Column not visible")})}},{key:"generateCells",value:function(e){var t=[];return this.columnsByIndex.forEach(function(n){t.push(n.generateCell(e))}),t}},{key:"getFlexBaseWidth",value:function(){var e=this.table.element.clientWidth,t=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(e-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach(function(n){var o,a,s;n.visible&&(o=n.definition.width||0,a=parseInt(n.minWidth),s="string"==typeof o?o.indexOf("%")>-1?e/100*parseInt(o):parseInt(o):o,t+=s>a?s:a)}),t}},{key:"addColumn",value:function(e,t,n){var o=this;return new Promise(function(a,s){var r=o._addColumn(e,t,n);o._reIndexColumns(),o.dispatch("column-add",e,t,n),"fitColumns"!=o.layoutMode()&&r.reinitializeWidth(),o.redraw(!0),o.table.rowManager.reinitialize(),o.renderer.rerenderColumns(),a(r)})}},{key:"deregisterColumn",value:function(e){var t,n=e.getField();n&&delete this.columnsByField[n],(t=this.columnsByIndex.indexOf(e))>-1&&this.columnsByIndex.splice(t,1),(t=this.columns.indexOf(e))>-1&&this.columns.splice(t,1),this.verticalAlignHeaders(),this.redraw()}},{key:"redraw",value:function(e){v.elVisible(this.element)&&this.verticalAlignHeaders(),e&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",e)||this.layoutRefresh(),this.dispatch("table-redraw",e),this.table.footerManager.redraw()}}]),r}(),E=function(){function e(n){return t(this,e),this._row=n,new Proxy(this,{get:function(e,t,n){return void 0!==e[t]?e[t]:e._row.table.componentFunctionBinder.handle("row",e._row,t)}})}return o(e,[{key:"getData",value:function(e){return this._row.getData(e)}},{key:"getElement",value:function(){return this._row.getElement()}},{key:"getCells",value:function(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}},{key:"getCell",value:function(e){var t=this._row.getCell(e);return!!t&&t.getComponent()}},{key:"getIndex",value:function(){return this._row.getData("data")[this._row.table.options.index]}},{key:"getPosition",value:function(e){return this._row.table.rowManager.getRowPosition(this._row,e)}},{key:"delete",value:function(){return this._row.delete()}},{key:"scrollTo",value:function(){return this._row.table.rowManager.scrollToRow(this._row)}},{key:"move",value:function(e,t){this._row.moveToRow(e,t)}},{key:"update",value:function(e){return this._row.updateData(e)}},{key:"normalizeHeight",value:function(){this._row.normalizeHeight(!0)}},{key:"_getSelf",value:function(){return this._row}},{key:"reformat",value:function(){return this._row.reinitialize()}},{key:"getTable",value:function(){return this._row.table}},{key:"getNextRow",value:function(){var e=this._row.nextRow();return e?e.getComponent():e}},{key:"getPrevRow",value:function(){var e=this._row.prevRow();return e?e.getComponent():e}}]),e}(),$=function(e){a(s,c);var n=u(s);function s(e,o){var a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"row";return t(this,s),(a=n.call(this,o.table)).parent=o,a.data={},a.type=r,a.element=!1,a.modules={},a.cells=[],a.height=0,a.heightStyled="",a.manualHeight=!1,a.outerHeight=0,a.initialized=!1,a.heightInitialized=!1,a.component=null,a.created=!1,a.setData(e),a}return o(s,[{key:"create",value:function(){this.created||(this.created=!0,this.generateElement())}},{key:"createElement",value:function(){var e=document.createElement("div");e.classList.add("tabulator-row"),e.setAttribute("role","row"),this.element=e}},{key:"getElement",value:function(){return this.create(),this.element}},{key:"detachElement",value:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}},{key:"generateElement",value:function(){this.createElement(),this.dispatch("row-init",this)}},{key:"generateCells",value:function(){this.cells=this.table.columnManager.generateCells(this)}},{key:"initialize",value:function(e){if(this.create(),!this.initialized||e){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.initialized=!0,this.table.columnManager.renderer.renderRowCells(this),e&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this)}},{key:"reinitializeHeight",value:function(){this.heightInitialized=!1,this.element&&null!==this.element.offsetParent&&this.normalizeHeight(!0)}},{key:"deinitialize",value:function(){this.initialized=!1}},{key:"deinitializeHeight",value:function(){this.heightInitialized=!1}},{key:"reinitialize",value:function(e){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&null!==this.element.offsetParent&&this.initialize(!0),this.dispatch("row-relayout",this)}},{key:"calcHeight",value:function(e){var t,n=0;this.table.options.rowHeight?this.height=this.table.options.rowHeight:(t=this.table.options.resizableRows?this.element.clientHeight:0,this.cells.forEach(function(e){var t=e.getHeight();t>n&&(n=t)}),this.height=e?Math.max(n,t):this.manualHeight?this.height:Math.max(n,t)),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}},{key:"setCellHeight",value:function(){this.cells.forEach(function(e){e.setHeight()}),this.heightInitialized=!0}},{key:"clearCellHeight",value:function(){this.cells.forEach(function(e){e.clearHeight()})}},{key:"normalizeHeight",value:function(e){e&&!this.table.options.rowHeight&&this.clearCellHeight(),this.calcHeight(e),this.setCellHeight()}},{key:"setHeight",value:function(e,t){(this.height!=e||t)&&(this.manualHeight=!0,this.height=e,this.heightStyled=e?e+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight)}},{key:"getHeight",value:function(){return this.outerHeight}},{key:"getWidth",value:function(){return this.element.offsetWidth}},{key:"deleteCell",value:function(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}},{key:"setData",value:function(e){this.data=this.chain("row-data-init-before",[this,e],void 0,e),this.dispatch("row-data-init-after",this)}},{key:"updateData",value:function(e){var t,n=this,o=this.element&&v.elVisible(this.element),a={};return new Promise(function(s,r){for(var l in"string"==typeof e&&(e=JSON.parse(e)),n.dispatch("row-data-save-before",n),n.subscribed("row-data-changing")&&(a=Object.assign(a=Object.assign(a,n.data),e)),t=n.chain("row-data-changing",[n,a,e],null,e))n.data[l]=t[l];for(var l in n.dispatch("row-data-save-after",n),e)n.table.columnManager.getColumnsByFieldRoot(l).forEach(function(e){var a=n.getCell(e.getField());if(a){var s=e.getFieldValue(t);a.getValue()!=s&&(a.setValueProcessData(s),o&&a.cellRendered())}});o?(n.normalizeHeight(!0),n.table.options.rowFormatter&&n.table.options.rowFormatter(n.getComponent())):(n.initialized=!1,n.height=0,n.heightStyled=""),n.dispatch("row-data-changed",n,o,e),n.dispatchExternal("rowUpdated",n.getComponent()),n.subscribedExternal("dataChanged")&&n.dispatchExternal("dataChanged",n.table.rowManager.getData()),s()})}},{key:"getData",value:function(e){return e?this.chain("row-data-retrieve",[this,e],null,this.data):this.data}},{key:"getCell",value:function(e){return e=this.table.columnManager.findColumn(e),this.initialized||this.generateCells(),this.cells.find(function(t){return t.column===e})}},{key:"getCellIndex",value:function(e){return this.cells.findIndex(function(t){return t===e})}},{key:"findCell",value:function(e){return this.cells.find(function(t){return t.element===e})}},{key:"getCells",value:function(){return this.initialized||this.generateCells(),this.cells}},{key:"nextRow",value:function(){return this.table.rowManager.nextDisplayRow(this,!0)||!1}},{key:"prevRow",value:function(){return this.table.rowManager.prevDisplayRow(this,!0)||!1}},{key:"moveToRow",value:function(e,t){var n=this.table.rowManager.findRow(e);n?(this.table.rowManager.moveRowActual(this,n,!t),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",e)}},{key:"delete",value:function(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}},{key:"deleteActual",value:function(e){this.table.rowManager.getRowIndex(this),this.detatchModules(),this.table.rowManager.deleteRow(this,e),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}},{key:"detatchModules",value:function(){this.dispatch("row-deleting",this)}},{key:"deleteCells",value:function(){for(var e=this.cells.length,t=0;t<e;t++)this.cells[0].delete()}},{key:"wipe",value:function(){if(this.detatchModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}},{key:"getGroup",value:function(){return this.modules.group||!1}},{key:"getComponent",value:function(){return this.component||(this.component=new E(this)),this.component}}]),s}(),_=function(e){a(s,y);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).verticalFillMode="fill",o.scrollTop=0,o.scrollLeft=0,o.scrollTop=0,o.scrollLeft=0,o}return o(s,[{key:"clearRows",value:function(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.scrollTop=0,e.scrollLeft=0,e.style.minWidth="",e.style.minHeight="",e.style.display="",e.style.visibility=""}},{key:"renderRows",value:function(){var e=this,t=this.tableElement,n=!0;this.rows().forEach(function(o,a){e.styleRow(o,a),t.appendChild(o.getElement()),o.initialize(!0),"group"!==o.type&&(n=!1)}),t.style.minWidth=n?this.table.columnManager.getWidth()+"px":""}},{key:"rerenderRows",value:function(e){this.clearRows(),this.renderRows(),e&&e()}},{key:"scrollToRowNearestTop",value:function(e){var t=v.elOffset(e.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-t)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-t))}},{key:"scrollToRow",value:function(e){var t=e.getElement();this.elementVertical.scrollTop=v.elOffset(t).top-v.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}},{key:"visibleRows",value:function(e){return this.rows()}}]),s}(),R=function(e){a(s,y);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).verticalFillMode="fill",o.scrollTop=0,o.scrollLeft=0,o.vDomRowHeight=20,o.vDomTop=0,o.vDomBottom=0,o.vDomScrollPosTop=0,o.vDomScrollPosBottom=0,o.vDomTopPad=0,o.vDomBottomPad=0,o.vDomMaxRenderChain=90,o.vDomWindowBuffer=0,o.vDomWindowMinTotalRows=20,o.vDomWindowMinMarginRows=5,o.vDomTopNewRows=[],o.vDomBottomNewRows=[],o}return o(s,[{key:"clearRows",value:function(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.style.paddingTop="",e.style.paddingBottom="",e.style.minHeight="",e.style.display="",e.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}},{key:"renderRows",value:function(){this._virtualRenderFill()}},{key:"rerenderRows",value:function(e){for(var t=this.elementVertical.scrollTop,n=!1,o=!1,a=this.table.rowManager.scrollLeft,s=this.rows(),r=this.vDomTop;r<=this.vDomBottom;r++)if(s[r]){var l=t-s[r].getElement().offsetTop;if(!(!1===o||Math.abs(l)<o))break;o=l,n=r}s.forEach(function(e){e.deinitializeHeight()}),e&&e(),this._virtualRenderFill(!1===n?this.rows.length-1:n,!0,o||0),this.scrollColumns(a)}},{key:"scrollColumns",value:function(e){this.table.rowManager.scrollHorizontal(e)}},{key:"scrollRows",value:function(e,t){var n=e-this.vDomScrollPosTop,o=e-this.vDomScrollPosBottom,a=2*this.vDomWindowBuffer,s=this.rows();if(this.scrollTop=e,-n>a||o>a){var r=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*s.length)),this.scrollColumns(r)}else t?(n<0&&this._addTopRow(s,-n),o<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(s,-o):this.vDomScrollPosBottom=this.scrollTop)):(o>=0&&this._addBottomRow(s,o),n>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(s,n):this.vDomScrollPosTop=this.scrollTop))}},{key:"resize",value:function(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}},{key:"scrollToRowNearestTop",value:function(e){var t=this.rows().indexOf(e);return!(Math.abs(this.vDomTop-t)>Math.abs(this.vDomBottom-t))}},{key:"scrollToRow",value:function(e){var t=this.rows().indexOf(e);t>-1&&this._virtualRenderFill(t,!0)}},{key:"visibleRows",value:function(e){var t=this.elementVertical.scrollTop,n=this.elementVertical.clientHeight+t,o=!1,a=0,s=0,r=this.rows();if(e)a=this.vDomTop,s=this.vDomBottom;else for(var l=this.vDomTop;l<=this.vDomBottom;l++)if(r[l]){if(o){if(!(n-r[l].getElement().offsetTop>=0))break;s=l}else if(t-r[l].getElement().offsetTop>=0)a=l;else{if(o=!0,!(n-r[l].getElement().offsetTop>=0))break;s=l}}return r.slice(a,s+1)}},{key:"_virtualRenderFill",value:function(e,t,n){var o=this.tableElement,a=this.elementVertical,s=0,r=0,l=0,u=0,h=0,c=this.rows(),d=c.length,p=this.elementVertical.clientHeight;if(n=n||0,e=e||0){for(;o.firstChild;)o.removeChild(o.firstChild);(l=(d-e+1)*this.vDomRowHeight)<p&&(e-=Math.ceil((p-l)/this.vDomRowHeight))<0&&(e=0),e-=s=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),e)}else this.clear();if(d&&v.elVisible(this.elementVertical)){for(this.vDomTop=e,this.vDomBottom=e-1;(r<=p+this.vDomWindowBuffer||h<this.vDomWindowMinTotalRows)&&this.vDomBottom<d-1;){var m,f=this.vDomBottom+1,g=c[f];this.styleRow(g,f),o.appendChild(g.getElement()),g.initialize(),g.heightInitialized||g.normalizeHeight(!0),m=g.getHeight(),h<s?u+=m:r+=m,m>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*m),this.vDomBottom++,h++}e?(this.vDomTopPad=t?this.vDomRowHeight*this.vDomTop+n:this.scrollTop-u,this.vDomBottomPad=this.vDomBottom==d-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-r-u,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((r+u)/h),this.vDomBottomPad=this.vDomRowHeight*(d-this.vDomBottom-1),this.vDomScrollHeight=u+r+this.vDomBottomPad-p),o.style.paddingTop=this.vDomTopPad+"px",o.style.paddingBottom=this.vDomBottomPad+"px",t&&(this.scrollTop=this.vDomTopPad+u+n-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-p:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-p),this.elementVertical.scrollWidth>this.elementVertical.offsetWidth&&t&&(this.scrollTop+=this.elementVertical.offsetHeight-p),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,a.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}},{key:"_addTopRow",value:function(e,t){for(var n=this.tableElement,o=[],a=0,s=this.vDomTop-1,r=0;this.vDomTop;){var l=e[s],u=void 0,h=void 0;if(!(l&&r<this.vDomMaxRenderChain)||(u=l.getHeight()||this.vDomRowHeight,h=l.initialized,!(t>=u)))break;this.styleRow(l,s),n.insertBefore(l.getElement(),n.firstChild),l.initialized&&l.heightInitialized||o.push(l),l.initialize(),h||(u=l.getElement().offsetHeight)>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*u),t-=u,a+=u,this.vDomTop--,s--,r++}for(var c=0,d=o;c<d.length;c++)d[c].clearCellHeight();this._quickNormalizeRowHeight(o),a&&(this.vDomTopPad-=a,this.vDomTopPad<0&&(this.vDomTopPad=s*this.vDomRowHeight),s<1&&(this.vDomTopPad=0),n.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=a)}},{key:"_removeTopRow",value:function(e,t){for(var n=[],o=0,a=0;;){var s=e[this.vDomTop],r=void 0;if(!(s&&a<this.vDomMaxRenderChain)||!(t>=(r=s.getHeight()||this.vDomRowHeight)))break;this.vDomTop++,t-=r,o+=r,n.push(s),a++}for(var l=0,u=n;l<u.length;l++){var h=u[l].getElement();h.parentNode&&h.parentNode.removeChild(h)}o&&(this.vDomTopPad+=o,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?o:o+this.vDomWindowBuffer)}},{key:"_addBottomRow",value:function(e,t){for(var n=this.tableElement,o=[],a=0,s=this.vDomBottom+1,r=0;;){var l=e[s],u=void 0,h=void 0;if(!(l&&r<this.vDomMaxRenderChain)||(u=l.getHeight()||this.vDomRowHeight,h=l.initialized,!(t>=u)))break;this.styleRow(l,s),n.appendChild(l.getElement()),l.initialized&&l.heightInitialized||o.push(l),l.initialize(),h||(u=l.getElement().offsetHeight)>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*u),t-=u,a+=u,this.vDomBottom++,s++,r++}for(var c=0,d=o;c<d.length;c++)d[c].clearCellHeight();this._quickNormalizeRowHeight(o),a&&(this.vDomBottomPad-=a,(this.vDomBottomPad<0||s==e.length-1)&&(this.vDomBottomPad=0),n.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=a)}},{key:"_removeBottomRow",value:function(e,t){for(var n=[],o=0,a=0;;){var s=e[this.vDomBottom],r=void 0;if(!(s&&a<this.vDomMaxRenderChain)||!(t>=(r=s.getHeight()||this.vDomRowHeight)))break;this.vDomBottom--,t-=r,o+=r,n.push(s),a++}for(var l=0,u=n;l<u.length;l++){var h=u[l].getElement();h.parentNode&&h.parentNode.removeChild(h)}o&&(this.vDomBottomPad+=o,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=o)}},{key:"_quickNormalizeRowHeight",value:function(e){var t,n=h(e);try{for(n.s();!(t=n.n()).done;)t.value.calcHeight()}catch(o){n.e(o)}finally{n.f()}var a,s=h(e);try{for(s.s();!(a=s.n()).done;)a.value.setCellHeight()}catch(r){s.e(r)}finally{s.f()}}}]),s}(),x=function(n){a(r,c);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).element=n.createHolderElement(),n.tableElement=n.createTableElement(),n.heightFixer=n.createTableElement(),n.placeholder=null,n.placeholderContents=null,n.firstRender=!1,n.renderMode="virtual",n.fixedHeight=!1,n.rows=[],n.activeRowsPipeline=[],n.activeRows=[],n.activeRowsCount=0,n.displayRows=[],n.displayRowsCount=0,n.scrollTop=0,n.scrollLeft=0,n.rowNumColumn=!1,n.redrawBlock=!1,n.redrawBlockRestoreConfig=!1,n.redrawBlockRenderInPosition=!1,n.dataPipeline=[],n.displayPipeline=[],n.renderer=null,n}return o(r,[{key:"createHolderElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-tableholder"),e.setAttribute("tabindex",0),e.setAttribute("role","rowgroup"),e}},{key:"createTableElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-table"),e.setAttribute("role","rowgroup"),e}},{key:"initializePlaceholder",value:function(){if("string"==typeof this.table.options.placeholder){var e=document.createElement("div");e.classList.add("tabulator-placeholder");var t=document.createElement("div");t.classList.add("tabulator-placeholder-contents"),t.innerHTML=this.table.options.placeholder,e.appendChild(t),this.placeholderContents=t,this.placeholder=e}}},{key:"getElement",value:function(){return this.element}},{key:"getTableElement",value:function(){return this.tableElement}},{key:"getRowPosition",value:function(e,t){return t?this.activeRows.indexOf(e):this.rows.indexOf(e)}},{key:"initialize",value:function(){var e=this;this.initializePlaceholder(),this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",function(){var t=e.element.scrollLeft,n=e.scrollLeft>t,o=e.element.scrollTop,a=e.scrollTop>o;e.scrollLeft!=t&&(e.scrollLeft=t,e.dispatch("scroll-horizontal",t,n),e.dispatchExternal("scrollHorizontal",t,n),e._positionPlaceholder()),e.scrollTop!=o&&(e.scrollTop=o,e.renderer.scrollRows(o,a),e.dispatch("scroll-vertical",o,a),e.dispatchExternal("scrollVertical",o,a))})}},{key:"findRow",value:function(t){var n=this;return"object"!=e(t)?null!=t&&!!this.rows.find(function(e){return e.data[n.table.options.index]==t}):t instanceof $?t:t instanceof E?t._getSelf()||!1:"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&this.rows.find(function(e){return e.getElement()===t})||!1}},{key:"getRowFromDataObject",value:function(e){return this.rows.find(function(t){return t.data===e})||!1}},{key:"getRowFromPosition",value:function(e,t){return t?this.activeRows[e]:this.rows[e]}},{key:"scrollToRow",value:function(e,t,n){return this.renderer.scrollToRowPosition(e,t,n)}},{key:"setData",value:function(e,t,n){var o=this;return new Promise(function(a,s){t&&o.getDisplayRows().length?o.table.options.pagination?o._setDataActual(e,!0):o.reRenderInPosition(function(){o._setDataActual(e)}):(o.table.options.autoColumns&&n&&o.table.initialized&&o.table.columnManager.generateColumnsFromRowData(e),o.resetScroll(),o._setDataActual(e)),a()})}},{key:"_setDataActual",value:function(t,n){var o=this;this.dispatchExternal("dataProcessing",t),this._wipeElements(),Array.isArray(t)?(this.dispatch("data-processing",t),t.forEach(function(t,n){if(t&&"object"===e(t)){var a=new $(t,o);o.rows.push(a)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",t)}),this.refreshActiveData(!1,!1,n),this.dispatch("data-processed",t),this.dispatchExternal("dataProcessed",t)):console.error("Data Loading Error - Unable to process data due to invalid data type \nExpecting: array \nReceived: ",e(t),"\nData:     ",t)}},{key:"_wipeElements",value:function(){this.dispatch("rows-wipe"),this.rows.forEach(function(e){e.wipe()}),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.adjustTableSize()}},{key:"deleteRow",value:function(e,t){var n=this.rows.indexOf(e),o=this.activeRows.indexOf(e);o>-1&&this.activeRows.splice(o,1),n>-1&&this.rows.splice(n,1),this.setActiveRows(this.activeRows),this.displayRowIterator(function(t){var n=t.indexOf(e);n>-1&&t.splice(n,1)}),t||this.reRenderInPosition(),this.regenerateRowNumbers(),this.dispatchExternal("rowDeleted",e.getComponent()),this.displayRowsCount||this._showPlaceholder(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}},{key:"addRow",value:function(e,t,n,o){return this.addRowActual(e,t,n,o)}},{key:"addRows",value:function(e,t,n){var o=this,a=[];return new Promise(function(s,r){t=o.findAddRowPos(t),Array.isArray(e)||(e=[e]),e.length,(void 0===n&&t||void 0!==n&&!t)&&e.reverse(),e.forEach(function(s,r){var l=o.addRow(s,t,n,!0);a.push(l),o.dispatch("row-added",l,e,t,n)}),o.refreshActiveData(!1,!1,!0),o.regenerateRowNumbers(),a.length&&o._clearPlaceholder(),s(a)})}},{key:"findAddRowPos",value:function(e){return void 0===e&&(e=this.table.options.addRowPos),"pos"===e&&(e=!0),"bottom"===e&&(e=!1),e}},{key:"addRowActual",value:function(e,t,n,o){var a,s,r=e instanceof $?e:new $(e||{},this),l=this.findAddRowPos(t),u=-1;return n||(n=(s=this.chain("row-adding-position",[r,l],null,{index:n,top:l})).index,l=s.top),void 0!==n&&(n=this.findRow(n)),(n=this.chain("row-adding-index",[r,n,l],null,n))&&(u=this.rows.indexOf(n)),n&&u>-1?(a=this.activeRows.indexOf(n),this.displayRowIterator(function(e){var t=e.indexOf(n);t>-1&&e.splice(l?t:t+1,0,r)}),a>-1&&this.activeRows.splice(l?a:a+1,0,r),this.rows.splice(l?u:u+1,0,r)):l?(this.displayRowIterator(function(e){e.unshift(r)}),this.activeRows.unshift(r),this.rows.unshift(r)):(this.displayRowIterator(function(e){e.push(r)}),this.activeRows.push(r),this.rows.push(r)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",r.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),o||this.reRenderInPosition(),r}},{key:"moveRow",value:function(e,t,n){this.dispatch("row-move",e,t,n),this.moveRowActual(e,t,n),this.regenerateRowNumbers(),this.dispatch("row-moved",e,t,n),this.dispatchExternal("rowMoved",e.getComponent())}},{key:"moveRowActual",value:function(e,t,n){var o=this;this.moveRowInArray(this.rows,e,t,n),this.moveRowInArray(this.activeRows,e,t,n),this.displayRowIterator(function(a){o.moveRowInArray(a,e,t,n)}),this.dispatch("row-moving",e,t,n)}},{key:"moveRowInArray",value:function(e,t,n,o){var a,s,r;if(t!==n&&((a=e.indexOf(t))>-1&&(e.splice(a,1),(s=e.indexOf(n))>-1?o?e.splice(s+1,0,t):e.splice(s,0,t):e.splice(a,0,t)),e===this.getDisplayRows())){r=s>a?s:a+1;for(var l=a<s?a:s;l<=r;l++)e[l]&&this.styleRow(e[l],l)}}},{key:"clearData",value:function(){this.setData([])}},{key:"getRowIndex",value:function(e){return this.findRowIndex(e,this.rows)}},{key:"getDisplayRowIndex",value:function(e){var t=this.getDisplayRows().indexOf(e);return t>-1&&t}},{key:"nextDisplayRow",value:function(e,t){var n=this.getDisplayRowIndex(e),o=!1;return!1!==n&&n<this.displayRowsCount-1&&(o=this.getDisplayRows()[n+1]),!o||o instanceof $&&"row"==o.type?o:this.nextDisplayRow(o,t)}},{key:"prevDisplayRow",value:function(e,t){var n=this.getDisplayRowIndex(e),o=!1;return n&&(o=this.getDisplayRows()[n-1]),!t||!o||o instanceof $&&"row"==o.type?o:this.prevDisplayRow(o,t)}},{key:"findRowIndex",value:function(e,t){var n;return!!((e=this.findRow(e))&&(n=t.indexOf(e))>-1)&&n}},{key:"getData",value:function(e,t){var n=[];return this.getRows(e).forEach(function(e){"row"==e.type&&n.push(e.getData(t||"data"))}),n}},{key:"getComponents",value:function(e){var t=[];return this.getRows(e).forEach(function(e){t.push(e.getComponent())}),t}},{key:"getDataCount",value:function(e){return this.getRows(e).length}},{key:"scrollHorizontal",value:function(e){this.scrollLeft=e,this.element.scrollLeft=e,this.dispatch("scroll-horizontal",e)}},{key:"registerDataPipelineHandler",value:function(e,t){void 0!==t?(this.dataPipeline.push({handler:e,priority:t}),this.dataPipeline.sort(function(e,t){return e.priority-t.priority})):console.error("Data pipeline handlers must have a priority in order to be registered")}},{key:"registerDisplayPipelineHandler",value:function(e,t){void 0!==t?(this.displayPipeline.push({handler:e,priority:t}),this.displayPipeline.sort(function(e,t){return e.priority-t.priority})):console.error("Display pipeline handlers must have a priority in order to be registered")}},{key:"refreshActiveData",value:function(e,t,n){var o=this.table,a="",s=0,r=["all","dataPipeline","display","displayPipeline","end"];if("function"==typeof e){if((s=this.dataPipeline.findIndex(function(t){return t.handler===e}))>-1)a="dataPipeline",t&&(s==this.dataPipeline.length-1?a="display":s++);else{if(!((s=this.displayPipeline.findIndex(function(t){return t.handler===e}))>-1))return void console.error("Unable to refresh data, invalid handler provided",e);a="displayPipeline",t&&(s==this.displayPipeline.length-1?a="end":s++)}}else a=e||"all",s=0;this.redrawBlock?(!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===a&&s<this.redrawBlockRestoreConfig.index||r.indexOf(a)<r.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:e,skipStage:t,renderInPosition:n,stage:a,index:s}):(v.elVisible(this.element)?n?this.reRenderInPosition(this.refreshPipelines.bind(this,e,a,s,n)):(this.refreshPipelines(e,a,s,n),e||this.table.columnManager.renderer.renderColumns(),this.renderTable(),o.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0)):this.refreshPipelines(e,a,s,n),this.dispatch("data-refreshed"))}},{key:"refreshPipelines",value:function(e,t,n,o){switch(this.dispatch("data-refreshing"),e||(this.activeRowsPipeline[0]=this.rows.slice(0)),t){case"all":case"dataPipeline":for(var a=n;a<this.dataPipeline.length;a++){var s=this.dataPipeline[a].handler(this.activeRowsPipeline[a].slice(0));this.activeRowsPipeline[a+1]=s||this.activeRowsPipeline[a].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]),this.regenerateRowNumbers();case"display":n=0,this.resetDisplayRows();case"displayPipeline":for(var r=n;r<this.displayPipeline.length;r++){var l=this.displayPipeline[r].handler((r?this.getDisplayRows(r-1):this.activeRows).slice(0),o);this.setDisplayRows(l||this.getDisplayRows(r-1).slice(0),r)}}}},{key:"regenerateRowNumbers",value:function(){var e=this;this.rowNumColumn&&this.activeRows.forEach(function(t){var n=t.getCell(e.rowNumColumn);n&&n._generateContents()})}},{key:"setActiveRows",value:function(e){this.activeRows=e,this.activeRowsCount=this.activeRows.length}},{key:"resetDisplayRows",value:function(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}},{key:"getNextDisplayIndex",value:function(){return this.displayRows.length}},{key:"setDisplayRows",value:function(e,t){var n=!0;return t&&void 0!==this.displayRows[t]?(this.displayRows[t]=e,n=!0):(this.displayRows.push(e),n=t=this.displayRows.length-1),t==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length),n}},{key:"getDisplayRows",value:function(e){return void 0===e?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[e]||[]}},{key:"getVisibleRows",value:function(e,t){var n=Object.assign([],this.renderer.visibleRows(!t));return e&&(n=this.chain("rows-visible",[t],n,n)),n}},{key:"displayRowIterator",value:function(e){this.activeRowsPipeline.forEach(e),this.displayRows.forEach(e),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}},{key:"getRows",value:function(e){var t;switch(e){case"active":t=this.activeRows;break;case"display":t=this.table.rowManager.getDisplayRows();break;case"visible":t=this.getVisibleRows(!1,!0);break;default:t=this.chain("rows-retrieve",e,null,this.rows)||this.rows}return t}},{key:"reRenderInPosition",value:function(e){this.redrawBlock?e?e():this.redrawBlockRenderInPosition=!0:this.renderer.rerenderRows(e)}},{key:"initializeRenderer",value:function(){var e;(e="string"==typeof this.table.options.renderVertical?({virtual:R,basic:_})[this.table.options.renderVertical]:this.table.options.renderVertical)?(this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize(),this.table.element.clientHeight||this.table.options.height?this.fixedHeight=!0:this.fixedHeight=!1):console.error("Unable to find matching renderer:",table.options.renderVertical)}},{key:"getRenderMode",value:function(){return this.renderMode}},{key:"renderTable",value:function(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.layoutRefresh())):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.dispatchExternal("renderComplete")}},{key:"renderEmptyScroll",value:function(){this.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}},{key:"_clearTable",value:function(){this.tableElement,this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}},{key:"_showPlaceholder",value:function(){this.placeholder&&(this.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.placeholder),this._positionPlaceholder())}},{key:"_clearPlaceholder",value:function(){this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}},{key:"_positionPlaceholder",value:function(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.style.width=this.table.columnManager.getWidth()+"px",this.placeholderContents.style.width=this.table.rowManager.element.clientWidth+"px",this.placeholderContents.style.marginLeft=this.scrollLeft+"px")}},{key:"styleRow",value:function(e,t){var n=e.getElement();t%2?(n.classList.add("tabulator-row-even"),n.classList.remove("tabulator-row-odd")):(n.classList.add("tabulator-row-odd"),n.classList.remove("tabulator-row-even"))}},{key:"normalizeHeight",value:function(){this.activeRows.forEach(function(e){e.normalizeHeight()})}},{key:"adjustTableSize",value:function(){var e=this.element.clientHeight;if("fill"===this.renderer.verticalFillMode){var t=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));this.fixedHeight?(this.element.style.minHeight="calc(100% - "+t+"px)",this.element.style.height="calc(100% - "+t+"px)",this.element.style.maxHeight="calc(100% - "+t+"px)"):(this.element.style.height="",this.element.style.height=this.table.element.clientHeight-t+"px",this.element.scrollTop=this.scrollTop),this.renderer.resize(),this.fixedHeight||e==this.element.clientHeight||(this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw())}this._positionPlaceholder()}},{key:"reinitialize",value:function(){this.rows.forEach(function(e){e.reinitialize(!0)})}},{key:"blockRedraw",value:function(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}},{key:"restoreRedraw",value:function(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRenderInPosition&&this.reRenderInPosition(),this.redrawBlockRenderInPosition=!1}},{key:"redraw",value:function(e){var t=this.scrollLeft;this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,e?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(t))}},{key:"resetScroll",value:function(){if(this.element.scrollLeft=0,this.element.scrollTop=0,"ie"===this.table.browser){var e=document.createEvent("Event");e.initEvent("scroll",!1,!0),this.element.dispatchEvent(e)}else this.element.dispatchEvent(new Event("scroll"))}}]),r}(),T=function(n){a(r,c);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).active=!1,n.element=n.createElement(),n.containerElement=n.createContainerElement(),n.external=!1,n}return o(r,[{key:"initialize",value:function(){this.initializeElement()}},{key:"createElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-footer"),e}},{key:"createContainerElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-footer-contents"),this.element.appendChild(e),e}},{key:"initializeElement",value:function(){this.table.options.footerElement&&("string"===e(this.table.options.footerElement)?"<"===this.table.options.footerElement[0]?this.containerElement.innerHTML=this.table.options.footerElement:(this.external=!0,this.containerElement=document.querySelector(this.table.options.footerElement)):this.element=this.table.options.footerElement)}},{key:"getElement",value:function(){return this.element}},{key:"append",value:function(e){this.activate(),this.containerElement.appendChild(e),this.table.rowManager.adjustTableSize()}},{key:"prepend",value:function(e){this.activate(),this.element.insertBefore(e,this.element.firstChild),this.table.rowManager.adjustTableSize()}},{key:"remove",value:function(e){e.parentNode.removeChild(e),this.deactivate()}},{key:"deactivate",value:function(e){this.element.firstChild&&!e||(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}},{key:"activate",value:function(){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display=""))}},{key:"redraw",value:function(){this.dispatch("footer-redraw")}}]),r}(),L=function(e){a(s,c);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).el=null,o.abortClasses=["tabulator-headers","tabulator-table"],o.previousTargets={},o.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","touchstart","touchend"],o.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},o.pseudoTrackers={row:{subscriber:null,target:null},cell:{subscriber:null,target:null},group:{subscriber:null,target:null},column:{subscriber:null,target:null}},o.pseudoTracking=!1,o}return o(s,[{key:"initialize",value:function(){this.el=this.table.element,this.buildListenerMap(),this.bindSubscriptionWatchers()}},{key:"buildListenerMap",value:function(){var e={};this.listeners.forEach(function(t){e[t]={handler:null,components:[]}}),this.listeners=e}},{key:"bindPseudoEvents",value:function(){var e=this;Object.keys(this.pseudoTrackers).forEach(function(t){e.pseudoTrackers[t].subscriber=e.pseudoMouseEnter.bind(e,t),e.subscribe(t+"-mouseover",e.pseudoTrackers[t].subscriber)}),this.pseudoTracking=!0}},{key:"pseudoMouseEnter",value:function(e,t,n){this.pseudoTrackers[e].target!==n&&(this.pseudoTrackers[e].target&&this.dispatch(e+"-mouseleave",t,this.pseudoTrackers[e].target),this.pseudoMouseLeave(e,t),this.pseudoTrackers[e].target=n,this.dispatch(e+"-mouseenter",t,n))}},{key:"pseudoMouseLeave",value:function(e,t){var n=this,o=Object.keys(this.pseudoTrackers),a={row:["cell"],cell:["row"]};(o=o.filter(function(t){var n=a[e];return t!==e&&(!n||n&&!n.includes(t))})).forEach(function(e){var o=n.pseudoTrackers[e].target;n.pseudoTrackers[e].target&&(n.dispatch(e+"-mouseleave",t,o),n.pseudoTrackers[e].target=null)})}},{key:"bindSubscriptionWatchers",value:function(){for(var e=Object.keys(this.listeners),t=0,n=Object.values(this.componentMap);t<n.length;t++){var o,a=n[t],s=h(e);try{for(s.s();!(o=s.n()).done;){var r=o.value,l=a+"-"+r;this.subscriptionChange(l,this.subscriptionChanged.bind(this,a,r))}}catch(u){s.e(u)}finally{s.f()}}this.subscribe("table-destroy",this.clearWatchers.bind(this))}},{key:"subscriptionChanged",value:function(e,t,n){var o=this.listeners[t].components,a=o.indexOf(e),s=!1;n?-1===a&&(o.push(e),s=!0):this.subscribed(e+"-"+t)||a>-1&&(o.splice(a,1),s=!0),"mouseenter"!==t&&"mouseleave"!==t||this.pseudoTracking||this.bindPseudoEvents(),s&&this.updateEventListeners()}},{key:"updateEventListeners",value:function(){for(var e in this.listeners){var t=this.listeners[e];t.components.length?t.handler||(t.handler=this.track.bind(this,e),this.el.addEventListener(e,t.handler)):t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}},{key:"track",value:function(e,t){var n=t.composedPath&&t.composedPath()||t.path,o=this.findTargets(n);o=this.bindComponents(e,o),this.triggerEvents(e,t,o),!this.pseudoTracking||"mouseover"!=e&&"mouseleave"!=e||Object.keys(o).length||this.pseudoMouseLeave("none",t)}},{key:"findTargets",value:function(e){var t,n=this,o={},a=Object.keys(this.componentMap),s=h(e);try{for(s.s();!(t=s.n()).done;){var r=t.value,l=r.classList?_toConsumableArray(r.classList):[];if(l.filter(function(e){return n.abortClasses.includes(e)}).length)break;var u,c=h(l.filter(function(e){return a.includes(e)}));try{for(c.s();!(u=c.n()).done;){var d=u.value;o[this.componentMap[d]]=r}}catch(p){c.e(p)}finally{c.f()}}}catch(m){s.e(m)}finally{s.f()}return o.group&&o.group===o.row&&delete o.row,o}},{key:"bindComponents",value:function(e,t){var n,o=this,a=Object.keys(t).reverse(),s=this.listeners[e],r={},l=h(a);try{for(l.s();!(n=l.n()).done;)(function(){var e=n.value,a=void 0,l=t[e],u=o.previousTargets[e];if(u&&u.target===l)a=u.component;else switch(e){case"row":case"group":(s.components.includes("row")||s.components.includes("cell")||s.components.includes("group"))&&(a=o.table.rowManager.getVisibleRows(!0).find(function(e){return e.getElement()===l}),t.row&&t.row.parentNode&&t.row.parentNode.closest(".tabulator-row")&&(t[e]=!1));break;case"column":s.components.includes("column")&&(a=o.table.columnManager.findColumn(l));break;case"cell":s.components.includes("cell")&&(t.row instanceof $?a=t.row.findCell(l):t.row&&console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"))}a&&(t[e]=a,r[e]={target:l,component:a})})()}catch(u){l.e(u)}finally{l.f()}return this.previousTargets=r,t}},{key:"triggerEvents",value:function(e,t,n){var o=this.listeners[e];for(var a in n)n[a]&&o.components.includes(a)&&this.dispatch(a+"-"+e,t,n[a])}},{key:"clearWatchers",value:function(){for(var e in this.listeners){var t=this.listeners[e];t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}}]),s}(),M=function(){function e(n){t(this,e),this.table=n,this.bindings={}}return o(e,[{key:"bind",value:function(e,t,n){this.bindings[e]||(this.bindings[e]={}),this.bindings[e][t]?console.warn("Unable to bind component handler, a matching function name is already bound",e,t,n):this.bindings[e][t]=n}},{key:"handle",value:function(e,t,n){if(this.bindings[e]&&this.bindings[e][n]&&"function"==typeof this.bindings[e][n].bind)return this.bindings[e][n].bind(null,t);"then"===n||"string"!=typeof n||n.startsWith("_")||console.error("The "+e+" component does not have a "+n+" function, have you checked that you have the correct Tabulator module installed?")}}]),e}(),D=function(n){a(r,c);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).requestOrder=0,n.loading=!1,n}return o(r,[{key:"initialize",value:function(){}},{key:"load",value:function(t,n,o,a,s){var r=this,l=++this.requestOrder;return this.dispatchExternal("dataLoading",t),t&&(0==t.indexOf("{")||0==t.indexOf("["))&&(t=JSON.parse(t)),this.confirm("data-loading",[t,n,o,s])?(this.loading=!0,s||this.alertLoader(),n=this.chain("data-params",[t,o,s],n||{},n||{}),n=this.mapParams(n,this.table.options.dataSendParams),this.chain("data-load",[t,n,o,s],!1,Promise.resolve([])).then(function(t){Array.isArray(t)||"object"!=e(t)||(t=r.mapParams(t,r.objectInvert(r.table.options.dataReceiveParams)));var n=r.chain("data-loaded",t,null,t);l==r.requestOrder?(r.clearAlert(),!1!==n&&(r.dispatchExternal("dataLoaded",n),r.table.rowManager.setData(n,a,!a))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")}).catch(function(e){console.error("Data Load Error: ",e),r.dispatchExternal("dataLoadError",e),s||r.alertError(),setTimeout(function(){r.clearAlert()},r.table.options.dataLoaderErrorTimeout)}).finally(function(){r.loading=!1})):(this.dispatchExternal("dataLoaded",t),t||(t=[]),this.table.rowManager.setData(t,a,!a),Promise.resolve())}},{key:"mapParams",value:function(e,t){var n={};for(var o in e)n[t.hasOwnProperty(o)?t[o]:o]=e[o];return n}},{key:"objectInvert",value:function(e){var t={};for(var n in e)t[e[n]]=n;return t}},{key:"blockActiveLoad",value:function(){this.requestOrder++}},{key:"alertLoader",value:function(){("function"==typeof this.table.options.dataLoader?this.table.options.dataLoader():this.table.options.dataLoader)&&this.table.alertManager.alert(this.table.options.dataLoaderLoading||this.langText("data|loading"))}},{key:"alertError",value:function(){this.table.alertManager.alert(this.table.options.dataLoaderError||this.langText("data|error"),"error")}},{key:"clearAlert",value:function(){this.table.alertManager.clear()}}]),r}(),z=function(){function e(n,o,a){t(this,e),this.table=n,this.events={},this.optionsList=o||{},this.subscriptionNotifiers={},this.dispatch=a?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=a}return o(e,[{key:"subscriptionChange",value:function(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifiySubscriptionChange(e,!0)}},{key:"subscribe",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t),this._notifiySubscriptionChange(e,!0)}},{key:"unsubscribe",value:function(e,t){var n;if(this.events[e]){if(t){if(!((n=this.events[e].findIndex(function(e){return e===t}))>-1))return void console.warn("Cannot remove event, no matching event found:",e,t);this.events[e].splice(n,1)}else delete this.events[e];this._notifiySubscriptionChange(e,!1)}else console.warn("Cannot remove event, no events set on:",e)}},{key:"subscribed",value:function(e){return this.events[e]&&this.events[e].length}},{key:"_notifiySubscriptionChange",value:function(e,t){var n=this.subscriptionNotifiers[e];n&&n.forEach(function(e){e(t)})}},{key:"_dispatch",value:function(){var e,t=this,n=Array.from(arguments),o=n.shift();return this.events[o]&&this.events[o].forEach(function(o,a){var s=o.apply(t.table,n);a||(e=s)}),e}},{key:"_debugDispatch",value:function(){var e,t=Array.from(arguments),n=t[0];return t[0]="ExternalEvent:"+t[0],(!0===this.debug||this.debug.includes(n))&&(e=console).log.apply(e,_toConsumableArray(t)),this._dispatch.apply(this,arguments)}}]),e}(),P=function(){function e(n){t(this,e),this.events={},this.subscriptionNotifiers={},this.dispatch=n?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=n?this._debugChain.bind(this):this._chain.bind(this),this.confirm=n?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=n}return o(e,[{key:"subscriptionChange",value:function(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifiySubscriptionChange(e,!0)}},{key:"subscribe",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,priority:n}),this.events[e].sort(function(e,t){return e.priority-t.priority}),this._notifiySubscriptionChange(e,!0)}},{key:"unsubscribe",value:function(e,t){var n;if(this.events[e]){if(t){if(!((n=this.events[e].findIndex(function(e){return e.callback===t}))>-1))return void console.warn("Cannot remove event, no matching event found:",e,t);this.events[e].splice(n,1)}this._notifiySubscriptionChange(e,!1)}else console.warn("Cannot remove event, no events set on:",e)}},{key:"subscribed",value:function(e){return this.events[e]&&this.events[e].length}},{key:"_chain",value:function(e,t,n,o){var a=this,s=n;return Array.isArray(t)||(t=[t]),this.subscribed(e)?(this.events[e].forEach(function(e,n){s=e.callback.apply(a,t.concat([s]))}),s):"function"==typeof o?o():o}},{key:"_confirm",value:function(e,t){var n=this,o=!1;return Array.isArray(t)||(t=[t]),this.subscribed(e)&&this.events[e].forEach(function(e,a){e.callback.apply(n,t)&&(o=!0)}),o}},{key:"_notifiySubscriptionChange",value:function(e,t){var n=this.subscriptionNotifiers[e];n&&n.forEach(function(e){e(t)})}},{key:"_dispatch",value:function(){var e=this,t=Array.from(arguments),n=t.shift();this.events[n]&&this.events[n].forEach(function(n){n.callback.apply(e,t)})}},{key:"_debugDispatch",value:function(){var e,t=Array.from(arguments),n=t[0];return t[0]="InternalEvent:"+n,(!0===this.debug||this.debug.includes(n))&&(e=console).log.apply(e,_toConsumableArray(t)),this._dispatch.apply(this,arguments)}},{key:"_debugChain",value:function(){var e,t=Array.from(arguments),n=t[0];return t[0]="InternalEvent:"+n,(!0===this.debug||this.debug.includes(n))&&(e=console).log.apply(e,_toConsumableArray(t)),this._chain.apply(this,arguments)}},{key:"_debugConfirm",value:function(){var e,t=Array.from(arguments),n=t[0];return t[0]="InternalEvent:"+n,(!0===this.debug||this.debug.includes(n))&&(e=console).log.apply(e,_toConsumableArray(t)),this._confirm.apply(this,arguments)}}]),e}(),S=function(){function e(){t(this,e)}return o(e,null,[{key:"register",value:function(t){e.tables.push(t)}},{key:"deregister",value:function(t){var n=e.tables.indexOf(t);n>-1&&e.tables.splice(n,1)}},{key:"lookupTable",value:function(t,n){var o,a,s=[];if("string"==typeof t){if((o=document.querySelectorAll(t)).length)for(var r=0;r<o.length;r++)(a=e.matchElement(o[r]))&&s.push(a)}else"undefined"!=typeof HTMLElement&&t instanceof HTMLElement||t instanceof G?(a=e.matchElement(t))&&s.push(a):Array.isArray(t)?t.forEach(function(t){s=s.concat(e.lookupTable(t))}):n||console.warn("Table Connection Error - Invalid Selector",t);return s}},{key:"matchElement",value:function(t){return e.tables.find(function(e){return t instanceof G?e===t:e.element===t})}}]),e}();S.tables=[];var F=function(e){a(s,c);var n=u(s);function s(e,o,a){var r;return t(this,s),(r=n.call(this,e)).element=o,r.container=r._lookupContainer(),r.parent=a,r.reversedX=!1,r.childPopup=null,r.blurable=!1,r.blurCallback=null,r.renderedCallback=null,r.visible=!1,r.element.classList.add("tabulator-popup-container"),r.blurEvent=r.hide.bind(l(r),!1),r.escEvent=r._escapeCheck.bind(l(r)),r}return o(s,[{key:"_lookupContainer",value:function(){var e=this.table.options.popupContainer;return"string"==typeof e?(e=document.querySelector(e))||console.warn("Menu Error - no container element found matching selector:",this.table.options.popupContainer,"(defaulting to document body)"):!0===e&&(e=this.table.element),e&&!this._checkContainerIsParent(e)&&(e=!1,console.warn("Menu Error - container element does not contain this table:",this.table.options.popupContainer,"(defaulting to document body)")),e||(e=document.body),e}},{key:"_checkContainerIsParent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.table.element;return e===t||!!t.parentNode&&this._checkContainerIsParent(e,t.parentNode)}},{key:"renderCallback",value:function(e){this.renderedCallback=e}},{key:"containerEventCoords",value:function(e){var t=!(e instanceof MouseEvent),n=t?e.touches[0].pageX:e.pageX,o=t?e.touches[0].pageY:e.pageY;if(this.container!==document.body){var a=v.elOffset(this.container);n-=a.left,o-=a.top}return{x:n,y:o}}},{key:"elementPositionCoords",value:function(e){var t,n,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right",s=v.elOffset(e);switch(this.container!==document.body&&(t=v.elOffset(this.container),s.left-=t.left,s.top-=t.top),a){case"right":n=s.left+e.offsetWidth,o=s.top-1;break;case"bottom":n=s.left,o=s.top+e.offsetHeight}return{x:n,y:o,offset:s}}},{key:"show",value:function(e,t){var n,o,a,s,r;return e instanceof HTMLElement?(a=e,s=(r=this.elementPositionCoords(e,t)).offset,n=r.x,o=r.y):"number"==typeof e?(s={top:0,left:0},n=e,o=t):(n=(r=this.containerEventCoords(e)).x,o=r.y,this.reversedX=!1),this.element.style.top=o+"px",this.element.style.left=n+"px",this.container.appendChild(this.element),"function"==typeof this.renderedCallback&&this.renderedCallback(),this._fitToScreen(n,o,a,s,t),this.visible=!0,this}},{key:"_fitToScreen",value:function(e,t,n,o,a){var s=this.container===document.body?document.documentElement.scrollTop:this.container.scrollTop;(e+this.element.offsetWidth>=this.container.offsetWidth||this.reversedX)&&(this.element.style.left="",this.element.style.right=n?this.container.offsetWidth-o.left+"px":this.container.offsetWidth-e+"px",this.reversedX=!0),t+this.element.offsetHeight>Math.max(this.container.offsetHeight,s?this.container.scrollHeight:0)&&(n?"bottom"===a?this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight-n.offsetHeight-1+"px":this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+n.offsetHeight+1+"px":this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+"px")}},{key:"isVisible",value:function(){return this.visible}},{key:"hideOnBlur",value:function(e){var t=this;return this.blurable=!0,this.visible&&(setTimeout(function(){t.table.rowManager.element.addEventListener("scroll",t.blurEvent),t.subscribe("cell-editing",t.blurEvent),document.body.addEventListener("click",t.blurEvent),document.body.addEventListener("contextmenu",t.blurEvent),window.addEventListener("resize",t.blurEvent),document.body.addEventListener("keydown",t.escEvent)},100),this.blurCallback=e),this}},{key:"_escapeCheck",value:function(e){27==e.keyCode&&this.hide()}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.visible&&(this.blurable&&(document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent),this.unsubscribe("cell-editing",this.blurEvent)),this.childPopup&&this.childPopup.hide(),this.parent&&(this.parent.childPopup=null),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.visible=!1,this.blurCallback&&!e&&this.blurCallback()),this}},{key:"child",value:function(e){return this.childPopup&&this.childPopup.hide(),this.childPopup=new s(this.table,e,this),this.childPopup}}]),s}(),H=function(e){a(s,c);var n=u(s);function s(e,o){var a;return t(this,s),(a=n.call(this,e))._handler=null,a}return o(s,[{key:"initialize",value:function(){}},{key:"registerTableOption",value:function(e,t){this.table.optionsList.register(e,t)}},{key:"registerColumnOption",value:function(e,t){this.table.columnManager.optionsList.register(e,t)}},{key:"registerTableFunction",value:function(e,t){var n=this;void 0===this.table[e]?this.table[e]=function(){return n.table.initGuard(e),t.apply(void 0,arguments)}:console.warn("Unable to bind table function, name already in use",e)}},{key:"registerComponentFunction",value:function(e,t,n){return this.table.componentFunctionBinder.bind(e,t,n)}},{key:"registerDataHandler",value:function(e,t){this.table.rowManager.registerDataPipelineHandler(e,t),this._handler=e}},{key:"registerDisplayHandler",value:function(e,t){this.table.rowManager.registerDisplayPipelineHandler(e,t),this._handler=e}},{key:"refreshData",value:function(e,t){t||(t=this._handler),t&&this.table.rowManager.refreshActiveData(t,!1,e)}},{key:"footerAppend",value:function(e){return this.table.footerManager.append(e)}},{key:"footerPrepend",value:function(e){return this.table.footerManager.prepend(e)}},{key:"footerRemove",value:function(e){return this.table.footerManager.remove(e)}},{key:"popup",value:function(e,t){return new F(this.table,e,t)}},{key:"alert",value:function(e,t){return this.table.alertManager.alert(e,t)}},{key:"clearAlert",value:function(){return this.table.alertManager.clear()}}]),s}();function O(e){e.forEach(function(e){e.reinitializeWidth()}),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}var A=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e,"layout")).mode=null,o.registerTableOption("layout","fitData"),o.registerTableOption("layoutColumnsOnNewData",!1),o.registerColumnOption("widthGrow"),o.registerColumnOption("widthShrink"),o}return o(s,[{key:"initialize",value:function(){var e=this.table.options.layout;s.modes[e]?this.mode=e:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+e),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode)}},{key:"getMode",value:function(){return this.mode}},{key:"layout",value:function(){this.dispatch("layout-refreshing"),s.modes[this.mode].call(this,this.table.columnManager.columnsByIndex),this.dispatch("layout-refreshed")}}]),s}();A.moduleName="layout",A.modes={fitData:function(e){this.table.columnManager.renderer.reinitializeColumnWidths(e),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitDataFill:O,fitDataTable:O,fitDataStretch:function(e){var t=this,n=0,o=this.table.rowManager.element.clientWidth,a=0,s=!1;e.forEach(function(e,o){e.widthFixed||e.reinitializeWidth(),(t.table.options.responsiveLayout?e.modules.responsive.visible:e.visible)&&(s=e),e.visible&&(n+=e.getWidth())}),s?(a=o-n+s.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(s.setWidth(0),this.table.modules.responsiveLayout.update()),a>0?s.setWidth(a):s.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitColumns:function(e){var t,n,o=this.table.element.clientWidth,a=0,s=0,r=0,l=[],u=[],h=0,c=0;function d(e){return"string"==typeof e?e.indexOf("%")>-1?o/100*parseInt(e):parseInt(e):e}function p(e,t,n,o){var a=[],s=0,l=0,u=0,h=r,c=0,m=0,f=[];function g(e){return n*(e.column.definition.widthGrow||1)}function v(e){return d(e.width)-n*(e.column.definition.widthShrink||0)}return e.forEach(function(e,s){var r=o?v(e):g(e);e.column.minWidth>=r?a.push(e):e.column.maxWidth&&e.column.maxWidth<r?(e.width=e.column.maxWidth,t-=e.column.maxWidth,(h-=o?e.column.definition.widthShrink||1:e.column.definition.widthGrow||1)&&(n=Math.floor(t/h))):(f.push(e),m+=o?e.column.definition.widthShrink||1:e.column.definition.widthGrow||1)}),a.length?(a.forEach(function(e){s+=o?e.width-e.column.minWidth:e.column.minWidth,e.width=e.column.minWidth}),c=(l=t-s)-(u=m?Math.floor(l/m):l)*m,c+=p(f,l,u,o)):(c=m?t-Math.floor(t/m)*m:t,f.forEach(function(e){e.width=o?v(e):g(e)})),c}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(o-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),e.forEach(function(e){var t,n,o;e.visible&&(t=e.definition.width,n=parseInt(e.minWidth),t?(o=d(t),a+=o>n?o:n,e.definition.widthShrink&&(u.push({column:e,width:o>n?o:n}),h+=e.definition.widthShrink)):(l.push({column:e,width:0}),r+=e.definition.widthGrow||1))}),t=Math.floor((s=o-a)/r),c=p(l,s,t,!1),l.length&&c>0&&(l[l.length-1].width+=+c),l.forEach(function(e){s-=e.width}),(n=Math.abs(c)+s)>0&&h&&(c=p(u,n,Math.floor(n/h),!0)),u.length&&(u[u.length-1].width-=c),l.forEach(function(e){e.column.setWidth(e.width)}),u.forEach(function(e){e.column.setWidth(e.width)})}};var B=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).locale="default",n.lang=!1,n.bindings={},n.langList={},n.registerTableOption("locale",!1),n.registerTableOption("langs",{}),n}return o(r,[{key:"initialize",value:function(){for(var e in this.langList=v.deepClone(r.langs),!1!==this.table.options.columnDefaults.headerFilterPlaceholder&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder),this.table.options.langs)this.installLang(e,this.table.options.langs[e]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}},{key:"setHeaderFilterPlaceholder",value:function(e){this.langList.default.headerFilters.default=e}},{key:"setHeaderFilterColumnPlaceholder",value:function(e,t){this.langList.default.headerFilters.columns[e]=t,this.lang&&!this.lang.headerFilters.columns[e]&&(this.lang.headerFilters.columns[e]=t)}},{key:"installLang",value:function(e,t){this.langList[e]?this._setLangProp(this.langList[e],t):this.langList[e]=t}},{key:"_setLangProp",value:function(t,n){for(var o in n)t[o]&&"object"==e(t[o])?this._setLangProp(t[o],n[o]):t[o]=n[o]}},{key:"setLocale",value:function(t){if(!0===(t=t||"default")&&navigator.language&&(t=navigator.language.toLowerCase()),t&&!this.langList[t]){var n=t.split("-")[0];this.langList[n]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",t,n),t=n):(console.warn("Localization Error - Matching locale not found, using default: ",t),t="default")}this.locale=t,this.lang=v.deepClone(this.langList.default||{}),"default"!=t&&function t(n,o){for(var a in n)"object"==e(n[a])?(o[a]||(o[a]={}),t(n[a],o[a])):o[a]=n[a]}(this.langList[t],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}},{key:"getLocale",value:function(e){return this.locale}},{key:"getLang",value:function(e){return e?this.langList[e]:this.lang}},{key:"getText",value:function(e,t){var n=(e=t?e+"|"+t:e).split("|");return this._getLangElement(n,this.locale)||""}},{key:"_getLangElement",value:function(e,t){var n=this.lang;return e.forEach(function(e){var t;n&&(n=void 0!==(t=n[e])&&t)}),n}},{key:"bind",value:function(e,t){this.bindings[e]||(this.bindings[e]=[]),this.bindings[e].push(t),t(this.getText(e),this.lang)}},{key:"_executeBindings",value:function(){var e=this,t=function(t){e.bindings[t].forEach(function(n){n(e.getText(t),e.lang)})};for(var n in this.bindings)t(n)}}]),r}();B.moduleName="localize",B.langs={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All",counter:{showing:"Showing",of:"of",rows:"rows",pages:"pages"}},headerFilters:{default:"filter column...",columns:{}}}};var I=function(e){a(s,H);var n=u(s);function s(e){return t(this,s),n.call(this,e)}return o(s,[{key:"initialize",value:function(){this.registerTableFunction("tableComms",this.receive.bind(this))}},{key:"getConnections",value:function(e){var t=this,n=[];return S.lookupTable(e).forEach(function(e){t.table!==e&&n.push(e)}),n}},{key:"send",value:function(e,t,n,o){var a=this,s=this.getConnections(e);s.forEach(function(e){e.tableComms(a.table.element,t,n,o)}),!s.length&&e&&console.warn("Table Connection Error - No tables matching selector found",e)}},{key:"receive",value:function(e,t,n,o){if(this.table.modExists(t))return this.table.modules[t].commsReceived(e,n,o);console.warn("Inter-table Comms Error - no such module:",t)}}]),s}();I.moduleName="comms";var V=Object.freeze({__proto__:null,LayoutModule:A,LocalizeModule:B,CommsModule:I}),N=function(){function n(e,o){t(this,n),this.bindStaticFuctionality(e),this.bindModules(e,V,!0),o&&this.bindModules(e,o)}return o(n,[{key:"bindStaticFuctionality",value:function(t){t.moduleBindings={},t.extendModule=function(n,o,a){if(t.moduleBindings[n]){var s=t.moduleBindings[n][o];if(s){if("object"==e(a))for(var r in a)s[r]=a[r];else console.warn("Module Error - Invalid value type, it must be an object")}else console.warn("Module Error - property does not exist:",o)}else console.warn("Module Error - module does not exist:",n)},t.registerModule=function(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){t.registerModuleBinding(e)})},t.registerModuleBinding=function(e){t.moduleBindings[e.moduleName]=e},t.findTable=function(e){var t=S.lookupTable(e,!0);return!(Array.isArray(t)&&!t.length)&&t},t.prototype.bindModules=function(){var e=[],n=[],o=[];for(var a in this.modules={},t.moduleBindings){var s=t.moduleBindings[a],r=new s(this);this.modules[a]=r,s.prototype.moduleCore?this.modulesCore.push(r):s.moduleInitOrder?s.moduleInitOrder<0?e.push(r):n.push(r):o.push(r)}e.sort(function(e,t){return e.moduleInitOrder>t.moduleInitOrder?1:-1}),n.sort(function(e,t){return e.moduleInitOrder>t.moduleInitOrder?1:-1}),this.modulesRegular=e.concat(o.concat(n))}}},{key:"bindModules",value:function(e,t,n){var o=Object.values(t);n&&o.forEach(function(e){e.prototype.moduleCore=!0}),e.registerModule(o)}}]),n}(),W=function(e){a(s,c);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).element=o._createAlertElement(),o.msgElement=o._createMsgElement(),o.type=null,o.element.appendChild(o.msgElement),o}return o(s,[{key:"_createAlertElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-alert"),e}},{key:"_createMsgElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-alert-msg"),e.setAttribute("role","alert"),e}},{key:"_typeClass",value:function(){return"tabulator-alert-state-"+this.type}},{key:"alert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"msg";if(e){for(this.clear(),this.type=t;this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.add(this._typeClass()),"function"==typeof e&&(e=e()),e instanceof HTMLElement?this.msgElement.appendChild(e):this.msgElement.innerHTML=e,this.table.element.appendChild(this.element)}}},{key:"clear",value:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.msgElement.classList.remove(this._typeClass())}}]),s}(),G=function(){function n(e,o){var a=this;t(this,n),this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.alertManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new M(this),this.dataLoader=!1,this.modules={},this.modulesCore=[],this.modulesRegular=[],this.optionsList=new b(this,"table constructor"),this.initialized=!1,this.initializeElement(e)&&(this.initializeCoreSystems(o),setTimeout(function(){a._create()})),S.register(this)}return o(n,[{key:"initializeElement",value:function(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement?(this.element=e,!0):"string"==typeof e?(this.element=document.querySelector(e),!!this.element||(console.error("Tabulator Creation Error - no element found matching selector: ",e),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",e),!1)}},{key:"initializeCoreSystems",value:function(e){this.columnManager=new k(this),this.rowManager=new x(this),this.footerManager=new T(this),this.dataLoader=new D(this),this.alertManager=new W(this),this.bindModules(),this.options=this.optionsList.generate(n.defaultOptions,e),this._clearObjectPointers(),this._mapDeprecatedFunctionality(),this.externalEvents=new z(this,this.options,this.options.debugEventsExternal),this.eventBus=new P(this.options.debugEventsInternal),this.interactionMonitor=new L(this),this.dataLoader.initialize(),this.footerManager.initialize()}},{key:"_mapDeprecatedFunctionality",value:function(){}},{key:"_clearSelection",value:function(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}},{key:"_create",value:function(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this._loadInitialData(),this.initialized=!0,this.externalEvents.dispatch("tableBuilt")}},{key:"_rtlCheck",value:function(){var e=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if("rtl"!==e.direction)break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}},{key:"_clearObjectPointers",value:function(){this.options.columns=this.options.columns.slice(0),Array.isArray(this.options.data)&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}},{key:"_buildElement",value:function(){var t,n=this.element,o=this.options;if("TABLE"===n.tagName){this.originalElement=this.element,t=document.createElement("div");var a=n.attributes;for(var s in a)"object"==e(a[s])&&t.setAttribute(a[s].name,a[s].value);n.parentNode.replaceChild(t,n),this.element=n=t}for(n.classList.add("tabulator"),n.setAttribute("role","grid");n.firstChild;)n.removeChild(n.firstChild);o.height&&(o.height=isNaN(o.height)?o.height:o.height+"px",n.style.height=o.height),!1!==o.minHeight&&(o.minHeight=isNaN(o.minHeight)?o.minHeight:o.minHeight+"px",n.style.minHeight=o.minHeight),!1!==o.maxHeight&&(o.maxHeight=isNaN(o.maxHeight)?o.maxHeight:o.maxHeight+"px",n.style.maxHeight=o.maxHeight)}},{key:"_initializeTable",value:function(){var e=this.element,t=this.options;this.interactionMonitor.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modulesCore.forEach(function(e){e.initialize()}),e.appendChild(this.columnManager.getElement()),e.appendChild(this.rowManager.getElement()),t.footerElement&&this.footerManager.activate(),t.autoColumns&&t.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modulesRegular.forEach(function(e){e.initialize()}),this.columnManager.setColumns(t.columns),this.eventBus.dispatch("table-built")}},{key:"_loadInitialData",value:function(){this.dataLoader.load(this.options.data)}},{key:"destroy",value:function(){var e=this.element;for(S.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.rows.forEach(function(e){e.wipe()}),this.rowManager.rows=[],this.rowManager.activeRows=[],this.rowManager.displayRows=[];e.firstChild;)e.removeChild(e.firstChild);e.classList.remove("tabulator")}},{key:"_detectBrowser",value:function(){var e=navigator.userAgent||navigator.vendor||window.opera;e.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):e.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):e.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.slice(0,4))}},{key:"initGuard",value:function(e,t){var n,o;return this.options.debugInitialization&&!this.initialized&&(e||(e=" "==(o="Error"==(n=Error().stack.split("\n"))[0]?n[2]:n[1])[0]?o.trim().split(" ")[1].split(".")[1]:o.trim().split("@")[0]),console.warn("Table Not Initialized - Calling the "+e+" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function."+(t?" "+t:""))),this.initialized}},{key:"blockRedraw",value:function(){return this.initGuard(),this.rowManager.blockRedraw()}},{key:"restoreRedraw",value:function(){return this.initGuard(),this.rowManager.restoreRedraw()}},{key:"setData",value:function(e,t,n){return this.initGuard(!1,"To set initial data please use the 'data' property in the table constructor."),this.dataLoader.load(e,t,n,!1)}},{key:"clearData",value:function(){this.initGuard(),this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}},{key:"getData",value:function(e){return this.rowManager.getData(e)}},{key:"getDataCount",value:function(e){return this.rowManager.getDataCount(e)}},{key:"replaceData",value:function(e,t,n){return this.initGuard(),this.dataLoader.load(e,t,n,!0,!0)}},{key:"updateData",value:function(e){var t=this,n=0;return this.initGuard(),new Promise(function(o,a){t.dataLoader.blockActiveLoad(),"string"==typeof e&&(e=JSON.parse(e)),e?e.forEach(function(e){var a=t.rowManager.findRow(e[t.options.index]);a&&(n++,a.updateData(e).then(function(){--n||o()}))}):(console.warn("Update Error - No data provided"),a("Update Error - No data provided"))})}},{key:"addData",value:function(e,t,n){var o=this;return this.initGuard(),new Promise(function(a,s){o.dataLoader.blockActiveLoad(),"string"==typeof e&&(e=JSON.parse(e)),e?o.rowManager.addRows(e,t,n).then(function(e){var t=[];e.forEach(function(e){t.push(e.getComponent())}),a(t)}):(console.warn("Update Error - No data provided"),s("Update Error - No data provided"))})}},{key:"updateOrAddData",value:function(e){var t=this,n=[],o=0;return this.initGuard(),new Promise(function(a,s){t.dataLoader.blockActiveLoad(),"string"==typeof e&&(e=JSON.parse(e)),e?e.forEach(function(e){var s=t.rowManager.findRow(e[t.options.index]);o++,s?s.updateData(e).then(function(){o--,n.push(s.getComponent()),o||a(n)}):t.rowManager.addRows(e).then(function(e){o--,n.push(e[0].getComponent()),o||a(n)})}):(console.warn("Update Error - No data provided"),s("Update Error - No data provided"))})}},{key:"getRow",value:function(e){var t=this.rowManager.findRow(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}},{key:"getRowFromPosition",value:function(e,t){var n=this.rowManager.getRowFromPosition(e,t);return n?n.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}},{key:"deleteRow",value:function(e){var t=this,n=[];this.initGuard(),Array.isArray(e)||(e=[e]);var o,a=h(e);try{for(a.s();!(o=a.n()).done;){var s=o.value,r=this.rowManager.findRow(s,!0);if(!r)return console.error("Delete Error - No matching row found:",s),Promise.reject("Delete Error - No matching row found");n.push(r)}}catch(l){a.e(l)}finally{a.f()}return n.sort(function(e,n){return t.rowManager.rows.indexOf(e)>t.rowManager.rows.indexOf(n)?1:-1}),n.forEach(function(e){e.delete()}),this.rowManager.reRenderInPosition(),Promise.resolve()}},{key:"addRow",value:function(e,t,n){return this.initGuard(),"string"==typeof e&&(e=JSON.parse(e)),this.rowManager.addRows(e,t,n).then(function(e){return e[0].getComponent()})}},{key:"updateOrAddRow",value:function(e,t){var n=this.rowManager.findRow(e);return this.initGuard(),"string"==typeof t&&(t=JSON.parse(t)),n?n.updateData(t).then(function(){return n.getComponent()}):this.rowManager.addRows(t).then(function(e){return e[0].getComponent()})}},{key:"updateRow",value:function(e,t){var n=this.rowManager.findRow(e);return this.initGuard(),"string"==typeof t&&(t=JSON.parse(t)),n?n.updateData(t).then(function(){return Promise.resolve(n.getComponent())}):(console.warn("Update Error - No matching row found:",e),Promise.reject("Update Error - No matching row found"))}},{key:"scrollToRow",value:function(e,t,n){var o=this.rowManager.findRow(e);return o?this.rowManager.scrollToRow(o,t,n):(console.warn("Scroll Error - No matching row found:",e),Promise.reject("Scroll Error - No matching row found"))}},{key:"moveRow",value:function(e,t,n){var o=this.rowManager.findRow(e);this.initGuard(),o?o.moveToRow(t,n):console.warn("Move Error - No matching row found:",e)}},{key:"getRows",value:function(e){return this.rowManager.getComponents(e)}},{key:"getRowPosition",value:function(e,t){var n=this.rowManager.findRow(e);return n?this.rowManager.getRowPosition(n,t):(console.warn("Position Error - No matching row found:",e),!1)}},{key:"setColumns",value:function(e){this.initGuard(!1,"To set initial columns please use the 'columns' property in the table constructor"),this.columnManager.setColumns(e)}},{key:"getColumns",value:function(e){return this.columnManager.getComponents(e)}},{key:"getColumn",value:function(e){var t=this.columnManager.findColumn(e);return t?t.getComponent():(console.warn("Find Error - No matching column found:",e),!1)}},{key:"getColumnDefinitions",value:function(){return this.columnManager.getDefinitionTree()}},{key:"showColumn",value:function(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),!t)return console.warn("Column Show Error - No matching column found:",e),!1;t.show()}},{key:"hideColumn",value:function(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),!t)return console.warn("Column Hide Error - No matching column found:",e),!1;t.hide()}},{key:"toggleColumn",value:function(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),!t)return console.warn("Column Visibility Toggle Error - No matching column found:",e),!1;t.visible?t.hide():t.show()}},{key:"addColumn",value:function(e,t,n){var o=this.columnManager.findColumn(n);return this.initGuard(),this.columnManager.addColumn(e,t,o).then(function(e){return e.getComponent()})}},{key:"deleteColumn",value:function(e){var t=this.columnManager.findColumn(e);return this.initGuard(),t?t.delete():(console.warn("Column Delete Error - No matching column found:",e),Promise.reject())}},{key:"updateColumnDefinition",value:function(e,t){var n=this.columnManager.findColumn(e);return this.initGuard(),n?n.updateDefinition(t):(console.warn("Column Update Error - No matching column found:",e),Promise.reject())}},{key:"moveColumn",value:function(e,t,n){var o=this.columnManager.findColumn(e),a=this.columnManager.findColumn(t);this.initGuard(),o?a?this.columnManager.moveColumn(o,a,n):console.warn("Move Error - No matching column found:",a):console.warn("Move Error - No matching column found:",e)}},{key:"scrollToColumn",value:function(e,t,n){var o=this;return new Promise(function(a,s){var r=o.columnManager.findColumn(e);return r?o.columnManager.scrollToColumn(r,t,n):(console.warn("Scroll Error - No matching column found:",e),Promise.reject("Scroll Error - No matching column found"))})}},{key:"redraw",value:function(e){this.initGuard(),this.columnManager.redraw(e),this.rowManager.redraw(e)}},{key:"setHeight",value:function(e){this.options.height=isNaN(e)?e:e+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw()}},{key:"on",value:function(e,t){this.externalEvents.subscribe(e,t)}},{key:"off",value:function(e,t){this.externalEvents.unsubscribe(e,t)}},{key:"dispatchEvent",value:function(){var e;Array.from(arguments).shift(),(e=this.externalEvents).dispatch.apply(e,arguments)}},{key:"alert",value:function(e,t){this.initGuard(),this.alertManager.alert(e,t)}},{key:"clearAlert",value:function(){this.initGuard(),this.alertManager.clear()}},{key:"modExists",value:function(e,t){return!!this.modules[e]||(t&&console.error("Tabulator Module Not Installed: "+e),!1)}},{key:"module",value:function(e){var t=this.modules[e];return t||console.error("Tabulator module not installed: "+e),t}}]),n}();G.defaultOptions={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,debugInitialization:!0,height:!1,minHeight:!1,maxHeight:!1,columnHeaderVertAlign:"top",popupContainer:!1,columns:[],columnDefaults:{},data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,rowHeight:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataLoaderErrorTimeout:3e3,dataSendParams:{},dataReceiveParams:{}},new N(G);var j=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).allowedTypes=["","data","download","clipboard","print","htmlOutput"],n.registerColumnOption("accessor"),n.registerColumnOption("accessorParams"),n.registerColumnOption("accessorData"),n.registerColumnOption("accessorDataParams"),n.registerColumnOption("accessorDownload"),n.registerColumnOption("accessorDownloadParams"),n.registerColumnOption("accessorClipboard"),n.registerColumnOption("accessorClipboardParams"),n.registerColumnOption("accessorPrint"),n.registerColumnOption("accessorPrintParams"),n.registerColumnOption("accessorHtmlOutput"),n.registerColumnOption("accessorHtmlOutputParams"),n}return o(r,[{key:"initialize",value:function(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}},{key:"initializeColumn",value:function(e){var t=this,n=!1,o={};this.allowedTypes.forEach(function(a){var s,r="accessor"+(a.charAt(0).toUpperCase()+a.slice(1));e.definition[r]&&(s=t.lookupAccessor(e.definition[r]))&&(n=!0,o[r]={accessor:s,params:e.definition[r+"Params"]||{}})}),n&&(e.modules.accessor=o)}},{key:"lookupAccessor",value:function(t){var n=!1;switch(e(t)){case"string":r.accessors[t]?n=r.accessors[t]:console.warn("Accessor Error - No such accessor found, ignoring: ",t);break;case"function":n=t}return n}},{key:"transformRow",value:function(e,t){var n="accessor"+(t.charAt(0).toUpperCase()+t.slice(1)),o=e.getComponent(),a=v.deepClone(e.data||{});return this.table.columnManager.traverse(function(e){var s,r,l,u;e.modules.accessor&&(r=e.modules.accessor[n]||e.modules.accessor.accessor||!1)&&"undefined"!=(s=e.getFieldValue(a))&&(u=e.getComponent(),l="function"==typeof r.params?r.params(s,a,t,u,o):r.params,e.setFieldValue(a,r.accessor(s,a,t,l,u,o)))}),a}}]),r}();function U(t,n,o){var a,s,r;return t&&o&&Object.keys(o).length&&(n.method&&"get"!=n.method.toLowerCase()||(n.method="get",t+=(t.includes("?")?"&":"?")+(s=function t(n,o){var a=[];if(o=o||"",Array.isArray(n))n.forEach(function(e,n){a=a.concat(t(e,o?o+"["+n+"]":n))});else if("object"===e(n))for(var s in n)a=a.concat(t(n[s],o?o+"["+s+"]":s));else a.push({key:o,value:n});return a}(a=o),r=[],s.forEach(function(e){r.push(encodeURIComponent(e.key)+"="+encodeURIComponent(e.value))}),r.join("&")))),t}j.moduleName="accessor",j.accessors={};var q=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).config={},o.url="",o.urlGenerator=!1,o.params=!1,o.loaderPromise=!1,o.registerTableOption("ajaxURL",!1),o.registerTableOption("ajaxURLGenerator",!1),o.registerTableOption("ajaxParams",{}),o.registerTableOption("ajaxConfig","get"),o.registerTableOption("ajaxContentType","form"),o.registerTableOption("ajaxRequestFunc",!1),o.registerTableOption("ajaxRequesting",function(){}),o.registerTableOption("ajaxResponse",!1),o.contentTypeFormatters=s.contentTypeFormatters,o}return o(s,[{key:"initialize",value:function(){this.loaderPromise=this.table.options.ajaxRequestFunc||s.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||s.defaultURLGenerator,this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.setDefaultConfig(this.table.options.ajaxConfig),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-params",this.requestParams.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}},{key:"requestParams",value:function(e,t,n,o){var a=this.table.options.ajaxParams;return a&&("function"==typeof a&&(a=a.call(this.table)),o=Object.assign(o,a)),o}},{key:"requestDataCheck",value:function(e,t,n,o){return!((e||!this.url)&&"string"!=typeof e)}},{key:"requestData",value:function(e,t,n,o,a){var s;return!a&&this.requestDataCheck(e)?(e&&this.setUrl(e),s=this.generateConfig(n),this.sendRequest(this.url,t,s)):a}},{key:"setDefaultConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=Object.assign({},s.defaultConfig),"string"==typeof e?this.config.method=e:Object.assign(this.config,e)}},{key:"generateConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.config);return"string"==typeof e?t.method=e:Object.assign(t,e),t}},{key:"setUrl",value:function(e){this.url=e}},{key:"getUrl",value:function(){return this.url}},{key:"sendRequest",value:function(e,t,n){var o=this;return!1!==this.table.options.ajaxRequesting.call(this.table,e,t)?this.loaderPromise(e,n,t).then(function(n){return o.table.options.ajaxResponse&&(n=o.table.options.ajaxResponse.call(o.table,e,t,n)),n}):Promise.reject()}}]),s}();q.moduleName="ajax",q.defaultConfig={method:"GET"},q.defaultURLGenerator=U,q.defaultLoaderPromise=function(t,n,o){var a,s=this;return new Promise(function(r,l){if(t=s.urlGenerator.call(s.table,t,n,o),"GET"!=n.method.toUpperCase()){if(a="object"===e(s.table.options.ajaxContentType)?s.table.options.ajaxContentType:s.contentTypeFormatters[s.table.options.ajaxContentType]){for(var u in a.headers)n.headers||(n.headers={}),void 0===n.headers[u]&&(n.headers[u]=a.headers[u]);n.body=a.body.call(s,t,n,o)}else console.warn("Ajax Error - Invalid ajaxContentType value:",s.table.options.ajaxContentType)}t?(void 0===n.headers&&(n.headers={}),void 0===n.headers.Accept&&(n.headers.Accept="application/json"),void 0===n.headers["X-Requested-With"]&&(n.headers["X-Requested-With"]="XMLHttpRequest"),void 0===n.mode&&(n.mode="cors"),"cors"==n.mode?(void 0===n.headers.Origin&&(n.headers.Origin=window.location.origin),void 0===n.credentials&&(n.credentials="same-origin")):void 0===n.credentials&&(n.credentials="include"),fetch(t,n).then(function(e){e.ok?e.json().then(function(e){r(e)}).catch(function(e){l(e),console.warn("Ajax Load Error - Invalid JSON returned",e)}):(console.error("Ajax Load Error - Connection Error: "+e.status,e.statusText),l(e))}).catch(function(e){console.error("Ajax Load Error - Connection Error: ",e),l(e)})):(console.warn("Ajax Load Error - No URL Set"),r([]))})},q.contentTypeFormatters={json:{headers:{"Content-Type":"application/json"},body:function(e,t,n){return JSON.stringify(n)}},form:{headers:{},body:function(t,n,o){var a=function t(n,o){var a=[];if(o=o||"",Array.isArray(n))n.forEach(function(e,n){a=a.concat(t(e,o?o+"["+n+"]":n))});else if("object"===e(n))for(var s in n)a=a.concat(t(n[s],o?o+"["+s+"]":s));else a.push({key:o,value:n});return a}(o),s=new FormData;return a.forEach(function(e){s.append(e.key,e.value)}),s}}};var X=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).mode=!0,n.pasteParser=function(){},n.pasteAction=function(){},n.customSelection=!1,n.rowRange=!1,n.blocked=!0,n.registerTableOption("clipboard",!1),n.registerTableOption("clipboardCopyStyled",!0),n.registerTableOption("clipboardCopyConfig",!1),n.registerTableOption("clipboardCopyFormatter",!1),n.registerTableOption("clipboardCopyRowRange","active"),n.registerTableOption("clipboardPasteParser","table"),n.registerTableOption("clipboardPasteAction","insert"),n.registerColumnOption("clipboard"),n.registerColumnOption("titleClipboard"),n}return o(r,[{key:"initialize",value:function(){var e=this;this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,!0!==this.mode&&"copy"!==this.mode||this.table.element.addEventListener("copy",function(t){var n,o;if(!e.blocked){if(t.preventDefault(),e.customSelection)n=e.customSelection,e.table.options.clipboardCopyFormatter&&(n=e.table.options.clipboardCopyFormatter("plain",n));else{var a=e.table.modules.export.generateExportList(e.table.options.clipboardCopyConfig,e.table.options.clipboardCopyStyled,e.rowRange,"clipboard");n=(o=e.table.modules.export.genereateHTMLTable(a))?e.generatePlainContent(a):"",e.table.options.clipboardCopyFormatter&&(n=e.table.options.clipboardCopyFormatter("plain",n),o=e.table.options.clipboardCopyFormatter("html",o))}window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",n):t.clipboardData&&t.clipboardData.setData?(t.clipboardData.setData("text/plain",n),o&&t.clipboardData.setData("text/html",o)):t.originalEvent&&t.originalEvent.clipboardData.setData&&(t.originalEvent.clipboardData.setData("text/plain",n),o&&t.originalEvent.clipboardData.setData("text/html",o)),e.dispatchExternal("clipboardCopied",n,o),e.reset()}}),!0!==this.mode&&"paste"!==this.mode||this.table.element.addEventListener("paste",function(t){e.paste(t)}),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}},{key:"reset",value:function(){this.blocked=!0,this.customSelection=!1}},{key:"generatePlainContent",value:function(t){var n=[];return t.forEach(function(t){var o=[];t.columns.forEach(function(n){var a="";if(n){if("group"===t.type&&(n.value=n.component.getKey()),null===n.value)a="";else switch(e(n.value)){case"object":a=JSON.stringify(n.value);break;case"undefined":a="";break;default:a=n.value}}o.push(a)}),n.push(o.join("	"))}),n.join("\n")}},{key:"copy",value:function(e,t){var n,o;this.blocked=!1,this.customSelection=!1,!0!==this.mode&&"copy"!==this.mode||(this.rowRange=e||this.table.options.clipboardCopyRowRange,void 0!==window.getSelection&&void 0!==document.createRange?((e=document.createRange()).selectNodeContents(this.table.element),(n=window.getSelection()).toString()&&t&&(this.customSelection=n.toString()),n.removeAllRanges(),n.addRange(e)):void 0!==document.selection&&void 0!==document.body.createTextRange&&((o=document.body.createTextRange()).moveToElementText(this.table.element),o.select()),document.execCommand("copy"),n&&n.removeAllRanges())}},{key:"setPasteAction",value:function(t){switch(e(t)){case"string":this.pasteAction=r.pasteActions[t],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",t);break;case"function":this.pasteAction=t}}},{key:"setPasteParser",value:function(t){switch(e(t)){case"string":this.pasteParser=r.pasteParsers[t],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",t);break;case"function":this.pasteParser=t}}},{key:"paste",value:function(e){var t,n,o;this.checkPaseOrigin(e)&&(t=this.getPasteData(e),(n=this.pasteParser.call(this,t))?(e.preventDefault(),this.table.modExists("mutator")&&(n=this.mutateData(n)),o=this.pasteAction.call(this,n),this.dispatchExternal("clipboardPasted",t,n,o)):this.dispatchExternal("clipboardPasteError",t))}},{key:"mutateData",value:function(e){var t=this,n=[];return Array.isArray(e)?e.forEach(function(e){n.push(t.table.modules.mutator.transformRow(e,"clipboard"))}):n=e,n}},{key:"checkPaseOrigin",value:function(e){var t=!0;return("DIV"!=e.target.tagName||this.table.modules.edit.currentCell)&&(t=!1),t}},{key:"getPasteData",value:function(e){var t;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?t=e.clipboardData.getData("text/plain"):e.originalEvent&&e.originalEvent.clipboardData.getData&&(t=e.originalEvent.clipboardData.getData("text/plain")),t}}]),r}();X.moduleName="clipboard",X.pasteActions={replace:function(e){return this.table.setData(e)},update:function(e){return this.table.updateOrAddData(e)},insert:function(e){return this.table.addData(e)}},X.pasteParsers={table:function(e){var t=[],n=!0,o=this.table.columnManager.columns,a=[],s=[];return(e=e.split("\n")).forEach(function(e){t.push(e.split("	"))}),!(!t.length||1===t.length&&t[0].length<2)&&(t[0].forEach(function(e){var t=o.find(function(t){return e&&t.definition.title&&e.trim()&&t.definition.title.trim()===e.trim()});t?a.push(t):n=!1}),n||(n=!0,a=[],t[0].forEach(function(e){var t=o.find(function(t){return e&&t.field&&e.trim()&&t.field.trim()===e.trim()});t?a.push(t):n=!1}),n||(a=this.table.columnManager.columnsByIndex)),n&&t.shift(),t.forEach(function(e){var t={};e.forEach(function(e,n){a[n]&&(t[a[n].field]=e)}),s.push(t)}),s)}};var K=function(){function e(n){return t(this,e),this._row=n,new Proxy(this,{get:function(e,t,n){return void 0!==e[t]?e[t]:e._row.table.componentFunctionBinder.handle("row",e._row,t)}})}return o(e,[{key:"getData",value:function(e){return this._row.getData(e)}},{key:"getElement",value:function(){return this._row.getElement()}},{key:"getTable",value:function(){return this._row.table}},{key:"getCells",value:function(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}},{key:"getCell",value:function(e){var t=this._row.getCell(e);return!!t&&t.getComponent()}},{key:"_getSelf",value:function(){return this._row}}]),e}(),Y=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).topCalcs=[],n.botCalcs=[],n.genColumn=!1,n.topElement=n.createElement(),n.botElement=n.createElement(),n.topRow=!1,n.botRow=!1,n.topInitialized=!1,n.botInitialized=!1,n.registerTableOption("columnCalcs",!0),n.registerColumnOption("topCalc"),n.registerColumnOption("topCalcParams"),n.registerColumnOption("topCalcFormatter"),n.registerColumnOption("topCalcFormatterParams"),n.registerColumnOption("bottomCalc"),n.registerColumnOption("bottomCalcParams"),n.registerColumnOption("bottomCalcFormatter"),n.registerColumnOption("bottomCalcFormatterParams"),n}return o(r,[{key:"createElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-calcs-holder"),e}},{key:"initialize",value:function(){this.genColumn=new g({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refreshed",this.recalcActiveRowsRefresh.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this))}},{key:"tableRedraw",value:function(e){this.recalc(this.table.rowManager.activeRows),e&&this.redraw()}},{key:"userRecalc",value:function(){this.recalc(this.table.rowManager.activeRows)}},{key:"visibleRows",value:function(e,t){return this.topRow&&t.unshift(this.topRow),this.botRow&&t.push(this.botRow),t}},{key:"rowsUpdated",value:function(e){this.table.options.groupBy?this.recalcRowGroup(this):this.recalcActiveRows()}},{key:"recalcActiveRowsRefresh",value:function(){this.table.options.groupBy&&this.table.options.dataTreeStartExpanded&&this.table.options.dataTree?this.recalcAll():this.recalcActiveRows()}},{key:"recalcActiveRows",value:function(){this.recalc(this.table.rowManager.activeRows)}},{key:"cellValueChanged",value:function(e){(e.column.definition.topCalc||e.column.definition.bottomCalc)&&(this.table.options.groupBy?("table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs||this.recalcActiveRows(),"table"!=this.table.options.columnCalcs&&this.recalcRowGroup(e.row)):this.recalcActiveRows())}},{key:"initializeColumnCheck",value:function(e){(e.definition.topCalc||e.definition.bottomCalc)&&this.initializeColumn(e)}},{key:"initializeColumn",value:function(t){var n=t.definition,o={topCalcParams:n.topCalcParams||{},botCalcParams:n.bottomCalcParams||{}};if(n.topCalc){switch(e(n.topCalc)){case"string":r.calculations[n.topCalc]?o.topCalc=r.calculations[n.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",n.topCalc);break;case"function":o.topCalc=n.topCalc}o.topCalc&&(t.modules.columnCalcs=o,this.topCalcs.push(t),"group"!=this.table.options.columnCalcs&&this.initializeTopRow())}if(n.bottomCalc){switch(e(n.bottomCalc)){case"string":r.calculations[n.bottomCalc]?o.botCalc=r.calculations[n.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",n.bottomCalc);break;case"function":o.botCalc=n.bottomCalc}o.botCalc&&(t.modules.columnCalcs=o,this.botCalcs.push(t),"group"!=this.table.options.columnCalcs&&this.initializeBottomRow())}}},{key:"registerColumnField",value:function(){}},{key:"removeCalcs",value:function(){var e=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),e=!0),this.botInitialized&&(this.botInitialized=!1,this.footerRemove(this.botElement),e=!0),e&&this.table.rowManager.adjustTableSize()}},{key:"initializeTopRow",value:function(){this.topInitialized||(this.table.columnManager.getElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}},{key:"initializeBottomRow",value:function(){this.botInitialized||(this.footerPrepend(this.botElement),this.botInitialized=!0)}},{key:"scrollHorizontal",value:function(e){this.botInitialized&&this.botRow&&(this.botRow.getElement().style.marginLeft=-e+"px")}},{key:"recalc",value:function(e){var t;if(this.topInitialized||this.botInitialized){if(this.rowsToData(e),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),t=this.generateRow("top",this.rowsToData(e)),this.topRow=t;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(t.getElement()),t.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),t=this.generateRow("bottom",this.rowsToData(e)),this.botRow=t;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(t.getElement()),t.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}},{key:"recalcRowGroup",value:function(e){this.recalcGroup(this.table.modules.groupRows.getRowGroup(e))}},{key:"recalcAll",value:function(){var e=this;(this.topCalcs.length||this.botCalcs.length)&&("group"!==this.table.options.columnCalcs&&this.recalcActiveRows(),this.table.options.groupBy&&"table"!==this.table.options.columnCalcs&&this.table.modules.groupRows.getChildGroups().forEach(function(t){e.recalcGroup(t)}))}},{key:"recalcGroup",value:function(e){var t,n;e&&e.calcs&&(e.calcs.bottom&&(t=this.rowsToData(e.rows),n=this.generateRowData("bottom",t),e.calcs.bottom.updateData(n),e.calcs.bottom.reinitialize()),e.calcs.top&&(t=this.rowsToData(e.rows),n=this.generateRowData("top",t),e.calcs.top.updateData(n),e.calcs.top.reinitialize()))}},{key:"generateTopRow",value:function(e){return this.generateRow("top",this.rowsToData(e))}},{key:"generateBottomRow",value:function(e){return this.generateRow("bottom",this.rowsToData(e))}},{key:"rowsToData",value:function(e){var t=this,n=[];return e.forEach(function(e){if(n.push(e.getData()),t.table.options.dataTree&&t.table.options.dataTreeChildColumnCalcs&&e.modules.dataTree&&e.modules.dataTree.open){var o=t.rowsToData(t.table.modules.dataTree.getFilteredTreeChildren(e));n=n.concat(o)}}),n}},{key:"generateRow",value:function(e,t){var n,o=this,a=this.generateRowData(e,t);return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),n=new $(a,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),n.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+e),n.component=!1,n.getComponent=function(){return n.component||(n.component=new K(n)),n.component},n.generateCells=function(){var t=[];o.table.columnManager.columnsByIndex.forEach(function(a){o.genColumn.setField(a.getField()),o.genColumn.hozAlign=a.hozAlign,a.definition[e+"CalcFormatter"]&&o.table.modExists("format")?o.genColumn.modules.format={formatter:o.table.modules.format.getFormatter(a.definition[e+"CalcFormatter"]),params:a.definition[e+"CalcFormatterParams"]||{}}:o.genColumn.modules.format={formatter:o.table.modules.format.getFormatter("plaintext"),params:{}},o.genColumn.definition.cssClass=a.definition.cssClass;var s=new f(o.genColumn,n);s.getElement(),s.column=a,s.setWidth(),a.cells.push(s),t.push(s),a.visible||s.hide()}),n.cells=t},n}},{key:"generateRowData",value:function(e,t){var n,o,a={},s="top"==e?this.topCalcs:this.botCalcs,r="top"==e?"topCalc":"botCalc";return s.forEach(function(e){var s=[];e.modules.columnCalcs&&e.modules.columnCalcs[r]&&(t.forEach(function(t){s.push(e.getFieldValue(t))}),o=r+"Params",n="function"==typeof e.modules.columnCalcs[o]?e.modules.columnCalcs[o](s,t):e.modules.columnCalcs[o],e.setFieldValue(a,e.modules.columnCalcs[r](s,t,n)))}),a}},{key:"hasTopCalcs",value:function(){return!!this.topCalcs.length}},{key:"hasBottomCalcs",value:function(){return!!this.botCalcs.length}},{key:"redraw",value:function(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}},{key:"getResults",value:function(){var e=this,t={};return this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.groupRows.getGroups(!0).forEach(function(n){t[n.getKey()]=e.getGroupResults(n)}):t={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},t}},{key:"getGroupResults",value:function(e){var t=this,n=e._getSelf(),o=e.getSubGroups(),a={};return o.forEach(function(e){a[e.getKey()]=t.getGroupResults(e)}),{top:n.calcs.top?n.calcs.top.getData():{},bottom:n.calcs.bottom?n.calcs.bottom.getData():{},groups:a}}}]),r}();Y.moduleName="columnCalcs",Y.calculations={avg:function(e,t,n){var o=0,a=void 0!==n.precision?n.precision:2;return e.length&&(o=e.reduce(function(e,t){return Number(e)+Number(t)}),o/=e.length,o=!1!==a?o.toFixed(a):o),parseFloat(o).toString()},max:function(e,t,n){var o=null,a=void 0!==n.precision&&n.precision;return e.forEach(function(e){((e=Number(e))>o||null===o)&&(o=e)}),null!==o?!1!==a?o.toFixed(a):o:""},min:function(e,t,n){var o=null,a=void 0!==n.precision&&n.precision;return e.forEach(function(e){((e=Number(e))<o||null===o)&&(o=e)}),null!==o?!1!==a?o.toFixed(a):o:""},sum:function(e,t,n){var o=0,a=void 0!==n.precision&&n.precision;return e.length&&e.forEach(function(e){o+=isNaN(e=Number(e))?0:Number(e)}),!1!==a?o.toFixed(a):o},concat:function(e,t,n){var o=0;return e.length&&(o=e.reduce(function(e,t){return String(e)+String(t)})),o},count:function(e,t,n){var o=0;return e.length&&e.forEach(function(e){e&&o++}),o}};var J=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).indent=10,n.field="",n.collapseEl=null,n.expandEl=null,n.branchEl=null,n.elementField=!1,n.startOpen=function(){},n.displayIndex=0,n.registerTableOption("dataTree",!1),n.registerTableOption("dataTreeFilter",!0),n.registerTableOption("dataTreeSort",!0),n.registerTableOption("dataTreeElementColumn",!1),n.registerTableOption("dataTreeBranchElement",!0),n.registerTableOption("dataTreeChildIndent",9),n.registerTableOption("dataTreeChildField","_children"),n.registerTableOption("dataTreeCollapseElement",!1),n.registerTableOption("dataTreeExpandElement",!1),n.registerTableOption("dataTreeStartExpanded",!1),n.registerTableOption("dataTreeChildColumnCalcs",!1),n.registerTableOption("dataTreeSelectPropagate",!1),n.registerComponentFunction("row","treeCollapse",n.collapseRow.bind(l(n))),n.registerComponentFunction("row","treeExpand",n.expandRow.bind(l(n))),n.registerComponentFunction("row","treeToggle",n.toggleRow.bind(l(n))),n.registerComponentFunction("row","getTreeParent",n.getTreeParent.bind(l(n))),n.registerComponentFunction("row","getTreeChildren",n.getRowChildren.bind(l(n))),n.registerComponentFunction("row","addTreeChild",n.addTreeChildRow.bind(l(n))),n.registerComponentFunction("row","isTreeExpanded",n.isRowExpanded.bind(l(n))),n}return o(r,[{key:"initialize",value:function(){if(this.table.options.dataTree){var t=null,n=this.table.options;switch(this.field=n.dataTreeChildField,this.indent=n.dataTreeChildIndent,n.dataTreeBranchElement&&(!0===n.dataTreeBranchElement?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):"string"==typeof n.dataTreeBranchElement?((t=document.createElement("div")).innerHTML=n.dataTreeBranchElement,this.branchEl=t.firstChild):this.branchEl=n.dataTreeBranchElement),n.dataTreeCollapseElement?"string"==typeof n.dataTreeCollapseElement?((t=document.createElement("div")).innerHTML=n.dataTreeCollapseElement,this.collapseEl=t.firstChild):this.collapseEl=n.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),n.dataTreeExpandElement?"string"==typeof n.dataTreeExpandElement?((t=document.createElement("div")).innerHTML=n.dataTreeExpandElement,this.expandEl=t.firstChild):this.expandEl=n.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),e(n.dataTreeStartExpanded)){case"boolean":this.startOpen=function(e,t){return n.dataTreeStartExpanded};break;case"function":this.startOpen=n.dataTreeStartExpanded;break;default:this.startOpen=function(e,t){return n.dataTreeStartExpanded[t]}}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("cell-value-updated",this.cellValueChanged.bind(this)),this.subscribe("edit-cancelled",this.cellValueChanged.bind(this)),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.subscribe("table-built",this.initializeElementField.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}},{key:"initializeElementField",value:function(){var e=this.table.columnManager.getFirstVisibleColumn();this.elementField=this.table.options.dataTreeElementColumn||!!e&&e.field}},{key:"getRowChildren",value:function(e){return this.getTreeChildren(e,!0)}},{key:"columnMoving",value:function(){var e=this,t=[];return this.table.rowManager.rows.forEach(function(n){t=t.concat(e.getTreeChildren(n,!1,!0))}),t}},{key:"rowDataChanged",value:function(e,t,n){this.redrawNeeded(n)&&(this.initializeRow(e),t&&(this.layoutRow(e),this.refreshData(!0)))}},{key:"cellValueChanged",value:function(e){e.column.getField()===this.elementField&&this.layoutRow(e.row)}},{key:"initializeRow",value:function(t){var n=t.getData()[this.field],o=Array.isArray(n),a=o||!o&&"object"===e(n)&&null!==n;!a&&t.modules.dataTree&&t.modules.dataTree.branchEl&&t.modules.dataTree.branchEl.parentNode.removeChild(t.modules.dataTree.branchEl),!a&&t.modules.dataTree&&t.modules.dataTree.controlEl&&t.modules.dataTree.controlEl.parentNode.removeChild(t.modules.dataTree.controlEl),t.modules.dataTree={index:t.modules.dataTree?t.modules.dataTree.index:0,open:!!a&&(t.modules.dataTree?t.modules.dataTree.open:this.startOpen(t.getComponent(),0)),controlEl:!(!t.modules.dataTree||!a)&&t.modules.dataTree.controlEl,branchEl:!(!t.modules.dataTree||!a)&&t.modules.dataTree.branchEl,parent:!!t.modules.dataTree&&t.modules.dataTree.parent,children:a}}},{key:"reinitializeRowChildren",value:function(e){this.getTreeChildren(e,!1,!0).forEach(function(e){e.reinitialize(!0)})}},{key:"layoutRow",value:function(e){var t=(this.elementField?e.getCell(this.elementField):e.getCells()[0]).getElement(),n=e.modules.dataTree;n.branchEl&&(n.branchEl.parentNode&&n.branchEl.parentNode.removeChild(n.branchEl),n.branchEl=!1),n.controlEl&&(n.controlEl.parentNode&&n.controlEl.parentNode.removeChild(n.controlEl),n.controlEl=!1),this.generateControlElement(e,t),e.getElement().classList.add("tabulator-tree-level-"+n.index),n.index&&(this.branchEl?(n.branchEl=this.branchEl.cloneNode(!0),t.insertBefore(n.branchEl,t.firstChild),this.table.rtl?n.branchEl.style.marginRight=(n.branchEl.offsetWidth+n.branchEl.style.marginLeft)*(n.index-1)+n.index*this.indent+"px":n.branchEl.style.marginLeft=(n.branchEl.offsetWidth+n.branchEl.style.marginRight)*(n.index-1)+n.index*this.indent+"px"):this.table.rtl?t.style.paddingRight=parseInt(window.getComputedStyle(t,null).getPropertyValue("padding-right"))+n.index*this.indent+"px":t.style.paddingLeft=parseInt(window.getComputedStyle(t,null).getPropertyValue("padding-left"))+n.index*this.indent+"px")}},{key:"generateControlElement",value:function(e,t){var n=this,o=e.modules.dataTree,a=(t=t||e.getCells()[0].getElement(),o.controlEl);!1!==o.children&&(o.open?(o.controlEl=this.collapseEl.cloneNode(!0),o.controlEl.addEventListener("click",function(t){t.stopPropagation(),n.collapseRow(e)})):(o.controlEl=this.expandEl.cloneNode(!0),o.controlEl.addEventListener("click",function(t){t.stopPropagation(),n.expandRow(e)})),o.controlEl.addEventListener("mousedown",function(e){e.stopPropagation()}),a&&a.parentNode===t?a.parentNode.replaceChild(o.controlEl,a):t.insertBefore(o.controlEl,t.firstChild))}},{key:"setDisplayIndex",value:function(e){this.displayIndex=e}},{key:"getDisplayIndex",value:function(){return this.displayIndex}},{key:"getRows",value:function(e){var t=this,n=[];return e.forEach(function(e,o){var a;n.push(e),e instanceof $&&(e.create(),(a=e.modules.dataTree.children).index||!1===a.children||t.getChildren(e).forEach(function(e){e.create(),n.push(e)}))}),n}},{key:"getChildren",value:function(e,t){var n=this,o=e.modules.dataTree,a=[],s=[];return!1!==o.children&&(o.open||t)&&(Array.isArray(o.children)||(o.children=this.generateChildren(e)),a=this.table.modExists("filter")&&this.table.options.dataTreeFilter?this.table.modules.filter.filter(o.children):o.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(a),a.forEach(function(e){s.push(e),n.getChildren(e).forEach(function(e){s.push(e)})})),s}},{key:"generateChildren",value:function(e){var t=this,n=[],o=e.getData()[this.field];return Array.isArray(o)||(o=[o]),o.forEach(function(o){var a=new $(o||{},t.table.rowManager);a.create(),a.modules.dataTree.index=e.modules.dataTree.index+1,a.modules.dataTree.parent=e,a.modules.dataTree.children&&(a.modules.dataTree.open=t.startOpen(a.getComponent(),a.modules.dataTree.index)),n.push(a)}),n}},{key:"expandRow",value:function(e,t){var n=e.modules.dataTree;!1!==n.children&&(n.open=!0,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",e.getComponent(),e.modules.dataTree.index))}},{key:"collapseRow",value:function(e){var t=e.modules.dataTree;!1!==t.children&&(t.open=!1,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",e.getComponent(),e.modules.dataTree.index))}},{key:"toggleRow",value:function(e){var t=e.modules.dataTree;!1!==t.children&&(t.open?this.collapseRow(e):this.expandRow(e))}},{key:"isRowExpanded",value:function(e){return e.modules.dataTree.open}},{key:"getTreeParent",value:function(e){return!!e.modules.dataTree.parent&&e.modules.dataTree.parent.getComponent()}},{key:"getFilteredTreeChildren",value:function(e){var t=e.modules.dataTree,n=[];return t.children&&(Array.isArray(t.children)||(t.children=this.generateChildren(e)),(this.table.modExists("filter")&&this.table.options.dataTreeFilter?this.table.modules.filter.filter(t.children):t.children).forEach(function(e){e instanceof $&&n.push(e)})),n}},{key:"rowDelete",value:function(e){var t,n=e.modules.dataTree.parent;n&&(!1!==(t=this.findChildIndex(e,n))&&n.data[this.field].splice(t,1),n.data[this.field].length||delete n.data[this.field],this.initializeRow(n),this.layoutRow(n)),this.refreshData(!0)}},{key:"addTreeChildRow",value:function(e,t,n,o){var a=!1;"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e.data[this.field])||(e.data[this.field]=[],e.modules.dataTree.open=this.startOpen(e.getComponent(),e.modules.dataTree.index)),void 0!==o&&!1!==(a=this.findChildIndex(o,e))&&e.data[this.field].splice(n?a:a+1,0,t),!1===a&&(n?e.data[this.field].unshift(t):e.data[this.field].push(t)),this.initializeRow(e),this.layoutRow(e),this.refreshData(!0)}},{key:"findChildIndex",value:function(t,n){var o=this,a=!1;return"object"==e(t)?t instanceof $?a=t.data:t instanceof RowComponent?a=t._getSelf().data:"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&n.modules.dataTree&&(a=n.modules.dataTree.children.find(function(e){return e instanceof $&&e.element===t}))&&(a=a.data):a=null!=t&&n.data[this.field].find(function(e){return e.data[o.table.options.index]==t}),a&&(Array.isArray(n.data[this.field])&&(a=n.data[this.field].indexOf(a)),-1==a&&(a=!1)),a}},{key:"getTreeChildren",value:function(e,t,n){var o=this,a=e.modules.dataTree,s=[];return a.children&&(Array.isArray(a.children)||(a.children=this.generateChildren(e)),a.children.forEach(function(e){e instanceof $&&(s.push(t?e.getComponent():e),n&&(s=s.concat(o.getTreeChildren(e,t,n))))})),s}},{key:"getChildField",value:function(){return this.field}},{key:"redrawNeeded",value:function(e){return!!this.field&&void 0!==e[this.field]||!!this.elementField&&void 0!==e[this.elementField]}}]),r}();J.moduleName="dataTree";var Q=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).registerTableOption("downloadReady",function(e,t){return t}),o.registerTableOption("downloadConfig",{}),o.registerTableOption("downloadRowRange","active"),o.registerColumnOption("download"),o.registerColumnOption("titleDownload"),o}return o(s,[{key:"initialize",value:function(){this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}},{key:"downloadToTab",value:function(e,t,n,o){this.download(e,t,n,o,!0)}},{key:"download",value:function(e,t,n,o,a){var r=!1;if("function"==typeof e?r=e:s.downloaders[e]?r=s.downloaders[e]:console.warn("Download Error - No such download type found: ",e),r){var l=this.generateExportList(o);r.call(this.table,l,n||{},(function(n,o){a?!0===a?this.triggerDownload(n,o,e,t,!0):a(n):this.triggerDownload(n,o,e,t)}).bind(this))}}},{key:"generateExportList",value:function(e){var t=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,e||this.table.options.downloadRowRange,"download"),n=this.table.options.groupHeaderDownload;return n&&!Array.isArray(n)&&(n=[n]),t.forEach(function(e){var t;"group"===e.type&&(t=e.columns[0],n&&n[e.indent]&&(t.value=n[e.indent](t.value,e.component._group.getRowCount(),e.component._group.getData(),e.component)))}),t}},{key:"triggerDownload",value:function(e,t,n,o,a){var s=document.createElement("a"),r=new Blob([e],{type:t});o=o||"Tabulator."+("function"==typeof n?"txt":n),(r=this.table.options.downloadReady(e,r))&&(a?window.open(window.URL.createObjectURL(r)):navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(r,o):(s.setAttribute("href",window.URL.createObjectURL(r)),s.setAttribute("download",o),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)),this.dispatchExternal("downloadComplete"))}},{key:"commsReceived",value:function(e,t,n){"intercept"===t&&this.download(n.type,"",n.options,n.active,n.intercept)}}]),s}();function Z(e,t){var n=t.mask,o=void 0!==t.maskLetterChar?t.maskLetterChar:"A",a=void 0!==t.maskNumberChar?t.maskNumberChar:"9",s=void 0!==t.maskWildcardChar?t.maskWildcardChar:"*";function r(t){var l=n[t];void 0!==l&&l!==s&&l!==o&&l!==a&&(e.value=e.value+""+l,r(t+1))}e.addEventListener("keydown",function(t){var r=e.value.length,l=t.key;if(t.keyCode>46){if(r>=n.length)return t.preventDefault(),t.stopPropagation(),!1;switch(n[r]){case o:if(l.toUpperCase()==l.toLowerCase())return t.preventDefault(),t.stopPropagation(),!1;break;case a:if(isNaN(l))return t.preventDefault(),t.stopPropagation(),!1;break;case s:break;default:if(l!==n[r])return t.preventDefault(),t.stopPropagation(),!1}}}),e.addEventListener("keyup",function(n){n.keyCode>46&&t.maskAutoFill&&r(e.value.length)}),e.placeholder||(e.placeholder=n),t.maskAutoFill&&r(e.value.length)}Q.moduleName="download",Q.downloaders={csv:function(t,n,o){var a=n&&n.delimiter?n.delimiter:",",s=[],r=[];t.forEach(function(t){var n=[];switch(t.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":t.columns.forEach(function(e,t){e&&1===e.depth&&(r[t]=void 0===e.value||null===e.value?"":'"'+String(e.value).split('"').join('""')+'"')});break;case"row":t.columns.forEach(function(t){if(t){switch(e(t.value)){case"object":t.value=JSON.stringify(t.value);break;case"undefined":case"null":t.value=""}n.push('"'+String(t.value).split('"').join('""')+'"')}}),s.push(n.join(a))}}),r.length&&s.unshift(r.join(a)),s=s.join("\n"),n.bom&&(s="\uFEFF"+s),o(s,"text/csv")},json:function(e,t,n){var o=[];e.forEach(function(e){var t={};switch(e.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":e.columns.forEach(function(e){e&&(t[e.component.getTitleDownload()||e.component.getField()]=e.value)}),o.push(t)}}),n(o=JSON.stringify(o,null,"	"),"application/json")},jsonLines:function(e,t,n){var o=[];e.forEach(function(e){var t={};switch(e.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":e.columns.forEach(function(e){e&&(t[e.component.getTitleDownload()||e.component.getField()]=e.value)}),o.push(JSON.stringify(t))}}),n(o.join("\n"),"application/x-ndjson")},pdf:function(t,n,o){var a=[],s=[],r={},l=n.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},u=n.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},h=n.jsPDF||{},c=n&&n.title?n.title:"";function d(t,n){var o=[];return t.columns.forEach(function(t){var a;if(t){switch(e(t.value)){case"object":t.value=JSON.stringify(t.value);break;case"undefined":case"null":t.value=""}a={content:t.value,colSpan:t.width,rowSpan:t.height},n&&(a.styles=n),o.push(a)}}),o}h.orientation||(h.orientation=n.orientation||"landscape"),h.unit||(h.unit="pt"),t.forEach(function(e){switch(e.type){case"header":a.push(d(e));break;case"group":s.push(d(e,l));break;case"calc":s.push(d(e,u));break;case"row":s.push(d(e))}});var p=new jspdf.jsPDF(h);n&&n.autoTable&&(r="function"==typeof n.autoTable?n.autoTable(p)||{}:n.autoTable),c&&(r.didDrawPage=function(e){p.text(c,40,30)}),r.head=a,r.body=s,p.autoTable(r),n&&n.documentProcessing&&n.documentProcessing(p),o(p.output("arraybuffer"),"application/pdf")},xlsx:function(t,n,o){var a=n.sheetName||"Sheet1",s=XLSX.utils.book_new(),r=new c(this);function l(){var n=[],o=[],a={},s={s:{c:0,r:0},e:{c:t[0]?t[0].columns.reduce(function(e,t){return e+(t&&t.width?t.width:1)},0):0,r:t.length}};return t.forEach(function(t,a){var s=[];t.columns.forEach(function(t,n){t?(s.push(t.value instanceof Date||"object"!==e(t.value)?t.value:JSON.stringify(t.value)),(t.width>1||t.height>-1)&&(t.height>1||t.width>1)&&o.push({s:{r:a,c:n},e:{r:a+t.height-1,c:n+t.width-1}})):s.push("")}),n.push(s)}),XLSX.utils.sheet_add_aoa(a,n),a["!ref"]=XLSX.utils.encode_range(s),o.length&&(a["!merges"]=o),a}if(s.SheetNames=[],s.Sheets={},n.sheetOnly)o(l());else{if(n.sheets)for(var u in n.sheets)!0===n.sheets[u]?(s.SheetNames.push(u),s.Sheets[u]=l()):(s.SheetNames.push(u),r.commsSend(n.sheets[u],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:this.active,intercept:function(e){s.Sheets[u]=e}}));else s.SheetNames.push(a),s.Sheets[a]=l();n.documentProcessing&&(s=n.documentProcessing(s)),o(function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o!=e.length;++o)n[o]=255&e.charCodeAt(o);return t}(XLSX.write(s,{bookType:"xlsx",bookSST:!0,type:"binary"})),"application/octet-stream")}},html:function(e,t,n){this.modExists("export",!0)&&n(this.modules.export.genereateHTMLTable(e),"text/html")}};var ee=function(){function n(e,o,a,s,r,l){t(this,n),this.edit=e,this.table=e.table,this.cell=o,this.params=this._initializeParams(l),this.data=[],this.displayItems=[],this.currentItems=[],this.focusedItem=null,this.input=this._createInputElement(),this.listEl=this._createListElement(),this.initialValues=null,this.isFilter=!o._getSelf,this.filterTimeout=null,this.filtered=!1,this.typing=!1,this.values=[],this.popup=null,this.listIteration=0,this.blurable=!0,this.actions={success:s,cancel:r},this._deprecationCheck(),this._initializeValue(),a(this._onRendered.bind(this))}return o(n,[{key:"_deprecationCheck",value:function(){this.params.listItemFormatter&&console.warn("The listItemFormatter editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.sortValuesList&&console.warn("The sortValuesList editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.searchFunc&&console.warn("The searchFunc editor param has been deprecated, please see the latest editor documentation for updated options"),this.params.searchingPlaceholder&&console.warn("The searchingPlaceholder editor param has been deprecated, please see the latest editor documentation for updated options")}},{key:"_initializeValue",value:function(){var e=this.cell.getValue();void 0===e&&void 0!==this.params.defaultValue&&(e=this.params.defaultValue),this.initialValues=this.params.multiselect?e:[e],this.isFilter&&(this.input.value=this.initialValues.join(","),this.headerFilterInitialListGen())}},{key:"_onRendered",value:function(){var e=this.cell.getElement();function t(e){e.stopPropagation()}this.input.style.height="100%",this.input.focus({preventScroll:!0}),e.addEventListener("click",t),setTimeout(function(){e.removeEventListener("click",t)},1e3)}},{key:"_createListElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-edit-list"),e.addEventListener("mousedown",this._preventBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e}},{key:"_setListWidth",value:function(){var e=this.isFilter?this.input:this.cell.getElement();this.listEl.style.minWidth=e.offsetWidth+"px",this.params.maxWidth&&(!0===this.params.maxWidth?this.listEl.style.maxWidth=e.offsetWidth+"px":"number"==typeof this.params.maxWidth?this.listEl.style.maxWidth=this.params.maxWidth+"px":this.listEl.style.maxWidth=this.params.maxWidth)}},{key:"_createInputElement",value:function(){var t=this.params.elementAttributes,n=document.createElement("input");if(n.setAttribute("type",this.params.clearable?"search":"text"),n.style.padding="4px",n.style.width="100%",n.style.boxSizing="border-box",this.params.autocomplete||(n.style.cursor="default",n.style.caretColor="transparent"),t&&"object"==e(t))for(var o in t)"+"==o.charAt(0)?(o=o.slice(1),n.setAttribute(o,n.getAttribute(o)+t["+"+o])):n.setAttribute(o,t[o]);return this.params.mask&&Z(n,this.params),this._bindInputEvents(n),n}},{key:"_initializeParams",value:function(t){var n,o=["values","valuesURL","valuesLookup"];return(t=Object.assign({},t)).verticalNavigation=t.verticalNavigation||"editor",t.placeholderLoading=void 0===t.placeholderLoading?"Searching ...":t.placeholderLoading,t.placeholderEmpty=void 0===t.placeholderEmpty?"No Results Found":t.placeholderEmpty,t.filterDelay=void 0===t.filterDelay?300:t.filterDelay,t.emptyValue=Object.keys(t).includes("emptyValue")?t.emptyValue:"",(n=Object.keys(t).filter(function(e){return o.includes(e)}).length)?n>1&&console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor"):console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"),t.autocomplete?t.multiselect&&(t.multiselect=!1,console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")):(t.freetext&&(t.freetext=!1,console.warn("list editor config error - freetext option is only available when autocomplete is enabled")),t.filterFunc&&(t.filterFunc=!1,console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")),t.filterRemote&&(t.filterRemote=!1,console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")),t.mask&&(t.mask=!1,console.warn("list editor config error - mask option is only available when autocomplete is enabled")),t.allowEmpty&&(t.allowEmpty=!1,console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")),t.listOnEmpty&&(t.listOnEmpty=!1,console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))),t.filterRemote&&"function"!=typeof t.valuesLookup&&!e(t.valuesURL)&&(t.filterRemote=!1,console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")),t}},{key:"_bindInputEvents",value:function(e){e.addEventListener("focus",this._inputFocus.bind(this)),e.addEventListener("click",this._inputClick.bind(this)),e.addEventListener("blur",this._inputBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e.addEventListener("search",this._inputSearch.bind(this)),this.params.autocomplete&&e.addEventListener("keyup",this._inputKeyUp.bind(this))}},{key:"_inputFocus",value:function(e){this.rebuildOptionsList()}},{key:"_filter",value:function(){var e=this;this.params.filterRemote?(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(){e.rebuildOptionsList()},this.params.filterDelay)):this._filterList()}},{key:"_inputClick",value:function(e){e.stopPropagation()}},{key:"_inputBlur",value:function(e){this.blurable&&this.popup&&this.popup.hide()}},{key:"_inputSearch",value:function(){this._clearChoices()}},{key:"_inputKeyDown",value:function(e){switch(e.keyCode){case 38:this._keyUp(e);break;case 40:this._keyDown(e);break;case 37:case 39:this._keySide(e);break;case 13:this._keyEnter();break;case 27:this._keyEsc();break;case 36:case 35:this._keyHomeEnd(e);break;case 9:break;default:this._keySelectLetter(e)}}},{key:"_inputKeyUp",value:function(e){switch(e.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:this._keyAutoCompLetter(e)}}},{key:"_preventBlur",value:function(){this.blurable=!1,setTimeout(function(){this.blurable=!0},10)}},{key:"_keyUp",value:function(e){var t=this.displayItems.indexOf(this.focusedItem);("editor"==this.params.verticalNavigation||"hybrid"==this.params.verticalNavigation&&t)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t>0&&this._focusItem(this.displayItems[t-1]))}},{key:"_keyDown",value:function(e){var t=this.displayItems.indexOf(this.focusedItem);("editor"==this.params.verticalNavigation||"hybrid"==this.params.verticalNavigation&&t<this.displayItems.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t<this.displayItems.length-1&&(-1==t?this._focusItem(this.displayItems[0]):this._focusItem(this.displayItems[t+1])))}},{key:"_keySide",value:function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},{key:"_keyEnter",value:function(e){this.focusedItem?this._chooseItem(this.focusedItem):this._cancel()}},{key:"_keyEsc",value:function(e){this._cancel()}},{key:"_keyHomeEnd",value:function(e){this.params.autocomplete&&e.stopImmediatePropagation()}},{key:"_keySelectLetter",value:function(e){this.params.autocomplete||(e.preventDefault(),e.keyCode>=38&&e.keyCode<=90&&this._scrollToValue(e.keyCode))}},{key:"_keyAutoCompLetter",value:function(e){this._filter(),this.typing=!0}},{key:"_scrollToValue",value:function(e){var t=this;clearTimeout(this.filterTimeout);var n=String.fromCharCode(e).toLowerCase();this.filterTerm+=n.toLowerCase();var o=this.displayItems.find(function(e){return void 0!==e.label&&e.label.toLowerCase().startsWith(t.filterTerm)});o&&this._focusItem(o),this.filterTimeout=setTimeout(function(){t.filterTerm=""},800)}},{key:"_focusItem",value:function(e){this.focusedItem&&this.focusedItem.element&&this.focusedItem.element.classList.remove("focused"),this.focusedItem=e,e&&e.element&&(e.element.classList.add("focused"),e.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}},{key:"headerFilterInitialListGen",value:function(){this._generateOptions(!0)}},{key:"rebuildOptionsList",value:function(){this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch(function(e){Number.isInteger(e)||console.error("List generation error",e)})}},{key:"_filterList",value:function(){this._buildList(this._filterOptions()),this._showList()}},{key:"_generateOptions",value:function(e){var t=this,n=[],o=++this.listIteration;return this.filtered=!1,this.params.values?n=this.params.values:this.params.valuesURL?n=this._ajaxRequest(this.params.valuesURL,this.input.value):"function"==typeof this.params.valuesLookup?n=this.params.valuesLookup(cell,this.input.value):this.params.valuesLookup&&(n=this._uniqueColumnValues(this.params.valuesLookupField)),n instanceof Promise?(e||this._addPlaceholder(this.params.placeholderLoading),n.then().then(function(e){return t.listIteration===o?t._parseList(e):Promise.reject(o)})):Promise.resolve(this._parseList(n))}},{key:"_addPlaceholder",value:function(e){var t=document.createElement("div");"function"==typeof e&&(e=e(cell.getComponent(),this.listEl)),e&&(this._clearList(),e instanceof HTMLElement?t=e:(t.classList.add("tabulator-edit-list-placeholder"),t.innerHTML=e),this.listEl.appendChild(t),this._showList())}},{key:"_ajaxRequest",value:function(e,t){return e=U(e,{},this.params.filterRemote?{term:t}:{}),fetch(e).then(function(e){return e.ok?e.json().catch(function(e){return console.warn("List Ajax Load Error - Invalid JSON returned",e),Promise.reject(e)}):(console.error("List Ajax Load Error - Connection Error: "+e.status,e.statusText),Promise.reject(e))}).catch(function(e){return console.error("List Ajax Load Error - Connection Error: ",e),Promise.reject(e)})}},{key:"_uniqueColumnValues",value:function(e){var t,n={},o=this.table.getData(this.params.valuesLookup);return(t=e?this.table.columnManager.getColumnByField(e):this.cell.getColumn()._getSelf())?o.forEach(function(e){var o=t.getFieldValue(e);null!=o&&""!==o&&(n[o]=!0)}):(console.warn("unable to find matching column to create select lookup list:",e),n=[]),Object.keys(n)}},{key:"_parseList",value:function(t){var n=this,o=[];return Array.isArray(t)||(t=Object.entries(t).map(function(e){var t=_slicedToArray(e,2),n=t[0];return{label:t[1],value:n}})),t.forEach(function(t){"object"!==e(t)&&(t={label:t,value:t}),n._parseListItem(t,o,0)}),this.data=o,o}},{key:"_parseListItem",value:function(e,t,n){var o={};e.options?o=this._parseListGroup(e,n+1):(o={label:e.label,value:e.value,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,selected:!1,visible:!0,level:n,original:e},this.initialValues&&this.initialValues.indexOf(e.value)>-1&&this._chooseItem(o,!0)),t.push(o)}},{key:"_parseListGroup",value:function(e,t){var n=this,o={label:e.label,group:!0,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,visible:!0,level:t,options:[],original:e};return e.options.forEach(function(e){n._parseListItem(e,o.options,t)}),o}},{key:"_sortOptions",value:function(e){var t;return this.params.sort&&(t="function"==typeof this.params.sort?this.params.sort:this._defaultSortFunction.bind(this),this._sortGroup(t,e)),e}},{key:"_sortGroup",value:function(e,t){var n=this;t.sort(function(t,n){return e(t.label,n.label,t.value,n.value,t.original,n.original)}),t.forEach(function(t){t.group&&n._sortGroup(e,t.options)})}},{key:"_defaultSortFunction",value:function(e,t){var n,o,a,s,r,l=0,u=/(\d+)|(\D+)/g,h=/\d/,c=0;if("desc"===this.params.sort){var d=[t,e];e=d[0],t=d[1]}if(e||0===e){if(t||0===t){if(isFinite(e)&&isFinite(t))return e-t;if((n=String(e).toLowerCase())===(o=String(t).toLowerCase()))return 0;if(!h.test(n)||!h.test(o))return n>o?1:-1;for(n=n.match(u),o=o.match(u),r=n.length>o.length?o.length:n.length;l<r;)if((a=n[l])!==(s=o[l++]))return isFinite(a)&&isFinite(s)?("0"===a.charAt(0)&&(a="."+a),"0"===s.charAt(0)&&(s="."+s),a-s):a>s?1:-1;return n.length>o.length}c=1}else c=t||0===t?-1:0;return c}},{key:"_filterOptions",value:function(){var e=this,t=this.params.filterFunc||this._defaultFilterFunc,n=this.input.value;return n?(this.filtered=!0,this.data.forEach(function(o){e._filterItem(t,n,o)})):this.filtered=!1,this.data}},{key:"_filterItem",value:function(e,t,n){var o=this,a=!1;return n.group?(n.options.forEach(function(n){o._filterItem(e,t,n)&&(a=!0)}),n.visible=a):n.visible=e(t,n.label,n.value,n.original),n.visible}},{key:"_defaultFilterFunc",value:function(e,t,n,o){return e=String(e).toLowerCase(),(null!==t||void 0!==t)&&(String(t).toLowerCase().indexOf(e)>-1||String(n).toLowerCase(e).indexOf()>-1)}},{key:"_clearList",value:function(){for(;this.listEl.firstChild;)this.listEl.removeChild(this.listEl.firstChild);this.displayItems=[]}},{key:"_buildList",value:function(e){var t=this;this._clearList(),e.forEach(function(e){t._buildItem(e)}),this.displayItems.length||this._addPlaceholder(this.params.placeholderEmpty)}},{key:"_buildItem",value:function(t){var n,o=this,a=t.element;if(!this.filtered||t.visible){if(!a){if((a=document.createElement("div")).tabIndex=0,(n=this.params.itemFormatter?this.params.itemFormatter(t.label,t.value,t.original,a):t.label)instanceof HTMLElement?a.appendChild(n):a.innerHTML=n,t.group?a.classList.add("tabulator-edit-list-group"):a.classList.add("tabulator-edit-list-item"),a.classList.add("tabulator-edit-list-group-level-"+t.level),t.elementAttributes&&"object"==e(t.elementAttributes))for(var s in t.elementAttributes)"+"==s.charAt(0)?(s=s.slice(1),a.setAttribute(s,this.input.getAttribute(s)+t.elementAttributes["+"+s])):a.setAttribute(s,t.elementAttributes[s]);t.group?a.addEventListener("click",this._groupClick.bind(this,t)):a.addEventListener("click",this._itemClick.bind(this,t)),a.addEventListener("mousedown",this._preventBlur.bind(this)),t.element=a}this._styleItem(t),this.listEl.appendChild(a),t.group?t.options.forEach(function(e){o._buildItem(e)}):this.displayItems.push(t)}}},{key:"_showList",value:function(){var e=this.popup&&this.popup.isVisible();if(this.input.parentNode){if(this.params.autocomplete&&""===this.input.value&&!this.params.listOnEmpty&&this.popup)return void this.popup.hide(!0);this._setListWidth(),this.popup||(this.popup=this.edit.popup(this.listEl)),this.popup.show(this.cell.getElement(),"bottom"),e||this.popup.hideOnBlur(this._resolveValue.bind(this,!0))}}},{key:"_styleItem",value:function(e){e&&e.element&&(e.selected?e.element.classList.add("active"):e.element.classList.remove("active"))}},{key:"_itemClick",value:function(e,t){t.stopPropagation(),this._chooseItem(e)}},{key:"_groupClick",value:function(e,t){t.stopPropagation()}},{key:"_cancel",value:function(){this.popup.hide(!0),this.actions.cancel()}},{key:"_clearChoices",value:function(){var e=this;this.typing=!0,this.currentItems.forEach(function(t){t.selected=!1,e._styleItem(t)}),this.currentItems=[],this.focusedItem=null}},{key:"_chooseItem",value:function(e,t){var n;this.typing=!1,this.params.multiselect?((n=this.currentItems.indexOf(e))>-1?(this.currentItems.splice(n,1),e.selected=!1):(this.currentItems.push(e),e.selected=!0),this.input.value=this.currentItems.map(function(e){return e.label}).join(","),this._styleItem(e)):(this.currentItems=[e],e.selected=!0,this.input.value=e.label,this._styleItem(e),t||this._resolveValue()),this._focusItem(e)}},{key:"_resolveValue",value:function(e){var t,n;if(this.popup.hide(!0),this.params.multiselect)t=this.currentItems.map(function(e){return e.value});else if(e&&this.params.autocomplete&&this.typing){if(!(this.params.freetext||this.params.allowEmpty&&""===this.input.value))return void this.actions.cancel();t=this.input.value}else t=this.currentItems[0]?this.currentItems[0].value:null==(n=this.initialValues[0])||""===n?n:this.params.emptyValue;""===t&&(t=this.params.emptyValue),this.actions.success(t),this.isFilter&&(this.initialValues=t&&!Array.isArray[t]?[t]:t)}}]),n}(),et=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).currentCell=!1,n.mouseClick=!1,n.recursionBlock=!1,n.invalidEdit=!1,n.editedCells=[],n.editors=r.editors,n.registerColumnOption("editable"),n.registerColumnOption("editor"),n.registerColumnOption("editorParams"),n.registerColumnOption("cellEditing"),n.registerColumnOption("cellEdited"),n.registerColumnOption("cellEditCancelled"),n.registerTableFunction("getEditedCells",n.getEditedCells.bind(l(n))),n.registerTableFunction("clearCellEdited",n.clearCellEdited.bind(l(n))),n.registerTableFunction("navigatePrev",n.navigatePrev.bind(l(n))),n.registerTableFunction("navigateNext",n.navigateNext.bind(l(n))),n.registerTableFunction("navigateLeft",n.navigateLeft.bind(l(n))),n.registerTableFunction("navigateRight",n.navigateRight.bind(l(n))),n.registerTableFunction("navigateUp",n.navigateUp.bind(l(n))),n.registerTableFunction("navigateDown",n.navigateDown.bind(l(n))),n.registerComponentFunction("cell","isEdited",n.cellisEdited.bind(l(n))),n.registerComponentFunction("cell","clearEdited",n.clearEdited.bind(l(n))),n.registerComponentFunction("cell","edit",n.editCell.bind(l(n))),n.registerComponentFunction("cell","cancelEdit",n.cellCancelEdit.bind(l(n))),n.registerComponentFunction("cell","navigatePrev",n.navigatePrev.bind(l(n))),n.registerComponentFunction("cell","navigateNext",n.navigateNext.bind(l(n))),n.registerComponentFunction("cell","navigateLeft",n.navigateLeft.bind(l(n))),n.registerComponentFunction("cell","navigateRight",n.navigateRight.bind(l(n))),n.registerComponentFunction("cell","navigateUp",n.navigateUp.bind(l(n))),n.registerComponentFunction("cell","navigateDown",n.navigateDown.bind(l(n))),n}return o(r,[{key:"initialize",value:function(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("data-refreshing",this.cancelEdit.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this,void 0)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-left",this.navigateLeft.bind(this,void 0)),this.subscribe("keybinding-nav-right",this.navigateRight.bind(this,void 0)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this,void 0)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this,void 0))}},{key:"keybindingNavigateNext",value:function(e){var t=this.currentCell,n=this.options("tabEndNewRow");t&&(this.navigateNext(t,e)||n&&(t.getElement().firstChild.blur(),(n=!0===n?this.table.addRow({}):"function"==typeof n?this.table.addRow(n(t.row.getComponent())):this.table.addRow(Object.assign({},n))).then(function(){setTimeout(function(){t.getComponent().navigateNext()})})))}},{key:"cellisEdited",value:function(e){return!!e.modules.edit&&e.modules.edit.edited}},{key:"cellCancelEdit",value:function(e){e===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}},{key:"clearCellEdited",value:function(e){var t=this;e||(e=this.table.modules.edit.getEditedCells()),Array.isArray(e)||(e=[e]),e.forEach(function(e){t.table.modules.edit.clearEdited(e._getSelf())})}},{key:"navigatePrev",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,o=arguments.length>1?arguments[1]:void 0;if(n){if(o&&o.preventDefault(),e=this.navigateLeft())return!0;if((t=this.table.rowManager.prevDisplayRow(n.row,!0))&&(e=this.findNextEditableCell(t,t.cells.length)))return e.getComponent().edit(),!0}return!1}},{key:"navigateNext",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,o=arguments.length>1?arguments[1]:void 0;if(n){if(o&&o.preventDefault(),e=this.navigateRight())return!0;if((t=this.table.rowManager.nextDisplayRow(n.row,!0))&&(e=this.findNextEditableCell(t,-1)))return e.getComponent().edit(),!0}return!1}},{key:"navigateLeft",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,o=arguments.length>1?arguments[1]:void 0;return!!(n&&(o&&o.preventDefault(),e=n.getIndex(),t=this.findPrevEditableCell(n.row,e)))&&(t.getComponent().edit(),!0)}},{key:"navigateRight",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,o=arguments.length>1?arguments[1]:void 0;return!!(n&&(o&&o.preventDefault(),e=n.getIndex(),t=this.findNextEditableCell(n.row,e)))&&(t.getComponent().edit(),!0)}},{key:"navigateUp",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,o=arguments.length>1?arguments[1]:void 0;return!!(n&&(o&&o.preventDefault(),e=n.getIndex(),t=this.table.rowManager.prevDisplayRow(n.row,!0)))&&(t.cells[e].getComponent().edit(),!0)}},{key:"navigateDown",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCell,o=arguments.length>1?arguments[1]:void 0;return!!(n&&(o&&o.preventDefault(),e=n.getIndex(),t=this.table.rowManager.nextDisplayRow(n.row,!0)))&&(t.cells[e].getComponent().edit(),!0)}},{key:"findNextEditableCell",value:function(e,t){var n=!1;if(t<e.cells.length-1)for(var o=t+1;o<e.cells.length;o++){var a=e.cells[o];if(a.column.modules.edit&&v.elVisible(a.getElement())){var s=!0;if("function"==typeof a.column.modules.edit.check&&(s=a.column.modules.edit.check(a.getComponent())),s){n=a;break}}}return n}},{key:"findPrevEditableCell",value:function(e,t){var n=!1;if(t>0)for(var o=t-1;o>=0;o--){var a=e.cells[o],s=!0;if(a.column.modules.edit&&v.elVisible(a.getElement())&&("function"==typeof a.column.modules.edit.check&&(s=a.column.modules.edit.check(a.getComponent())),s)){n=a;break}}return n}},{key:"initializeColumnCheck",value:function(e){void 0!==e.definition.editor&&this.initializeColumn(e)}},{key:"columnDeleteCheck",value:function(e){this.currentCell&&this.currentCell.column===e&&this.cancelEdit()}},{key:"rowDeleteCheck",value:function(e){this.currentCell&&this.currentCell.row===e&&this.cancelEdit()}},{key:"initializeColumn",value:function(t){var n={editor:!1,blocked:!1,check:t.definition.editable,params:t.definition.editorParams||{}};switch(e(t.definition.editor)){case"string":this.editors[t.definition.editor]?n.editor=this.editors[t.definition.editor]:console.warn("Editor Error - No such editor found: ",t.definition.editor);break;case"function":n.editor=t.definition.editor;break;case"boolean":!0===t.definition.editor&&("function"!=typeof t.definition.formatter?this.editors[t.definition.formatter]?n.editor=this.editors[t.definition.formatter]:n.editor=this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",t.definition.formatter))}n.editor&&(t.modules.edit=n)}},{key:"getCurrentCell",value:function(){return!!this.currentCell&&this.currentCell.getComponent()}},{key:"clearEditor",value:function(e){var t,n=this.currentCell;if(this.invalidEdit=!1,n){for(this.currentCell=!1,t=n.getElement(),this.dispatch("edit-editor-clear",n,e),t.classList.remove("tabulator-editing");t.firstChild;)t.removeChild(t.firstChild);n.row.getElement().classList.remove("tabulator-row-editing")}}},{key:"cancelEdit",value:function(){if(this.currentCell){var e=this.currentCell,t=this.currentCell.getComponent();this.clearEditor(!0),e.setValueActual(e.getValue()),e.cellRendered(),("textarea"==e.column.definition.editor||e.column.definition.variableHeight)&&e.row.normalizeHeight(!0),e.column.definition.cellEditCancelled&&e.column.definition.cellEditCancelled.call(this.table,t),this.dispatch("edit-cancelled",e),this.dispatchExternal("cellEditCancelled",t)}}},{key:"bindEditor",value:function(e){if(e.column.modules.edit){var t=this,n=e.getElement(!0);n.setAttribute("tabindex",0),n.addEventListener("click",function(e){n.classList.contains("tabulator-editing")||n.focus({preventScroll:!0})}),n.addEventListener("mousedown",function(e){2===e.button?e.preventDefault():t.mouseClick=!0}),n.addEventListener("focus",function(n){t.recursionBlock||t.edit(e,n,!1)})}}},{key:"focusCellNoEvent",value:function(e,t){this.recursionBlock=!0,t&&"ie"===this.table.browser||e.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}},{key:"editCell",value:function(e,t){this.focusCellNoEvent(e),this.edit(e,!1,t)}},{key:"focusScrollAdjust",value:function(e){if("virtual"==this.table.rowManager.getRenderMode()){var t=this.table.rowManager.element.scrollTop,n=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,o=e.row.getElement();o.offsetTop,o.offsetTop<t?this.table.rowManager.element.scrollTop-=t-o.offsetTop:o.offsetTop+o.offsetHeight>n&&(this.table.rowManager.element.scrollTop+=o.offsetTop+o.offsetHeight-n);var a=this.table.rowManager.element.scrollLeft,s=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,r=e.getElement();r.offsetLeft,this.table.modExists("frozenColumns")&&(a+=parseInt(this.table.modules.frozenColumns.leftMargin),s-=parseInt(this.table.modules.frozenColumns.rightMargin)),"virtual"===this.table.options.renderHorizontal&&(a-=parseInt(this.table.columnManager.renderer.vDomPadLeft),s-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),r.offsetLeft<a?this.table.rowManager.element.scrollLeft-=a-r.offsetLeft:r.offsetLeft+r.offsetWidth>s&&(this.table.rowManager.element.scrollLeft+=r.offsetLeft+r.offsetWidth-s)}}},{key:"edit",value:function(t,n,o){var a,s,r,l=this,u=!0,h=function(){},c=t.getElement();if(!this.currentCell){if(t.column.modules.edit.blocked)return this.mouseClick=!1,c.blur(),!1;switch(n&&n.stopPropagation(),e(t.column.modules.edit.check)){case"function":u=t.column.modules.edit.check(t.getComponent());break;case"boolean":u=t.column.modules.edit.check}if(u||o){if(l.cancelEdit(),l.currentCell=t,this.focusScrollAdjust(t),s=t.getComponent(),this.mouseClick&&(this.mouseClick=!1,t.column.definition.cellClick&&t.column.definition.cellClick.call(this.table,n,s)),t.column.definition.cellEditing&&t.column.definition.cellEditing.call(this.table,s),this.dispatch("cell-editing",t),this.dispatchExternal("cellEditing",s),r="function"==typeof t.column.modules.edit.params?t.column.modules.edit.params(s):t.column.modules.edit.params,!1===(a=t.column.modules.edit.editor.call(l,s,function(e){h=e},function(e){if(l.currentCell===t){var n=l.chain("edit-success",[t,e],!0,!0);return!0===n||"highlight"===l.table.options.validationMode?(l.clearEditor(),t.modules.edit||(t.modules.edit={}),t.modules.edit.edited=!0,-1==l.editedCells.indexOf(t)&&l.editedCells.push(t),t.setValue(e,!0),!0===n):(l.invalidEdit=!0,l.focusCellNoEvent(t,!0),h(),!1)}},function(){l.currentCell===t&&l.cancelEdit()},r)))return c.blur(),!1;if(!(a instanceof Node))return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",a),c.blur(),!1;for(c.classList.add("tabulator-editing"),t.row.getElement().classList.add("tabulator-row-editing");c.firstChild;)c.removeChild(c.firstChild);c.appendChild(a),h();for(var d=c.children,p=0;p<d.length;p++)d[p].addEventListener("click",function(e){e.stopPropagation()});return!0}return this.mouseClick=!1,c.blur(),!1}this.invalidEdit||this.cancelEdit()}},{key:"getEditedCells",value:function(){var e=[];return this.editedCells.forEach(function(t){e.push(t.getComponent())}),e}},{key:"clearEdited",value:function(e){var t;e.modules.edit&&e.modules.edit.edited&&(e.modules.edit.edited=!1,this.dispatch("edit-edited-clear",e)),(t=this.editedCells.indexOf(e))>-1&&this.editedCells.splice(t,1)}}]),r}();et.moduleName="edit",et.editors={input:function(t,n,o,a,s){var r=t.getValue(),l=document.createElement("input");if(l.setAttribute("type",s.search?"search":"text"),l.style.padding="4px",l.style.width="100%",l.style.boxSizing="border-box",s.elementAttributes&&"object"==e(s.elementAttributes))for(var u in s.elementAttributes)"+"==u.charAt(0)?(u=u.slice(1),l.setAttribute(u,l.getAttribute(u)+s.elementAttributes["+"+u])):l.setAttribute(u,s.elementAttributes[u]);function h(e){null==r&&""!==l.value||l.value!==r?o(l.value)&&(r=l.value):a()}return l.value=void 0!==r?r:"",n(function(){l.focus({preventScroll:!0}),l.style.height="100%",s.selectContents&&l.select()}),l.addEventListener("change",h),l.addEventListener("blur",h),l.addEventListener("keydown",function(e){switch(e.keyCode){case 13:h();break;case 27:a();break;case 35:case 36:e.stopPropagation()}}),s.mask&&Z(l,s),l},textarea:function(t,n,o,a,s){var r=t.getValue(),l=s.verticalNavigation||"hybrid",u=String(null!=r?r:""),h=((u.match(/(?:\r\n|\r|\n)/g)||[]).length,document.createElement("textarea")),c=0;if(h.style.display="block",h.style.padding="2px",h.style.height="100%",h.style.width="100%",h.style.boxSizing="border-box",h.style.whiteSpace="pre-wrap",h.style.resize="none",s.elementAttributes&&"object"==e(s.elementAttributes))for(var d in s.elementAttributes)"+"==d.charAt(0)?(d=d.slice(1),h.setAttribute(d,h.getAttribute(d)+s.elementAttributes["+"+d])):h.setAttribute(d,s.elementAttributes[d]);function p(e){null==r&&""!==h.value||h.value!==r?(o(h.value)&&(r=h.value),setTimeout(function(){t.getRow().normalizeHeight()},300)):a()}return h.value=u,n(function(){h.focus({preventScroll:!0}),h.style.height="100%",h.scrollHeight,h.style.height=h.scrollHeight+"px",t.getRow().normalizeHeight(),s.selectContents&&h.select()}),h.addEventListener("change",p),h.addEventListener("blur",p),h.addEventListener("keyup",function(){h.style.height="";var e=h.scrollHeight;h.style.height=e+"px",e!=c&&(c=e,t.getRow().normalizeHeight())}),h.addEventListener("keydown",function(e){switch(e.keyCode){case 27:a();break;case 38:("editor"==l||"hybrid"==l&&h.selectionStart)&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 40:("editor"==l||"hybrid"==l&&h.selectionStart!==h.value.length)&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 35:case 36:e.stopPropagation()}}),s.mask&&Z(h,s),h},number:function(t,n,o,a,s){var r=t.getValue(),l=s.verticalNavigation||"editor",u=document.createElement("input");if(u.setAttribute("type","number"),void 0!==s.max&&u.setAttribute("max",s.max),void 0!==s.min&&u.setAttribute("min",s.min),void 0!==s.step&&u.setAttribute("step",s.step),u.style.padding="4px",u.style.width="100%",u.style.boxSizing="border-box",s.elementAttributes&&"object"==e(s.elementAttributes))for(var h in s.elementAttributes)"+"==h.charAt(0)?(h=h.slice(1),u.setAttribute(h,u.getAttribute(h)+s.elementAttributes["+"+h])):u.setAttribute(h,s.elementAttributes[h]);u.value=r;var c=function(e){d()};function d(){var e=u.value;isNaN(e)||""===e||(e=Number(e)),e!==r?o(e)&&(r=e):a()}return n(function(){u.removeEventListener("blur",c),u.focus({preventScroll:!0}),u.style.height="100%",u.addEventListener("blur",c),s.selectContents&&u.select()}),u.addEventListener("keydown",function(e){switch(e.keyCode){case 13:d();break;case 27:a();break;case 38:case 40:"editor"==l&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 35:case 36:e.stopPropagation()}}),s.mask&&Z(u,s),u},range:function(t,n,o,a,s){var r=t.getValue(),l=document.createElement("input");if(l.setAttribute("type","range"),void 0!==s.max&&l.setAttribute("max",s.max),void 0!==s.min&&l.setAttribute("min",s.min),void 0!==s.step&&l.setAttribute("step",s.step),l.style.padding="4px",l.style.width="100%",l.style.boxSizing="border-box",s.elementAttributes&&"object"==e(s.elementAttributes))for(var u in s.elementAttributes)"+"==u.charAt(0)?(u=u.slice(1),l.setAttribute(u,l.getAttribute(u)+s.elementAttributes["+"+u])):l.setAttribute(u,s.elementAttributes[u]);function h(){var e=l.value;isNaN(e)||""===e||(e=Number(e)),e!=r?o(e)&&(r=e):a()}return l.value=r,n(function(){l.focus({preventScroll:!0}),l.style.height="100%"}),l.addEventListener("blur",function(e){h()}),l.addEventListener("keydown",function(e){switch(e.keyCode){case 13:h();break;case 27:a()}}),l},select:function(e,t,n,o,a){return console.warn("The select editor has been deprecated, please use the new list editor"),new ee(this,e,t,n,o,a).input},list:function(e,t,n,o,a){return new ee(this,e,t,n,o,a).input},autocomplete:function(e,t,n,o,a){return console.warn("The autocomplete editor has been deprecated, please use the new list editor with the 'autocomplete' editorParam"),a.autocomplete=!0,new ee(this,e,t,n,o,a).input},star:function(t,n,o,a,s){var r=this,l=t.getElement(),u=t.getValue(),h=l.getElementsByTagName("svg").length||5,c=l.getElementsByTagName("svg")[0]?l.getElementsByTagName("svg")[0].getAttribute("width"):14,d=[],p=document.createElement("div"),m=document.createElementNS("http://www.w3.org/2000/svg","svg");function f(e){d.forEach(function(t,n){n<e?("ie"==r.table.browser?t.setAttribute("class","tabulator-star-active"):t.classList.replace("tabulator-star-inactive","tabulator-star-active"),t.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):("ie"==r.table.browser?t.setAttribute("class","tabulator-star-inactive"):t.classList.replace("tabulator-star-active","tabulator-star-inactive"),t.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')})}function g(e){var t=document.createElement("span"),n=m.cloneNode(!0);d.push(n),t.addEventListener("mouseenter",function(t){t.stopPropagation(),t.stopImmediatePropagation(),f(e)}),t.addEventListener("mousemove",function(e){e.stopPropagation(),e.stopImmediatePropagation()}),t.addEventListener("click",function(t){t.stopPropagation(),t.stopImmediatePropagation(),o(e),l.blur()}),t.appendChild(n),p.appendChild(t)}function v(e){u=e,f(e)}if(l.style.whiteSpace="nowrap",l.style.overflow="hidden",l.style.textOverflow="ellipsis",p.style.verticalAlign="middle",p.style.display="inline-block",p.style.padding="4px",m.setAttribute("width",c),m.setAttribute("height",c),m.setAttribute("viewBox","0 0 512 512"),m.setAttribute("xml:space","preserve"),m.style.padding="0 1px",s.elementAttributes&&"object"==e(s.elementAttributes))for(var b in s.elementAttributes)"+"==b.charAt(0)?(b=b.slice(1),p.setAttribute(b,p.getAttribute(b)+s.elementAttributes["+"+b])):p.setAttribute(b,s.elementAttributes[b]);for(var y=1;y<=h;y++)g(y);return f(u=Math.min(parseInt(u),h)),p.addEventListener("mousemove",function(e){f(0)}),p.addEventListener("click",function(e){o(0)}),l.addEventListener("blur",function(e){a()}),l.addEventListener("keydown",function(e){switch(e.keyCode){case 39:v(u+1);break;case 37:v(u-1);break;case 13:o(u);break;case 27:a()}}),p},progress:function(t,n,o,a,s){var r,l,u=t.getElement(),h=void 0===s.max?u.getElementsByTagName("div")[0]&&u.getElementsByTagName("div")[0].getAttribute("max")||100:s.max,c=void 0===s.min?u.getElementsByTagName("div")[0]&&u.getElementsByTagName("div")[0].getAttribute("min")||0:s.min,d=(h-c)/100,p=t.getValue()||0,m=document.createElement("div"),f=document.createElement("div");function g(){var e=window.getComputedStyle(u,null),t=d*Math.round(f.offsetWidth/((u.clientWidth-parseInt(e.getPropertyValue("padding-left"))-parseInt(e.getPropertyValue("padding-right")))/100))+c;o(t),u.setAttribute("aria-valuenow",t),u.setAttribute("aria-label",p)}if(m.style.position="absolute",m.style.right="0",m.style.top="0",m.style.bottom="0",m.style.width="5px",m.classList.add("tabulator-progress-handle"),f.style.display="inline-block",f.style.position="relative",f.style.height="100%",f.style.backgroundColor="#488CE9",f.style.maxWidth="100%",f.style.minWidth="0%",s.elementAttributes&&"object"==e(s.elementAttributes))for(var v in s.elementAttributes)"+"==v.charAt(0)?(v=v.slice(1),f.setAttribute(v,f.getAttribute(v)+s.elementAttributes["+"+v])):f.setAttribute(v,s.elementAttributes[v]);return u.style.padding="4px 4px",p=Math.min(parseFloat(p),h),p=Math.round(((p=Math.max(parseFloat(p),c))-c)/d),f.style.width=p+"%",u.setAttribute("aria-valuemin",c),u.setAttribute("aria-valuemax",h),f.appendChild(m),m.addEventListener("mousedown",function(e){r=e.screenX,l=f.offsetWidth}),m.addEventListener("mouseover",function(){m.style.cursor="ew-resize"}),u.addEventListener("mousemove",function(e){r&&(f.style.width=l+e.screenX-r+"px")}),u.addEventListener("mouseup",function(e){r&&(e.stopPropagation(),e.stopImmediatePropagation(),r=!1,l=!1,g())}),u.addEventListener("keydown",function(e){switch(e.keyCode){case 39:e.preventDefault(),f.style.width=f.clientWidth+u.clientWidth/100+"px";break;case 37:e.preventDefault(),f.style.width=f.clientWidth-u.clientWidth/100+"px";break;case 9:case 13:g();break;case 27:a()}}),u.addEventListener("blur",function(){a()}),f},tickCross:function(t,n,o,a,s){var r=t.getValue(),l=document.createElement("input"),u=s.tristate,h=void 0===s.indeterminateValue?null:s.indeterminateValue,c=!1,d=Object.keys(s).includes("trueValue"),p=Object.keys(s).includes("falseValue");if(l.setAttribute("type","checkbox"),l.style.marginTop="5px",l.style.boxSizing="border-box",s.elementAttributes&&"object"==e(s.elementAttributes))for(var m in s.elementAttributes)"+"==m.charAt(0)?(m=m.slice(1),l.setAttribute(m,l.getAttribute(m)+s.elementAttributes["+"+m])):l.setAttribute(m,s.elementAttributes[m]);function f(e){var t=l.checked;return t=d&&t?s.trueValue:p&&!t?s.falseValue:t,u?e?c?h:t:l.checked&&!c?(l.checked=!1,l.indeterminate=!0,c=!0,h):(c=!1,t):t}return l.value=r,u&&(void 0===r||r===h||""===r)&&(c=!0,l.indeterminate=!0),"firefox"!=this.table.browser&&n(function(){l.focus({preventScroll:!0})}),l.checked=d?r===s.trueValue:!0===r||"true"===r||"True"===r||1===r,n(function(){l.focus()}),l.addEventListener("change",function(e){o(f())}),l.addEventListener("blur",function(e){o(f(!0))}),l.addEventListener("keydown",function(e){13==e.keyCode&&o(f()),27==e.keyCode&&a()}),l}};var ei=function e(n,o,a,s){t(this,e),this.type=n,this.columns=o,this.component=a||!1,this.indent=s||0},en=function e(n,o,a,s,r){t(this,e),this.value=n,this.component=o||!1,this.width=a,this.height=s,this.depth=r},eo=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).config={},n.cloneTableStyle=!0,n.colVisProp="",n.registerTableOption("htmlOutputConfig",!1),n.registerColumnOption("htmlOutput"),n.registerColumnOption("titleHtmlOutput"),n}return o(r,[{key:"initialize",value:function(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}},{key:"generateExportList",value:function(e,t,n,o){this.cloneTableStyle=t,this.config=e||{},this.colVisProp=o;var a=!1!==this.config.columnHeaders?this.headersToExportRows(this.generateColumnGroupHeaders()):[],s=this.bodyToExportRows(this.rowLookup(n));return a.concat(s)}},{key:"genereateTable",value:function(e,t,n,o){var a=this.generateExportList(e,t,n,o);return this.genereateTableElement(a)}},{key:"rowLookup",value:function(e){var t=this,n=[];if("function"==typeof e)e.call(this.table).forEach(function(e){(e=t.table.rowManager.findRow(e))&&n.push(e)});else switch(e){case!0:case"visible":n=this.table.rowManager.getVisibleRows(!1,!0);break;case"all":n=this.table.rowManager.rows;break;case"selected":n=this.table.modules.selectRow.selectedRows;break;default:n=this.table.options.pagination?this.table.rowManager.getDisplayRows(this.table.rowManager.displayRows.length-2):this.table.rowManager.getDisplayRows()}return Object.assign([],n)}},{key:"generateColumnGroupHeaders",value:function(){var e=this,t=[];return(!1!==this.config.columnGroups?this.table.columnManager.columns:this.table.columnManager.columnsByIndex).forEach(function(n){var o=e.processColumnGroup(n);o&&t.push(o)}),t}},{key:"processColumnGroup",value:function(e){var t=this,n=e.columns,o=0,a={title:e.definition["title"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))]||e.definition.title,column:e,depth:1};if(n.length){if(a.subGroups=[],a.width=0,n.forEach(function(e){var n=t.processColumnGroup(e);n&&(a.width+=n.width,a.subGroups.push(n),n.depth>o&&(o=n.depth))}),a.depth+=o,!a.width)return!1}else{if(!this.columnVisCheck(e))return!1;a.width=1}return a}},{key:"columnVisCheck",value:function(e){return!1!==e.definition[this.colVisProp]&&(e.visible||!e.visible&&e.definition[this.colVisProp])}},{key:"headersToExportRows",value:function(e){var t=[],n=0,o=[];return e.forEach(function(e){e.depth>n&&(n=e.depth)}),e.forEach(function(e){!function e(o,a){var s=n-a;if(void 0===t[a]&&(t[a]=[]),o.height=o.subGroups?1:s-o.depth+1,t[a].push(o),o.height>1)for(var r=1;r<o.height;r++)void 0===t[a+r]&&(t[a+r]=[]),t[a+r].push(!1);if(o.width>1)for(var l=1;l<o.width;l++)t[a].push(!1);o.subGroups&&o.subGroups.forEach(function(t){e(t,a+1)})}(e,0)}),t.forEach(function(e){var t=[];e.forEach(function(e){if(e){var n=void 0===e.title?"":e.title;t.push(new en(n,e.column.getComponent(),e.width,e.height,e.depth))}else t.push(null)}),o.push(new ei("header",t))}),o}},{key:"bodyToExportRows",value:function(e){var t=this,n=[],o=[];return this.table.columnManager.columnsByIndex.forEach(function(e){t.columnVisCheck(e)&&n.push(e.getComponent())}),!1!==this.config.columnCalcs&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&e.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&e.push(this.table.modules.columnCalcs.botRow)),(e=e.filter(function(e){switch(e.type){case"group":return!1!==t.config.rowGroups;case"calc":return!1!==t.config.columnCalcs;case"row":return!(t.table.options.dataTree&&!1===t.config.dataTree&&e.modules.dataTree.parent)}return!0})).forEach(function(e,a){var s=e.getData(t.colVisProp),r=[],l=0;switch(e.type){case"group":l=e.level,r.push(new en(e.key,e.getComponent(),n.length,1));break;case"calc":case"row":n.forEach(function(e){r.push(new en(e._column.getFieldValue(s),e,1,1))}),t.table.options.dataTree&&!1!==t.config.dataTree&&(l=e.modules.dataTree.index)}o.push(new ei(e.type,r,e.getComponent(),l))}),o}},{key:"genereateTableElement",value:function(e){var t=this,n=document.createElement("table"),o=document.createElement("thead"),a=document.createElement("tbody"),s=this.lookupTableStyles(),r=this.table.options["rowFormatter"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))],l={};return l.rowFormatter=null!==r?r:this.table.options.rowFormatter,this.table.options.dataTree&&!1!==this.config.dataTree&&this.table.modExists("columnCalcs")&&(l.treeElementField=this.table.modules.dataTree.elementField),l.groupHeader=this.table.options["groupHeader"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))],l.groupHeader&&!Array.isArray(l.groupHeader)&&(l.groupHeader=[l.groupHeader]),n.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),o,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),e.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),e.forEach(function(e,n){switch(e.type){case"header":o.appendChild(t.genereateHeaderElement(e,l,s));break;case"group":a.appendChild(t.genereateGroupElement(e,l,s));break;case"calc":a.appendChild(t.genereateCalcElement(e,l,s));break;case"row":var r=t.genereateRowElement(e,l,s);t.mapElementStyles(n%2&&s.evenRow?s.evenRow:s.oddRow,r,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),a.appendChild(r)}}),o.innerHTML&&n.appendChild(o),n.appendChild(a),this.mapElementStyles(this.table.element,n,["border-top","border-left","border-right","border-bottom"]),n}},{key:"lookupTableStyles",value:function(){var e={};return this.cloneTableStyle&&window.getComputedStyle&&(e.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),e.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),e.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),e.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),e.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],e.firstRow&&(e.styleCells=e.firstRow.getElementsByClassName("tabulator-cell"),e.firstCell=e.styleCells[0],e.lastCell=e.styleCells[e.styleCells.length-1])),e}},{key:"genereateHeaderElement",value:function(e,t,n){var o=this,a=document.createElement("tr");return e.columns.forEach(function(e){if(e){var t=document.createElement("th"),n=e.component._column.definition.cssClass?e.component._column.definition.cssClass.split(" "):[];t.colSpan=e.width,t.rowSpan=e.height,t.innerHTML=e.value,o.cloneTableStyle&&(t.style.boxSizing="border-box"),n.forEach(function(e){t.classList.add(e)}),o.mapElementStyles(e.component.getElement(),t,["text-align","border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),o.mapElementStyles(e.component._column.contentElement,t,["padding-top","padding-left","padding-right","padding-bottom"]),e.component._column.visible?o.mapElementStyles(e.component.getElement(),t,["width"]):e.component._column.definition.width&&(t.style.width=e.component._column.definition.width+"px"),e.component._column.parent&&o.mapElementStyles(e.component._column.parent.groupElement,t,["border-top"]),a.appendChild(t)}}),a}},{key:"genereateGroupElement",value:function(e,t,n){var o=document.createElement("tr"),a=document.createElement("td"),s=e.columns[0];return o.classList.add("tabulator-print-table-row"),t.groupHeader&&t.groupHeader[e.indent]?s.value=t.groupHeader[e.indent](s.value,e.component._group.getRowCount(),e.component._group.getData(),e.component):!1===t.groupHeader?s.value=s.value:s.value=e.component._group.generator(s.value,e.component._group.getRowCount(),e.component._group.getData(),e.component),a.colSpan=s.width,a.innerHTML=s.value,o.classList.add("tabulator-print-table-group"),o.classList.add("tabulator-group-level-"+e.indent),s.component.isVisible()&&o.classList.add("tabulator-group-visible"),this.mapElementStyles(n.firstGroup,o,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(n.firstGroup,a,["padding-top","padding-left","padding-right","padding-bottom"]),o.appendChild(a),o}},{key:"genereateCalcElement",value:function(e,t,n){var o=this.genereateRowElement(e,t,n);return o.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(n.calcRow,o,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),o}},{key:"genereateRowElement",value:function(t,n,o){var a=this,s=document.createElement("tr");return s.classList.add("tabulator-print-table-row"),t.columns.forEach(function(r){if(r){var l=document.createElement("td"),u=r.component._column,h=a.table.columnManager.findColumnIndex(u),c=r.value,d={modules:{},getValue:function(){return c},getField:function(){return u.definition.field},getElement:function(){return l},getColumn:function(){return u.getComponent()},getData:function(){return t.component.getData()},getRow:function(){return t.component},getComponent:function(){return d},column:u};if((u.definition.cssClass?u.definition.cssClass.split(" "):[]).forEach(function(e){l.classList.add(e)}),a.table.modExists("format")&&!1!==a.config.formatCells)c=a.table.modules.format.formatExportValue(d,a.colVisProp);else switch(e(c)){case"object":c=JSON.stringify(c);break;case"undefined":case"null":c=""}c instanceof Node?l.appendChild(c):l.innerHTML=c,(o.styleCells[h]||o.firstCell)&&(a.mapElementStyles(o.styleCells[h]||o.firstCell,l,["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"]),u.definition.align&&(l.style.textAlign=u.definition.align)),a.table.options.dataTree&&!1!==a.config.dataTree&&(n.treeElementField&&n.treeElementField==u.field||!n.treeElementField&&0==i)&&(t.component._row.modules.dataTree.controlEl&&l.insertBefore(t.component._row.modules.dataTree.controlEl.cloneNode(!0),l.firstChild),t.component._row.modules.dataTree.branchEl&&l.insertBefore(t.component._row.modules.dataTree.branchEl.cloneNode(!0),l.firstChild)),s.appendChild(l),d.modules.format&&d.modules.format.renderedCallback&&d.modules.format.renderedCallback(),n.rowFormatter&&!1!==a.config.formatCells&&n.rowFormatter(t.component)}}),s}},{key:"genereateHTMLTable",value:function(e){var t=document.createElement("div");return t.appendChild(this.genereateTableElement(e)),t.innerHTML}},{key:"getHtml",value:function(e,t,n,o){var a=this.generateExportList(n||this.table.options.htmlOutputConfig,t,e,o||"htmlOutput");return this.genereateHTMLTable(a)}},{key:"mapElementStyles",value:function(e,t,n){if(this.cloneTableStyle&&e&&t){var o={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var a=window.getComputedStyle(e);n.forEach(function(e){t.style[o[e]]=a.getPropertyValue(e)})}}}}]),r}();eo.moduleName="export";var ea=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).filterList=[],n.headerFilters={},n.headerFilterColumns=[],n.prevHeaderFilterChangeCheck="",n.prevHeaderFilterChangeCheck="{}",n.changed=!1,n.tableInitialized=!1,n.registerTableOption("filterMode","local"),n.registerTableOption("initialFilter",!1),n.registerTableOption("initialHeaderFilter",!1),n.registerTableOption("headerFilterLiveFilterDelay",300),n.registerColumnOption("headerFilter"),n.registerColumnOption("headerFilterPlaceholder"),n.registerColumnOption("headerFilterParams"),n.registerColumnOption("headerFilterEmptyCheck"),n.registerColumnOption("headerFilterFunc"),n.registerColumnOption("headerFilterFuncParams"),n.registerColumnOption("headerFilterLiveFilter"),n.registerTableFunction("searchRows",n.searchRows.bind(l(n))),n.registerTableFunction("searchData",n.searchData.bind(l(n))),n.registerTableFunction("setFilter",n.userSetFilter.bind(l(n))),n.registerTableFunction("refreshFilter",n.userRefreshFilter.bind(l(n))),n.registerTableFunction("addFilter",n.userAddFilter.bind(l(n))),n.registerTableFunction("getFilters",n.getFilters.bind(l(n))),n.registerTableFunction("setHeaderFilterFocus",n.userSetHeaderFilterFocus.bind(l(n))),n.registerTableFunction("getHeaderFilterValue",n.userGetHeaderFilterValue.bind(l(n))),n.registerTableFunction("setHeaderFilterValue",n.userSetHeaderFilterValue.bind(l(n))),n.registerTableFunction("getHeaderFilters",n.getHeaderFilters.bind(l(n))),n.registerTableFunction("removeFilter",n.userRemoveFilter.bind(l(n))),n.registerTableFunction("clearFilter",n.userClearFilter.bind(l(n))),n.registerTableFunction("clearHeaderFilter",n.userClearHeaderFilter.bind(l(n))),n.registerComponentFunction("column","headerFilterFocus",n.setHeaderFilterFocus.bind(l(n))),n.registerComponentFunction("column","reloadHeaderFilter",n.reloadHeaderFilter.bind(l(n))),n.registerComponentFunction("column","getHeaderFilterValue",n.getHeaderFilterValue.bind(l(n))),n.registerComponentFunction("column","setHeaderFilterValue",n.setHeaderFilterValue.bind(l(n))),n}return o(r,[{key:"initialize",value:function(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),"remote"===this.table.options.filterMode&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}},{key:"tableBuilt",value:function(){var e=this;this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach(function(t){var n=e.table.columnManager.findColumn(t.field);if(!n)return console.warn("Column Filter Error - No matching column found:",t.field),!1;e.setHeaderFilterValue(n,t.value)}),this.tableInitialized=!0}},{key:"remoteFilterParams",value:function(e,t,n,o){return o.filter=this.getFilters(!0,!0),o}},{key:"userSetFilter",value:function(e,t,n,o){this.setFilter(e,t,n,o),this.refreshFilter()}},{key:"userRefreshFilter",value:function(){this.refreshFilter()}},{key:"userAddFilter",value:function(e,t,n,o){this.addFilter(e,t,n,o),this.refreshFilter()}},{key:"userSetHeaderFilterFocus",value:function(e){var t=this.table.columnManager.findColumn(e);if(!t)return console.warn("Column Filter Focus Error - No matching column found:",e),!1;this.setHeaderFilterFocus(t)}},{key:"userGetHeaderFilterValue",value:function(e){var t=this.table.columnManager.findColumn(e);if(t)return this.getHeaderFilterValue(t);console.warn("Column Filter Error - No matching column found:",e)}},{key:"userSetHeaderFilterValue",value:function(e,t){var n=this.table.columnManager.findColumn(e);if(!n)return console.warn("Column Filter Error - No matching column found:",e),!1;this.setHeaderFilterValue(n,t)}},{key:"userRemoveFilter",value:function(e,t,n){this.removeFilter(e,t,n),this.refreshFilter()}},{key:"userClearFilter",value:function(e){this.clearFilter(e),this.refreshFilter()}},{key:"userClearHeaderFilter",value:function(){this.clearHeaderFilter(),this.refreshFilter()}},{key:"searchRows",value:function(e,t,n){return this.search("rows",e,t,n)}},{key:"searchData",value:function(e,t,n){return this.search("data",e,t,n)}},{key:"initializeColumnHeaderFilter",value:function(e){var t=e.definition;t.headerFilter&&(void 0!==t.headerFilterPlaceholder&&t.field&&this.module("localize").setHeaderFilterColumnPlaceholder(t.field,t.headerFilterPlaceholder),this.initializeColumn(e))}},{key:"initializeColumn",value:function(t,n){var o=this,a=t.getField();t.modules.filter={success:function(n){var s,l="input"==t.modules.filter.tagType&&"text"==t.modules.filter.attrType||"textarea"==t.modules.filter.tagType?"partial":"match",u="",h="";if(void 0===t.modules.filter.prevSuccess||t.modules.filter.prevSuccess!==n){if(t.modules.filter.prevSuccess=n,t.modules.filter.emptyFunc(n))delete o.headerFilters[a];else{switch(t.modules.filter.value=n,e(t.definition.headerFilterFunc)){case"string":r.filters[t.definition.headerFilterFunc]?(u=t.definition.headerFilterFunc,s=function(e){var o=t.definition.headerFilterFuncParams||{},a=t.getFieldValue(e);return o="function"==typeof o?o(n,a,e):o,r.filters[t.definition.headerFilterFunc](n,a,e,o)}):console.warn("Header Filter Error - Matching filter function not found: ",t.definition.headerFilterFunc);break;case"function":u=s=function(e){var o=t.definition.headerFilterFuncParams||{},a=t.getFieldValue(e);return o="function"==typeof o?o(n,a,e):o,t.definition.headerFilterFunc(n,a,e,o)}}!s&&("partial"===l?(s=function(e){var o=t.getFieldValue(e);return null!=o&&String(o).toLowerCase().indexOf(String(n).toLowerCase())>-1},u="like"):(s=function(e){return t.getFieldValue(e)==n},u="=")),o.headerFilters[a]={value:n,func:s,type:u,params:{}}}t.modules.filter.value=n,h=JSON.stringify(o.headerFilters),o.prevHeaderFilterChangeCheck!==h&&(o.prevHeaderFilterChangeCheck=h,o.trackChanges(),o.refreshFilter())}return!0},attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(t)}},{key:"generateHeaderFilterElement",value:function(t,n,o){var a,s,r,l,u,h,c,d=this,p=this,m=t.modules.filter.success,f=t.getField();if(t.modules.filter.value=n,t.modules.filter.headerElement&&t.modules.filter.headerElement.parentNode&&t.contentElement.removeChild(t.modules.filter.headerElement.parentNode),f){switch(t.modules.filter.emptyFunc=t.definition.headerFilterEmptyCheck||function(e){return!e&&"0"!==e&&0!==e},(a=document.createElement("div")).classList.add("tabulator-header-filter"),e(t.definition.headerFilter)){case"string":p.table.modules.edit.editors[t.definition.headerFilter]?(s=p.table.modules.edit.editors[t.definition.headerFilter],"tick"!==t.definition.headerFilter&&"tickCross"!==t.definition.headerFilter||t.definition.headerFilterEmptyCheck||(t.modules.filter.emptyFunc=function(e){return!0!==e&&!1!==e})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",t.definition.editor);break;case"function":s=t.definition.headerFilter;break;case"boolean":t.modules.edit&&t.modules.edit.editor?s=t.modules.edit.editor:t.definition.formatter&&p.table.modules.edit.editors[t.definition.formatter]?(s=p.table.modules.edit.editors[t.definition.formatter],"tick"!==t.definition.formatter&&"tickCross"!==t.definition.formatter||t.definition.headerFilterEmptyCheck||(t.modules.filter.emptyFunc=function(e){return!0!==e&&!1!==e})):s=p.table.modules.edit.editors.input}if(s){if(l={getValue:function(){return void 0!==n?n:""},getField:function(){return t.definition.field},getElement:function(){return a},getColumn:function(){return t.getComponent()},getRow:function(){return{normalizeHeight:function(){}}}},c="function"==typeof(c=t.definition.headerFilterParams||{})?c.call(p.table,l):c,!(r=s.call(this.table.modules.edit,l,function(){},m,function(){},c)))return void console.warn("Filter Error - Cannot add filter to "+f+" column, editor returned a value of false");if(!(r instanceof Node))return void console.warn("Filter Error - Cannot add filter to "+f+" column, editor should return an instance of Node, the editor returned:",r);f?p.langBind("headerFilters|columns|"+t.definition.field,function(e){r.setAttribute("placeholder",void 0!==e&&e?e:p.langText("headerFilters|default"))}):p.langBind("headerFilters|default",function(e){r.setAttribute("placeholder",e)}),r.addEventListener("click",function(e){e.stopPropagation(),r.focus()}),r.addEventListener("focus",function(e){var t=d.table.columnManager.element.scrollLeft;t!==d.table.rowManager.element.scrollLeft+parseInt(d.table.columnManager.element.style.marginLeft)&&(d.table.rowManager.scrollHorizontal(t),d.table.columnManager.scrollHorizontal(t))}),u=!1,h=function(e){u&&clearTimeout(u),u=setTimeout(function(){m(r.value)},p.table.options.headerFilterLiveFilterDelay)},t.modules.filter.headerElement=r,t.modules.filter.attrType=r.hasAttribute("type")?r.getAttribute("type").toLowerCase():"",t.modules.filter.tagType=r.tagName.toLowerCase(),!1!==t.definition.headerFilterLiveFilter&&("autocomplete"!==t.definition.headerFilter&&"tickCross"!==t.definition.headerFilter&&("autocomplete"!==t.definition.editor&&"tickCross"!==t.definition.editor||!0!==t.definition.headerFilter)&&(r.addEventListener("keyup",h),r.addEventListener("search",h),"number"==t.modules.filter.attrType&&r.addEventListener("change",function(e){m(r.value)}),"text"==t.modules.filter.attrType&&"ie"!==this.table.browser&&r.setAttribute("type","search")),"input"!=t.modules.filter.tagType&&"select"!=t.modules.filter.tagType&&"textarea"!=t.modules.filter.tagType||r.addEventListener("mousedown",function(e){e.stopPropagation()})),a.appendChild(r),t.contentElement.appendChild(a),o||p.headerFilterColumns.push(t)}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",t.definition.title)}},{key:"hideHeaderFilterElements",value:function(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="none")})}},{key:"showHeaderFilterElements",value:function(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="")})}},{key:"setHeaderFilterFocus",value:function(e){e.modules.filter&&e.modules.filter.headerElement?e.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",e.getField())}},{key:"getHeaderFilterValue",value:function(e){if(e.modules.filter&&e.modules.filter.headerElement)return e.modules.filter.value;console.warn("Column Filter Error - No header filter set on column:",e.getField())}},{key:"setHeaderFilterValue",value:function(e,t){e&&(e.modules.filter&&e.modules.filter.headerElement?(this.generateHeaderFilterElement(e,t,!0),e.modules.filter.success(t)):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}},{key:"reloadHeaderFilter",value:function(e){e&&(e.modules.filter&&e.modules.filter.headerElement?this.generateHeaderFilterElement(e,e.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}},{key:"refreshFilter",value:function(){this.tableInitialized&&("remote"===this.table.options.filterMode?this.reloadData():this.refreshData(!0))}},{key:"trackChanges",value:function(){this.changed=!0,this.dispatch("filter-changed")}},{key:"hasChanged",value:function(){var e=this.changed;return this.changed=!1,e}},{key:"setFilter",value:function(e,t,n,o){this.filterList=[],Array.isArray(e)||(e=[{field:e,type:t,value:n,params:o}]),this.addFilter(e)}},{key:"addFilter",value:function(e,t,n,o){var a=this,s=!1;Array.isArray(e)||(e=[{field:e,type:t,value:n,params:o}]),e.forEach(function(e){(e=a.findFilter(e))&&(a.filterList.push(e),s=!0)}),s&&this.trackChanges()}},{key:"findFilter",value:function(e){if(Array.isArray(e))return this.findSubFilters(e);var t,n=!1;return"function"==typeof e.field?n=function(t){return e.field(t,e.type||{})}:r.filters[e.type]?n=(t=this.table.columnManager.getColumnByField(e.field))?function(n){return r.filters[e.type](e.value,t.getFieldValue(n),n,e.params||{})}:function(t){return r.filters[e.type](e.value,t[e.field],t,e.params||{})}:console.warn("Filter Error - No such filter type found, ignoring: ",e.type),e.func=n,!!e.func&&e}},{key:"findSubFilters",value:function(e){var t=this,n=[];return e.forEach(function(e){(e=t.findFilter(e))&&n.push(e)}),!!n.length&&n}},{key:"getFilters",value:function(e,t){var n=[];return e&&(n=this.getHeaderFilters()),t&&n.forEach(function(e){"function"==typeof e.type&&(e.type="function")}),n=n.concat(this.filtersToArray(this.filterList,t))}},{key:"filtersToArray",value:function(e,t){var n=this,o=[];return e.forEach(function(e){var a;Array.isArray(e)?o.push(n.filtersToArray(e,t)):(a={field:e.field,type:e.type,value:e.value},t&&"function"==typeof a.type&&(a.type="function"),o.push(a))}),o}},{key:"getHeaderFilters",value:function(){var e=[];for(var t in this.headerFilters)e.push({field:t,type:this.headerFilters[t].type,value:this.headerFilters[t].value});return e}},{key:"removeFilter",value:function(t,n,o){var a=this;Array.isArray(t)||(t=[{field:t,type:n,value:o}]),t.forEach(function(t){var n=-1;(n="object"==e(t.field)?a.filterList.findIndex(function(e){return t===e}):a.filterList.findIndex(function(e){return t.field===e.field&&t.type===e.type&&t.value===e.value}))>-1?a.filterList.splice(n,1):console.warn("Filter Error - No matching filter type found, ignoring: ",t.type)}),this.trackChanges()}},{key:"clearFilter",value:function(e){this.filterList=[],e&&this.clearHeaderFilter(),this.trackChanges()}},{key:"clearHeaderFilter",value:function(){var e=this;this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach(function(t){void 0!==t.modules.filter.value&&delete t.modules.filter.value,t.modules.filter.prevSuccess=void 0,e.reloadHeaderFilter(t)}),this.trackChanges()}},{key:"search",value:function(e,t,n,o){var a=this,s=[],r=[];return Array.isArray(t)||(t=[{field:t,type:n,value:o}]),t.forEach(function(e){(e=a.findFilter(e))&&r.push(e)}),this.table.rowManager.rows.forEach(function(t){var n=!0;r.forEach(function(e){a.filterRecurse(e,t.getData())||(n=!1)}),n&&s.push("data"===e?t.getData("data"):t.getComponent())}),s}},{key:"filter",value:function(e,t){var n=this,o=[],a=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters(!0)),"remote"!==this.table.options.filterMode&&(this.filterList.length||Object.keys(this.headerFilters).length)?e.forEach(function(e){n.filterRow(e)&&o.push(e)}):o=e.slice(0),this.subscribedExternal("dataFiltered")&&(o.forEach(function(e){a.push(e.getComponent())}),this.dispatchExternal("dataFiltered",this.getFilters(!0),a)),o}},{key:"filterRow",value:function(e,t){var n=this,o=!0,a=e.getData();for(var s in this.filterList.forEach(function(e){n.filterRecurse(e,a)||(o=!1)}),this.headerFilters)this.headerFilters[s].func(a)||(o=!1);return o}},{key:"filterRecurse",value:function(e,t){var n=this,o=!1;return Array.isArray(e)?e.forEach(function(e){n.filterRecurse(e,t)&&(o=!0)}):o=e.func(t),o}}]),r}();ea.moduleName="filter",ea.filters={"=":function(e,t,n,o){return t==e},"<":function(e,t,n,o){return t<e},"<=":function(e,t,n,o){return t<=e},">":function(e,t,n,o){return t>e},">=":function(e,t,n,o){return t>=e},"!=":function(e,t,n,o){return t!=e},regex:function(e,t,n,o){return"string"==typeof e&&(e=RegExp(e)),e.test(t)},like:function(e,t,n,o){return null==e?t===e:null!=t&&String(t).toLowerCase().indexOf(e.toLowerCase())>-1},keywords:function(e,t,n,o){var a=e.toLowerCase().split(void 0===o.separator?" ":o.separator),s=String(null==t?"":t).toLowerCase(),r=[];return a.forEach(function(e){s.includes(e)&&r.push(!0)}),o.matchAll?r.length===a.length:!!r.length},starts:function(e,t,n,o){return null==e?t===e:null!=t&&String(t).toLowerCase().startsWith(e.toLowerCase())},ends:function(e,t,n,o){return null==e?t===e:null!=t&&String(t).toLowerCase().endsWith(e.toLowerCase())},in:function(e,t,n,o){return Array.isArray(e)?!e.length||e.indexOf(t)>-1:(console.warn("Filter Error - filter value is not an array:",e),!1)}};var es=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).registerColumnOption("formatter"),n.registerColumnOption("formatterParams"),n.registerColumnOption("formatterPrint"),n.registerColumnOption("formatterPrintParams"),n.registerColumnOption("formatterClipboard"),n.registerColumnOption("formatterClipboardParams"),n.registerColumnOption("formatterHtmlOutput"),n.registerColumnOption("formatterHtmlOutputParams"),n.registerColumnOption("titleFormatter"),n.registerColumnOption("titleFormatterParams"),n}return o(r,[{key:"initialize",value:function(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}},{key:"initializeColumn",value:function(e){e.modules.format=this.lookupFormatter(e,""),void 0!==e.definition.formatterPrint&&(e.modules.format.print=this.lookupFormatter(e,"Print")),void 0!==e.definition.formatterClipboard&&(e.modules.format.clipboard=this.lookupFormatter(e,"Clipboard")),void 0!==e.definition.formatterHtmlOutput&&(e.modules.format.htmlOutput=this.lookupFormatter(e,"HtmlOutput"))}},{key:"lookupFormatter",value:function(t,n){var o={params:t.definition["formatter"+n+"Params"]||{}},a=t.definition["formatter"+n];switch(e(a)){case"string":r.formatters[a]?o.formatter=r.formatters[a]:(console.warn("Formatter Error - No such formatter found: ",a),o.formatter=r.formatters.plaintext);break;case"function":o.formatter=a;break;default:o.formatter=r.formatters.plaintext}return o}},{key:"cellRendered",value:function(e){e.modules.format&&e.modules.format.renderedCallback&&!e.modules.format.rendered&&(e.modules.format.renderedCallback(),e.modules.format.rendered=!0)}},{key:"formatHeader",value:function(e,t,n){var o,a,s,r;return e.definition.titleFormatter?(o=this.getFormatter(e.definition.titleFormatter),s=function(t){e.titleFormatterRendered=t},r={getValue:function(){return t},getElement:function(){return n}},a="function"==typeof(a=e.definition.titleFormatterParams||{})?a():a,o.call(this,r,a,s)):t}},{key:"formatValue",value:function(e){var t=e.getComponent(),n="function"==typeof e.column.modules.format.params?e.column.modules.format.params(t):e.column.modules.format.params;return e.column.modules.format.formatter.call(this,t,n,function(t){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=t,e.modules.format.rendered=!1})}},{key:"formatExportValue",value:function(e,t){var n,o=e.column.modules.format[t];return o?(n="function"==typeof o.params?o.params(component):o.params,o.formatter.call(this,e.getComponent(),n,function(t){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=t,e.modules.format.rendered=!1})):this.formatValue(e)}},{key:"sanitizeHTML",value:function(e){if(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=\/]/g,function(e){return t[e]})}return e}},{key:"emptyToSpace",value:function(e){return null==e||""===e?"&nbsp;":e}},{key:"getFormatter",value:function(t){switch(e(t)){case"string":r.formatters[t]?t=r.formatters[t]:(console.warn("Formatter Error - No such formatter found: ",t),t=r.formatters.plaintext);break;case"function":break;default:t=r.formatters.plaintext}return t}}]),r}();es.moduleName="format",es.formatters={plaintext:function(e,t,n){return this.emptyToSpace(this.sanitizeHTML(e.getValue()))},html:function(e,t,n){return e.getValue()},textarea:function(e,t,n){return e.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(e.getValue()))},money:function(e,t,n){var o,a,s,r,l=parseFloat(e.getValue()),u="",h=t.decimal||".",c=t.thousand||",",d=t.negativeSign||"-",p=t.symbol||"",m=!!t.symbolAfter,f=void 0!==t.precision?t.precision:2;if(isNaN(l))return this.emptyToSpace(this.sanitizeHTML(e.getValue()));if(l<0&&(l=Math.abs(l),u=d),a=(o=String(o=!1!==f?l.toFixed(f):l).split("."))[0],s=o.length>1?h+o[1]:"",!1!==t.thousand)for(r=/(\d+)(\d{3})/;r.test(a);)a=a.replace(r,"$1"+c+"$2");return m?u+a+s+p:u+p+a+s},link:function(t,n,o){var a,s=t.getValue(),r=n.urlPrefix||"",l=n.download,u=s,h=document.createElement("a");if(n.labelField&&(a=t.getData(),u=function t(n,o){var a=o[n.shift()];return n.length&&"object"===e(a)?t(n,a):a}(n.labelField.split(this.table.options.nestedFieldSeparator),a)),n.label)switch(e(n.label)){case"string":u=n.label;break;case"function":u=n.label(t)}if(u){if(n.urlField&&(s=(a=t.getData())[n.urlField]),n.url)switch(e(n.url)){case"string":s=n.url;break;case"function":s=n.url(t)}return h.setAttribute("href",r+s),n.target&&h.setAttribute("target",n.target),n.download&&(l="function"==typeof l?l(t):!0===l?"":l,h.setAttribute("download",l)),h.innerHTML=this.emptyToSpace(this.sanitizeHTML(u)),h}return"&nbsp;"},image:function(t,n,o){var a=document.createElement("img"),s=t.getValue();switch(n.urlPrefix&&(s=n.urlPrefix+t.getValue()),n.urlSuffix&&(s+=n.urlSuffix),a.setAttribute("src",s),e(n.height)){case"number":a.style.height=n.height+"px";break;case"string":a.style.height=n.height}switch(e(n.width)){case"number":a.style.width=n.width+"px";break;case"string":a.style.width=n.width}return a.addEventListener("load",function(){t.getRow().normalizeHeight()}),a},tickCross:function(e,t,n){var o=e.getValue(),a=e.getElement(),s=t.allowEmpty,r=t.allowTruthy,l=Object.keys(t).includes("trueValue"),u=void 0!==t.tickElement?t.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',h=void 0!==t.crossElement?t.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return l&&o===t.trueValue||!l&&(r&&o||!0===o||"true"===o||"True"===o||1===o||"1"===o)?(a.setAttribute("aria-checked",!0),u||""):s&&("null"===o||""===o||null==o)?(a.setAttribute("aria-checked","mixed"),""):(a.setAttribute("aria-checked",!1),h||"")},lookup:function(e,t,n){var o=e.getValue();return void 0===t[o]?(console.warn("Missing display value for "+o),o):t[o]},star:function(e,t,n){var o=e.getValue(),a=e.getElement(),s=t&&t.stars?t.stars:5,r=document.createElement("span"),l=document.createElementNS("http://www.w3.org/2000/svg","svg");r.style.verticalAlign="middle",l.setAttribute("width","14"),l.setAttribute("height","14"),l.setAttribute("viewBox","0 0 512 512"),l.setAttribute("xml:space","preserve"),l.style.padding="0 1px",o=Math.max(0,Math.min(o=o&&!isNaN(o)?parseInt(o):0,s));for(var u=1;u<=s;u++){var h=l.cloneNode(!0);h.innerHTML=u<=o?'<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>':'<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',r.appendChild(h)}return a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.textOverflow="ellipsis",a.setAttribute("aria-label",o),r},traffic:function(t,n,o){var a,s,r=this.sanitizeHTML(t.getValue())||0,l=document.createElement("span"),u=n&&n.max?n.max:100,h=n&&n.min?n.min:0,c=n&&void 0!==n.color?n.color:["red","orange","green"],d="#666666";if(!isNaN(r)&&void 0!==t.getValue()){switch(l.classList.add("tabulator-traffic-light"),s=parseFloat(r)<=u?parseFloat(r):u,s=parseFloat(s)>=h?parseFloat(s):h,a=(u-h)/100,s=Math.round((s-h)/a),e(c)){case"string":d=c;break;case"function":d=c(r);break;case"object":if(Array.isArray(c)){var p=Math.floor(s/(100/c.length));d=c[p=Math.max(p=Math.min(p,c.length-1),0)]}}return l.style.backgroundColor=d,l}},progress:function(t,n,o){var a,s,r,l,u,h=this.sanitizeHTML(t.getValue())||0,c=t.getElement(),d=n&&n.max?n.max:100,p=n&&n.min?n.min:0,f=n&&n.legendAlign?n.legendAlign:"center";switch(s=parseFloat(h)<=d?parseFloat(h):d,s=parseFloat(s)>=p?parseFloat(s):p,a=(d-p)/100,s=Math.round((s-p)/a),e(n.color)){case"string":r=n.color;break;case"function":r=n.color(h);break;case"object":if(Array.isArray(n.color)){var g=100/n.color.length,v=Math.floor(s/g);v=Math.max(v=Math.min(v,n.color.length-1),0),r=n.color[v];break}default:r="#2DC214"}switch(e(n.legend)){case"string":l=n.legend;break;case"function":l=n.legend(h);break;case"boolean":l=h;break;default:l=!1}switch(e(n.legendColor)){case"string":u=n.legendColor;break;case"function":u=n.legendColor(h);break;case"object":Array.isArray(n.legendColor)&&(v=Math.max(v=Math.min(v=Math.floor(s/(g=100/n.legendColor.length)),n.legendColor.length-1),0),u=n.legendColor[v]);break;default:u="#000"}c.style.minWidth="30px",c.style.position="relative",c.setAttribute("aria-label",s);var b=document.createElement("div");b.style.display="inline-block",b.style.position="absolute",b.style.width=s+"%",b.style.backgroundColor=r,b.style.height="100%",b.setAttribute("data-max",d),b.setAttribute("data-min",p);var y=document.createElement("div");if(y.style.position="relative",y.style.width="100%",y.style.height="100%",l){var w=document.createElement("div");w.style.position="absolute",w.style.top=0,w.style.left=0,w.style.textAlign=f,w.style.width="100%",w.style.color=u,w.innerHTML=l}return o(function(){if(!(t instanceof m)){var e=document.createElement("div");e.style.position="absolute",e.style.top="4px",e.style.bottom="4px",e.style.left="4px",e.style.right="4px",c.appendChild(e),c=e}c.appendChild(y),y.appendChild(b),l&&y.appendChild(w)}),""},color:function(e,t,n){return e.getElement().style.backgroundColor=this.sanitizeHTML(e.getValue()),""},buttonTick:function(e,t,n){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'},buttonCross:function(e,t,n){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'},rownum:function(e,t,n){return this.table.rowManager.activeRows.indexOf(e.getRow()._getSelf())+1||""},handle:function(e,t,n){return e.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"},responsiveCollapse:function(e,t,n){var o=document.createElement("div"),a=e.getRow()._row.modules.responsiveLayout;function s(e){var t=a.element;a.open=e,t&&(a.open?(o.classList.add("open"),t.style.display=""):(o.classList.remove("open"),t.style.display="none"))}return o.classList.add("tabulator-responsive-collapse-toggle"),o.innerHTML="<span class='tabulator-responsive-collapse-toggle-open'>+</span><span class='tabulator-responsive-collapse-toggle-close'>-</span>",e.getElement().classList.add("tabulator-row-handle"),o.addEventListener("click",function(e){e.stopImmediatePropagation(),s(!a.open)}),s(a.open),o},rowSelection:function(e,t,n){var o=this,a=document.createElement("input"),s=!1;if(a.type="checkbox",a.setAttribute("aria-label","Select Row"),this.table.modExists("selectRow",!0)){if(a.addEventListener("click",function(e){e.stopPropagation()}),"function"==typeof e.getRow){var r=e.getRow();r instanceof E?(a.addEventListener("change",function(e){"click"===o.table.options.selectableRangeMode&&s?s=!1:r.toggleSelect()}),"click"===this.table.options.selectableRangeMode&&a.addEventListener("click",function(e){s=!0,o.table.modules.selectRow.handleComplexRowClick(r._row,e)}),a.checked=r.isSelected&&r.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(r,a)):a=""}else a.addEventListener("change",function(e){o.table.modules.selectRow.selectedRows.length?o.table.deselectRow():o.table.selectRow(t.rowRange)}),this.table.modules.selectRow.registerHeaderSelectCheckbox(a)}return a}};var er=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).leftColumns=[],o.rightColumns=[],o.leftMargin=0,o.rightMargin=0,o.rightPadding=0,o.initializationMode="left",o.active=!1,o.scrollEndTimer=!1,o.blocked=!0,o.registerColumnOption("frozen"),o}return o(s,[{key:"reset",value:function(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.leftMargin=0,this.rightMargin=0,this.rightMargin=0,this.active=!1,this.table.columnManager.headersElement.style.marginLeft=0,this.table.columnManager.element.style.paddingRight=0}},{key:"initialize",value:function(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("column-add",this.reinitializeColumns.bind(this)),this.subscribe("column-delete",this.reinitializeColumns.bind(this)),this.subscribe("table-redraw",this.layout.bind(this)),this.subscribe("layout-refreshing",this.blockLayout.bind(this)),this.subscribe("layout-refreshed",this.unblockLayout.bind(this))}},{key:"blockLayout",value:function(){this.blocked=!0}},{key:"unblockLayout",value:function(){this.blocked=!1}},{key:"layoutCell",value:function(e){this.layoutElement(e.element,e.column)}},{key:"reinitializeColumns",value:function(){var e=this;this.reset(),this.table.columnManager.columnsByIndex.forEach(function(t){e.initializeColumn(t)})}},{key:"initializeColumn",value:function(e){var t={margin:0,edge:!1};e.isGroup||(this.frozenCheck(e)?(t.position=this.initializationMode,"left"==this.initializationMode?this.leftColumns.push(e):this.rightColumns.unshift(e),this.active=!0,e.modules.frozen=t):this.initializationMode="right")}},{key:"frozenCheck",value:function(e){return e.parent.isGroup&&e.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),e.parent.isGroup?this.frozenCheck(e.parent):e.definition.frozen}},{key:"scrollHorizontal",value:function(){var e,t=this;this.active&&(clearTimeout(this.scrollEndTimer),e=this.table.rowManager.getVisibleRows(),this.calcMargins(!0),this.layoutColumnPosition(),this.layoutCalcRows(),e.forEach(function(e){"row"===e.type&&t.layoutRow(e)}))}},{key:"calcMargins",value:function(e){e||(this.leftMargin=this._calcSpace(this.leftColumns,this.leftColumns.length)+"px",this.rightMargin=this._calcSpace(this.rightColumns,this.rightColumns.length)+"px",this.table.rowManager.tableElement.style.marginRight=this.rightMargin),this.rightPadding=this.table.rowManager.element.clientWidth+this.table.columnManager.scrollLeft}},{key:"layoutCalcRows",value:function(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}},{key:"layoutGroupCalcs",value:function(e){var t=this;e.forEach(function(e){e.calcs.top&&t.layoutRow(e.calcs.top),e.calcs.bottom&&t.layoutRow(e.calcs.bottom),e.groupList&&e.groupList.length&&t.layoutGroupCalcs(e.groupList&&e.groupList)})}},{key:"layoutColumnPosition",value:function(e){var t=this,n=[],o=0,a=0;this.table.columnManager.headersElement.style.marginLeft=this.leftMargin,this.table.columnManager.element.style.paddingRight=this.rightMargin,this.leftColumns.forEach(function(a,s){if(a.modules.frozen.margin=o+t.table.columnManager.scrollLeft+"px",a.visible&&(o+=a.getWidth()),s==t.leftColumns.length-1?a.modules.frozen.edge=!0:a.modules.frozen.edge=!1,a.parent.isGroup){var r=t.getColGroupParentElement(a);n.includes(r)||(t.layoutElement(r,a),n.push(r)),a.modules.frozen.edge&&r.classList.add("tabulator-frozen-"+a.modules.frozen.position)}else t.layoutElement(a.getElement(),a);e&&a.cells.forEach(function(e){t.layoutElement(e.getElement(!0),a)})}),this.rightColumns.forEach(function(n,o){n.visible&&(a+=n.getWidth()),n.modules.frozen.margin=t.rightPadding-a+"px",o==t.rightColumns.length-1?n.modules.frozen.edge=!0:n.modules.frozen.edge=!1,n.parent.isGroup?t.layoutElement(t.getColGroupParentElement(n),n):t.layoutElement(n.getElement(),n),e&&n.cells.forEach(function(e){t.layoutElement(e.getElement(!0),n)})})}},{key:"getColGroupParentElement",value:function(e){return e.parent.isGroup?this.getColGroupParentElement(e.parent):e.getElement()}},{key:"layout",value:function(){var e=this,t=[];this.active&&!this.blocked&&(this.calcMargins(),this.layoutColumnPosition(),t=this.table.rowManager.getVisibleRows(),this.table.rowManager.getDisplayRows().filter(function(e){return!t.includes(e)}).forEach(function(e){e.deinitialize()}),t.forEach(function(t){"row"===t.type&&e.layoutRow(t)}),this.layoutCalcRows())}},{key:"layoutRow",value:function(e){var t=this;e.getElement().style.paddingLeft=this.leftMargin,"fitDataFill"===this.table.options.layout&&this.rightColumns.length&&(this.table.rowManager.getTableElement().style.minWidth="calc(100% - "+this.rightMargin+")"),this.leftColumns.forEach(function(n){var o=e.getCell(n);o&&t.layoutElement(o.getElement(!0),n)}),this.rightColumns.forEach(function(n){var o=e.getCell(n);o&&t.layoutElement(o.getElement(!0),n)})}},{key:"layoutElement",value:function(e,t){t.modules.frozen&&(e.style.position="absolute",e.style.left=t.modules.frozen.margin,e.classList.add("tabulator-frozen"),t.modules.frozen.edge&&e.classList.add("tabulator-frozen-"+t.modules.frozen.position))}},{key:"_calcSpace",value:function(e,t){for(var n=0,o=0;o<t;o++)e[o].visible&&(n+=e[o].getWidth());return n}}]),s}();er.moduleName="frozenColumns";var el=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).topElement=document.createElement("div"),o.rows=[],o.registerComponentFunction("row","freeze",o.freezeRow.bind(l(o))),o.registerComponentFunction("row","unfreeze",o.unfreezeRow.bind(l(o))),o.registerComponentFunction("row","isFrozen",o.isRowFrozen.bind(l(o))),o}return o(s,[{key:"initialize",value:function(){this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),this.table.columnManager.getElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10)}},{key:"isRowFrozen",value:function(e){return this.rows.indexOf(e)>-1}},{key:"isFrozen",value:function(){return!!this.rows.length}},{key:"visibleRows",value:function(e,t){return this.rows.forEach(function(e){t.push(e)}),t}},{key:"getRows",value:function(e){var t=e.slice(0);return this.rows.forEach(function(e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}),t}},{key:"freezeRow",value:function(e){e.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(e.modules.frozen=!0,this.topElement.appendChild(e.getElement()),e.initialize(),e.normalizeHeight(),this.table.rowManager.adjustTableSize(),this.rows.push(e),this.refreshData(!1,"display"),this.styleRows())}},{key:"unfreezeRow",value:function(e){this.rows.indexOf(e),e.modules.frozen?(e.modules.frozen=!1,this.detachRow(e),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}},{key:"detachRow",value:function(e){var t=this.rows.indexOf(e);if(t>-1){var n=e.getElement();n.parentNode&&n.parentNode.removeChild(n),this.rows.splice(t,1)}}},{key:"styleRows",value:function(e){var t=this;this.rows.forEach(function(e,n){t.table.rowManager.styleRow(e,n)})}}]),s}();el.moduleName="frozenRows";var eu=function(){function e(n){return t(this,e),this._group=n,this.type="GroupComponent",new Proxy(this,{get:function(e,t,n){return void 0!==e[t]?e[t]:e._group.groupManager.table.componentFunctionBinder.handle("row",e._group,t)}})}return o(e,[{key:"getKey",value:function(){return this._group.key}},{key:"getField",value:function(){return this._group.field}},{key:"getElement",value:function(){return this._group.element}},{key:"getRows",value:function(){return this._group.getRows(!0)}},{key:"getSubGroups",value:function(){return this._group.getSubGroups(!0)}},{key:"getParentGroup",value:function(){return!!this._group.parent&&this._group.parent.getComponent()}},{key:"isVisible",value:function(){return this._group.visible}},{key:"show",value:function(){this._group.show()}},{key:"hide",value:function(){this._group.hide()}},{key:"toggle",value:function(){this._group.toggleVisibility()}},{key:"_getSelf",value:function(){return this._group}},{key:"getTable",value:function(){return this._group.groupManager.table}}]),e}(),eh=function(){function e(n,o,a,s,r,l,u){t(this,e),this.groupManager=n,this.parent=o,this.key=s,this.level=a,this.field=r,this.hasSubGroups=a<n.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=u,this.rows=[],this.groups=[],this.groupList=[],this.generator=l,this.element=!1,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=u?u.visible:void 0!==n.startOpen[a]?n.startOpen[a]:n.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}return o(e,[{key:"wipe",value:function(){this.groupList.length?this.groupList.forEach(function(e){e.wipe()}):this.rows.forEach(function(e){e.modules&&delete e.modules.group}),this.element=!1,this.arrowElement=!1,this.elementContents=!1}},{key:"createElements",value:function(){var e=document.createElement("div");e.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(e),!1!==this.groupManager.table.options.movableRows&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}},{key:"createValueGroups",value:function(){var e=this,t=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]&&this.groupManager.allowedValues[t].forEach(function(n){e._createGroup(n,t)})}},{key:"addBindings",value:function(){var e=this;this.groupManager.table.options.groupToggleElement&&("arrow"==this.groupManager.table.options.groupToggleElement?this.arrowElement:this.element).addEventListener("click",function(t){t.stopPropagation(),t.stopImmediatePropagation(),e.toggleVisibility()})}},{key:"_createGroup",value:function(t,n){var o=n+"_"+t,a=new e(this.groupManager,this,n,t,this.groupManager.groupIDLookups[n].field,this.groupManager.headerGenerator[n]||this.groupManager.headerGenerator[0],!!this.old&&this.old.groups[o]);this.groups[o]=a,this.groupList.push(a)}},{key:"_addRowToGroup",value:function(e){var t=this.level+1;if(this.hasSubGroups){var n=this.groupManager.groupIDLookups[t].func(e.getData()),o=t+"_"+n;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]?this.groups[o]&&this.groups[o].addRow(e):(this.groups[o]||this._createGroup(n,t),this.groups[o].addRow(e))}}},{key:"_addRow",value:function(e){this.rows.push(e),e.modules.group=this}},{key:"insertRow",value:function(e,t,n){var o=this.conformRowData({});e.updateData(o);var a=this.rows.indexOf(t);a>-1?n?this.rows.splice(a+1,0,e):this.rows.splice(a,0,e):n?this.rows.push(e):this.rows.unshift(e),e.modules.group=this,this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}},{key:"scrollHeader",value:function(e){this.arrowElement&&(this.arrowElement.style.marginLeft=e,this.groupList.forEach(function(t){t.scrollHeader(e)}))}},{key:"getRowIndex",value:function(e){}},{key:"conformRowData",value:function(e){return this.field?e[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(e=this.parent.conformRowData(e)),e}},{key:"removeRow",value:function(e){var t=this.rows.indexOf(e),n=e.getElement();t>-1&&this.rows.splice(t,1),this.groupManager.table.options.groupValues||this.rows.length?(n.parentNode&&n.parentNode.removeChild(n),this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)):(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0))}},{key:"removeGroup",value:function(e){var t,n=e.level+"_"+e.key;this.groups[n]&&(delete this.groups[n],(t=this.groupList.indexOf(e))>-1&&this.groupList.splice(t,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}},{key:"getHeadersAndRows",value:function(e){var t=[];return t.push(this),this._visSet(),this.visible?this.groupList.length?this.groupList.forEach(function(n){t=t.concat(n.getHeadersAndRows(e))}):(!e&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),t.push(this.calcs.top)),t=t.concat(this.rows),!e&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),t.push(this.calcs.bottom))):this.groupList.length||"table"==this.groupManager.table.options.columnCalcs||this.groupManager.table.modExists("columnCalcs")&&(!e&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),t.push(this.calcs.top))),!e&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),t.push(this.calcs.bottom)))),t}},{key:"getData",value:function(e,t){var n=[];return this._visSet(),(!e||e&&this.visible)&&this.rows.forEach(function(e){n.push(e.getData(t||"data"))}),n}},{key:"getRowCount",value:function(){var e=0;return this.groupList.length?this.groupList.forEach(function(t){e+=t.getRowCount()}):e=this.rows.length,e}},{key:"toggleVisibility",value:function(){this.visible?this.hide():this.show()}},{key:"hide",value:function(){this.visible=!1,"classic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination?this.groupManager.updateGroupRows(!0):(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach(function(e){e.getHeadersAndRows().forEach(function(e){e.detachElement()})}):this.rows.forEach(function(e){var t=e.getElement();t.parentNode.removeChild(t)}),this.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(),this.groupManager.getDisplayIndex()),this.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth()),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}},{key:"show",value:function(){if(this.visible=!0,"classic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination)this.groupManager.updateGroupRows(!0);else{this.element.classList.add("tabulator-group-visible");var e=this.generateElement();this.groupList.length?this.groupList.forEach(function(t){t.getHeadersAndRows().forEach(function(t){var n=t.getElement();e.parentNode.insertBefore(n,e.nextSibling),t.initialize(),e=n})}):this.rows.forEach(function(t){var n=t.getElement();e.parentNode.insertBefore(n,e.nextSibling),t.initialize(),e=n}),this.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(),this.groupManager.getDisplayIndex()),this.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth()}this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}},{key:"_visSet",value:function(){var e=[];"function"==typeof this.visible&&(this.rows.forEach(function(t){e.push(t.getData())}),this.visible=this.visible(this.key,this.getRowCount(),e,this.getComponent()))}},{key:"getRowGroup",value:function(e){var t=!1;return this.groupList.length?this.groupList.forEach(function(n){var o=n.getRowGroup(e);o&&(t=o)}):this.rows.find(function(t){return t===e})&&(t=this),t}},{key:"getSubGroups",value:function(e){var t=[];return this.groupList.forEach(function(n){t.push(e?n.getComponent():n)}),t}},{key:"getRows",value:function(e){var t=[];return this.rows.forEach(function(n){t.push(e?n.getComponent():n)}),t}},{key:"generateGroupHeaderContents",value:function(){var e=[];for(this.rows.forEach(function(t){e.push(t.getData())}),this.elementContents=this.generator(this.key,this.getRowCount(),e,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);"string"==typeof this.elementContents?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}},{key:"getPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.unshift(this.key),this.parent&&this.parent.getPath(e),e}},{key:"getElement",value:function(){return this.elementContents?this.element:this.generateElement()}},{key:"generateElement",value:function(){this.addBindings=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var e=0;e<this.element.childNodes.length;++e)this.element.childNodes[e].parentNode.removeChild(this.element.childNodes[e]);return this.generateGroupHeaderContents(),this.element}},{key:"detachElement",value:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}},{key:"normalizeHeight",value:function(){this.setHeight(this.element.clientHeight)}},{key:"initialize",value:function(e){this.initialized&&!e||(this.normalizeHeight(),this.initialized=!0)}},{key:"reinitialize",value:function(){this.initialized=!1,this.height=0,v.elVisible(this.element)&&this.initialize(!0)}},{key:"setHeight",value:function(e){this.height!=e&&(this.height=e,this.outerHeight=this.element.offsetHeight)}},{key:"getHeight",value:function(){return this.outerHeight}},{key:"getGroup",value:function(){return this}},{key:"reinitializeHeight",value:function(){}},{key:"calcHeight",value:function(){}},{key:"setCellHeight",value:function(){}},{key:"clearCellHeight",value:function(){}},{key:"deinitializeHeight",value:function(){}},{key:"getComponent",value:function(){return this.component||(this.component=new eu(this)),this.component}}]),e}(),ec=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).groupIDLookups=!1,o.startOpen=[function(){return!1}],o.headerGenerator=[function(){return""}],o.groupList=[],o.allowedValues=!1,o.groups={},o.displayIndex=0,o.displayHandler=o.getRows.bind(l(o)),o.registerTableOption("groupBy",!1),o.registerTableOption("groupStartOpen",!0),o.registerTableOption("groupValues",!1),o.registerTableOption("groupUpdateOnCellEdit",!1),o.registerTableOption("groupHeader",!1),o.registerTableOption("groupHeaderPrint",null),o.registerTableOption("groupHeaderClipboard",null),o.registerTableOption("groupHeaderHtmlOutput",null),o.registerTableOption("groupHeaderDownload",null),o.registerTableOption("groupToggleElement","arrow"),o.registerTableOption("groupClosedShowCalcs",!1),o.registerTableFunction("setGroupBy",o.setGroupBy.bind(l(o))),o.registerTableFunction("setGroupValues",o.setGroupValues.bind(l(o))),o.registerTableFunction("setGroupStartOpen",o.setGroupStartOpen.bind(l(o))),o.registerTableFunction("setGroupHeader",o.setGroupHeader.bind(l(o))),o.registerTableFunction("getGroups",o.userGetGroups.bind(l(o))),o.registerTableFunction("getGroupedData",o.userGetGroupedData.bind(l(o))),o.registerComponentFunction("row","getGroup",o.rowGetGroup.bind(l(o))),o}return o(s,[{key:"initialize",value:function(){this.table.options.groupBy&&(this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("table-built",this.configureGroupSetup.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}},{key:"configureGroupSetup",value:function(){var e=this;if(this.table.options.groupBy){var t=this.table.options.groupBy,n=this.table.options.groupStartOpen,o=this.table.options.groupHeader;(this.allowedValues=this.table.options.groupValues,Array.isArray(t)&&Array.isArray(o)&&t.length>o.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",function(t,n){e.headerGenerator[0]=function(e,o,a){return(void 0===e?"":e)+"<span>("+o+" "+(1===o?t:n.groups.items)+")</span>"}}),this.groupIDLookups=[],Array.isArray(t)||t)?this.table.modExists("columnCalcs")&&"table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs&&this.table.modules.columnCalcs.removeCalcs():this.table.modExists("columnCalcs")&&"group"!=this.table.options.columnCalcs&&this.table.columnManager.getRealColumns().forEach(function(t){t.definition.topCalc&&e.table.modules.columnCalcs.initializeTopRow(),t.definition.bottomCalc&&e.table.modules.columnCalcs.initializeBottomRow()}),Array.isArray(t)||(t=[t]),t.forEach(function(t,n){var o,a;o="function"==typeof t?t:(a=e.table.columnManager.getColumnByField(t))?function(e){return a.getFieldValue(e)}:function(e){return e[t]},e.groupIDLookups.push({field:"function"!=typeof t&&t,func:o,values:!!e.allowedValues&&e.allowedValues[n]})}),n&&(Array.isArray(n)||(n=[n]),n.forEach(function(e){}),this.startOpen=n),o&&(this.headerGenerator=Array.isArray(o)?o:[o])}}},{key:"rowSample",value:function(e,t){var n=this.getGroups(!1)[0];return t.push(n.getRows(!1)[0]),t}},{key:"virtualRenderFill",value:function(){var e=this.table.rowManager.tableElement,t=this.table.rowManager.getVisibleRows();t=t.filter(function(e){return"group"!==e.type}),e.style.minWidth=t.length?"":this.table.columnManager.getWidth()+"px"}},{key:"rowAddingIndex",value:function(e,t,n){this.assignRowToGroup(e);var o=e.modules.group.rows;return o.length>1&&(!t||t&&-1==o.indexOf(t)?n?o[0]!==e&&(t=o[0],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!n)):o[o.length-1]!==e&&(t=o[o.length-1],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!n)):this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!n)),t}},{key:"trackChanges",value:function(){this.dispatch("group-changed")}},{key:"setGroupBy",value:function(e){this.table.options.groupBy=e,this.initialized?this.configureGroupSetup():this.initialize(),this.refreshData(),this.trackChanges()}},{key:"setGroupValues",value:function(e){this.table.options.groupValues=e,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}},{key:"setGroupStartOpen",value:function(e){this.table.options.groupStartOpen=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}},{key:"setGroupHeader",value:function(e){this.table.options.groupHeader=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}},{key:"userGetGroups",value:function(e){return this.getGroups(!0)}},{key:"userGetGroupedData",value:function(){return this.table.options.groupBy?this.getGroupedData():this.getData()}},{key:"rowGetGroup",value:function(e){return!!e.modules.group&&e.modules.group.getComponent()}},{key:"rowMoving",value:function(e,t,n){!n&&t instanceof eh&&(t=this.table.rowManager.prevDisplayRow(e)||t);var o=t instanceof eh?t:t.modules.group,a=e instanceof eh?e:e.modules.group;o===a?this.table.rowManager.moveRowInArray(o.rows,e,t,n):(a&&a.removeRow(e),o.insertRow(e,t,n))}},{key:"rowDeleting",value:function(e){e.modules.group&&e.modules.group.removeRow(e)}},{key:"rowsUpdated",value:function(e){this.updateGroupRows(!0)}},{key:"cellUpdated",value:function(e){this.reassignRowToGroup(e.row)}},{key:"setDisplayIndex",value:function(e){this.displayIndex=e}},{key:"getDisplayIndex",value:function(){return this.displayIndex}},{key:"getRows",value:function(e){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(e),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):e.slice(0)}},{key:"getGroups",value:function(e){var t=[];return this.groupList.forEach(function(n){t.push(e?n.getComponent():n)}),t}},{key:"getChildGroups",value:function(e){var t=this,n=[];return e||(e=this),e.groupList.forEach(function(e){e.groupList.length?n=n.concat(t.getChildGroups(e)):n.push(e)}),n}},{key:"wipe",value:function(){this.groupList.forEach(function(e){e.wipe()})}},{key:"pullGroupListData",value:function(e){var t=this,n=[];return e.forEach(function(e){var o={level:0,rowCount:0,headerContent:""},a=[];e.hasSubGroups?(a=t.pullGroupListData(e.groupList),o.level=e.level,o.rowCount=a.length-e.groupList.length,o.headerContent=e.generator(e.key,o.rowCount,e.rows,e),n.push(o),n=n.concat(a)):(o.level=e.level,o.headerContent=e.generator(e.key,e.rows.length,e.rows,e),o.rowCount=e.getRows().length,n.push(o),e.getRows().forEach(function(e){n.push(e.getData("data"))}))}),n}},{key:"getGroupedData",value:function(){return this.pullGroupListData(this.groupList)}},{key:"getRowGroup",value:function(e){var t=!1;return this.groupList.forEach(function(n){var o=n.getRowGroup(e);o&&(t=o)}),t}},{key:"countGroups",value:function(){return this.groupList.length}},{key:"generateGroups",value:function(e){var t=this,n=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach(function(e){t.createGroup(e,0,n)}),e.forEach(function(e){t.assignRowToExistingGroup(e,n)})):e.forEach(function(e){t.assignRowToGroup(e,n)})}},{key:"createGroup",value:function(e,t,n){var o,a=t+"_"+e;n=n||[],o=new eh(this,!1,t,e,this.groupIDLookups[0].field,this.headerGenerator[0],n[a]),this.groups[a]=o,this.groupList.push(o)}},{key:"assignRowToExistingGroup",value:function(e,t){var n="0_"+this.groupIDLookups[0].func(e.getData());this.groups[n]&&this.groups[n].addRow(e)}},{key:"assignRowToGroup",value:function(e,t){var n=this.groupIDLookups[0].func(e.getData()),o=!this.groups["0_"+n];return o&&this.createGroup(n,0,t),this.groups["0_"+n].addRow(e),!o}},{key:"reassignRowToGroup",value:function(e){if("row"===e.type){var t=e.modules.group,n=t.getPath(),o=this.getExpectedPath(e);n.length==o.length&&n.every(function(e,t){return e===o[t]})||(t.removeRow(e),this.assignRowToGroup(e,this.groups),this.refreshData(!0))}}},{key:"getExpectedPath",value:function(e){var t=[],n=e.getData();return this.groupIDLookups.forEach(function(e){t.push(e.func(n))}),t}},{key:"updateGroupRows",value:function(e){var t=[];return this.groupList.forEach(function(e){t=t.concat(e.getHeadersAndRows())}),e&&this.refreshData(!0,this.displayHandler),t}},{key:"scrollHeaders",value:function(e){"virtual"===this.table.options.renderHorizontal&&(e-=this.table.columnManager.renderer.vDomPadLeft),e+="px",this.groupList.forEach(function(t){t.scrollHeader(e)})}},{key:"removeGroup",value:function(e){var t,n=e.level+"_"+e.key;this.groups[n]&&(delete this.groups[n],(t=this.groupList.indexOf(e))>-1&&this.groupList.splice(t,1))}}]),s}();ec.moduleName="groupRows";var ed=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).history=[],o.index=-1,o.registerTableOption("history",!1),o}return o(s,[{key:"initialize",value:function(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}},{key:"rowMoved",value:function(e,t,n){this.action("rowMove",e,{posFrom:this.table.rowManager.getRowPosition(e),posTo:this.table.rowManager.getRowPosition(t),to:t,after:n})}},{key:"rowAdded",value:function(e,t,n,o){this.action("rowAdd",e,{data:t,pos:n,index:o})}},{key:"rowDeleted",value:function(e){var t,n;this.table.options.groupBy?(t=(n=e.getComponent().getGroup().rows).indexOf(e))&&(t=n[t-1]):(t=e.table.rowManager.getRowIndex(e))&&(t=e.table.rowManager.rows[t-1]),this.action("rowDelete",e,{data:e.getData(),pos:!t,index:t})}},{key:"cellUpdated",value:function(e){this.action("cellEdit",e,{oldValue:e.oldValue,newValue:e.value})}},{key:"clear",value:function(){this.history=[],this.index=-1}},{key:"action",value:function(e,t,n){this.history=this.history.slice(0,this.index+1),this.history.push({type:e,component:t,data:n}),this.index++}},{key:"getHistoryUndoSize",value:function(){return this.index+1}},{key:"getHistoryRedoSize",value:function(){return this.history.length-(this.index+1)}},{key:"clearComponentHistory",value:function(e){var t=this.history.findIndex(function(t){return t.component===e});t>-1&&(this.history.splice(t,1),t<=this.index&&this.index--,this.clearComponentHistory(e))}},{key:"undo",value:function(){if(this.index>-1){var e=this.history[this.index];return s.undoers[e.type].call(this,e),this.index--,this.dispatchExternal("historyUndo",e.type,e.component.getComponent(),e.data),!0}return console.warn("History Undo Error - No more history to undo"),!1}},{key:"redo",value:function(){if(this.history.length-1>this.index){this.index++;var e=this.history[this.index];return s.redoers[e.type].call(this,e),this.dispatchExternal("historyRedo",e.type,e.component.getComponent(),e.data),!0}return console.warn("History Redo Error - No more history to redo"),!1}},{key:"_rebindRow",value:function(e,t){this.history.forEach(function(n){if(n.component instanceof $)n.component===e&&(n.component=t);else if(n.component instanceof f&&n.component.row===e){var o=n.component.column.getField();o&&(n.component=t.getCell(o))}})}}]),s}();ed.moduleName="history",ed.undoers={cellEdit:function(e){e.component.setValueProcessData(e.data.oldValue),e.component.cellRendered()},rowAdd:function(e){e.component.deleteActual()},rowDelete:function(e){var t=this.table.rowManager.addRowActual(e.data.data,e.data.pos,e.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(e.component,t)},rowMove:function(e){this.table.rowManager.moveRowActual(e.component,this.table.rowManager.rows[e.data.posFrom],!e.data.after),this.table.rowManager.redraw()}},ed.redoers={cellEdit:function(e){e.component.setValueProcessData(e.data.newValue),e.component.cellRendered()},rowAdd:function(e){var t=this.table.rowManager.addRowActual(e.data.data,e.data.pos,e.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(e.component,t)},rowDelete:function(e){e.component.deleteActual()},rowMove:function(e){this.table.rowManager.moveRowActual(e.component,this.table.rowManager.rows[e.data.posTo],e.data.after),this.table.rowManager.redraw()}};var ep=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).fieldIndex=[],n.hasIndex=!1,n}return o(r,[{key:"initialize",value:function(){this.tableElementCheck()}},{key:"tableElementCheck",value:function(){this.table.originalElement&&"TABLE"===this.table.originalElement.tagName&&(this.table.originalElement.childNodes.length?this.parseTable():console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."))}},{key:"parseTable",value:function(){var e=this.table.originalElement,t=this.table.options,n=(t.columns,e.getElementsByTagName("th")),o=e.getElementsByTagName("tbody")[0],a=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),o=o?o.getElementsByTagName("tr"):[],this._extractOptions(e,t),n.length?this._extractHeaders(n,o):this._generateBlankHeaders(n,o);for(var s=0;s<o.length;s++){var r=o[s].getElementsByTagName("td"),l={};this.hasIndex||(l[t.index]=s);for(var u=0;u<r.length;u++){var h=r[u];void 0!==this.fieldIndex[u]&&(l[this.fieldIndex[u]]=h.innerHTML)}a.push(l)}t.data=a,this.dispatchExternal("htmlImported")}},{key:"_extractOptions",value:function(t,n,o){var a=t.attributes,s=o?Object.keys(o):Object.keys(n),r={};for(var l in s.forEach(function(e){r[e.toLowerCase()]=e}),a){var u,h=a[l];h&&"object"==e(h)&&h.name&&0===h.name.indexOf("tabulator-")&&void 0!==r[u=h.name.replace("tabulator-","")]&&(n[r[u]]=this._attribValue(h.value))}}},{key:"_attribValue",value:function(e){return"true"===e||"false"!==e&&e}},{key:"_findCol",value:function(e){return this.table.options.columns.find(function(t){return t.title===e})||!1}},{key:"_extractHeaders",value:function(e,t){for(var n=0;n<e.length;n++){var o,a=e[n],s=!1,r=this._findCol(a.textContent);r?s=!0:r={title:a.textContent.trim()},r.field||(r.field=a.textContent.trim().toLowerCase().replace(" ","_")),(o=a.getAttribute("width"))&&!r.width&&(r.width=o),this._extractOptions(a,r,this.table.columnManager.optionsList.registeredDefaults),this.fieldIndex[n]=r.field,r.field==this.table.options.index&&(this.hasIndex=!0),s||this.table.options.columns.push(r)}}},{key:"_generateBlankHeaders",value:function(e,t){for(var n=0;n<e.length;n++){var o=e[n],a={title:"",field:"col"+n};this.fieldIndex[n]=a.field;var s=o.getAttribute("width");s&&(a.width=s),this.table.options.columns.push(a)}}}]),r}();ep.moduleName="htmlTableImport";var em=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).registerTableOption("importFormat"),o.registerTableOption("importReader","text"),o}return o(s,[{key:"initialize",value:function(){this.registerTableFunction("import",this.importFromFile.bind(this)),this.table.options.importFormat&&(this.subscribe("data-loading",this.loadDataCheck.bind(this),10),this.subscribe("data-load",this.loadData.bind(this),10))}},{key:"loadDataCheck",value:function(e){return"string"==typeof e}},{key:"loadData",value:function(e,t,n,o,a){return this.importData(this.lookupImporter(),e).then(this.structureData.bind(this)).catch(function(e){return console.error("Import Error:",e||"Unable to import data"),Promise.reject(e)})}},{key:"lookupImporter",value:function(e){var t;return e||(e=this.table.options.importFormat),(t="string"==typeof e?s.importers[e]:e)||console.error("Import Error - Importer not found:",e),t}},{key:"importFromFile",value:function(e,t){var n=this.lookupImporter(e);if(n)return this.pickFile(t).then(this.importData.bind(this,n)).then(this.structureData.bind(this)).then(this.setData.bind(this)).catch(function(e){return console.error("Import Error:",e||"Unable to import file"),Promise.reject(e)})}},{key:"pickFile",value:function(e){var t=this;return new Promise(function(n,o){var a=document.createElement("input");a.type="file",a.accept=e,a.addEventListener("change",function(e){var s=a.files[0],r=new FileReader;switch(t.table.options.importReader){case"buffer":r.readAsArrayBuffer(s);break;case"binary":r.readAsBinaryString(s);break;case"url":r.readAsDataURL(s);break;default:r.readAsText(s)}r.onload=function(e){n(r.result)},r.onerror=function(e){console.warn("File Load Error - Unable to read file"),o()}}),a.click()})}},{key:"importData",value:function(e,t){var n=e.call(this.table,t);return n instanceof Promise?n:n?Promise.resolve(n):Promise.reject()}},{key:"structureData",value:function(e){return Array.isArray(e)&&e.length&&Array.isArray(e[0])?this.table.options.autoColumns?this.structureArrayToObject(e):this.structureArrayToColumns(e):e}},{key:"structureArrayToObject",value:function(e){var t=e.shift();return e.map(function(e){var n={};return t.forEach(function(t,o){n[t]=e[o]}),n})}},{key:"structureArrayToColumns",value:function(e){var t=[],n=this.table.getColumns();return n[0]&&e[0][0]&&n[0].getDefinition().title===e[0][0]&&e.shift(),e.forEach(function(e){var o={};e.forEach(function(e,t){var a=n[t];a&&(o[a.getField()]=e)}),t.push(o)}),t}},{key:"setData",value:function(e){return this.table.setData(e)}}]),s}();em.moduleName="import",em.importers={csv:function(e){for(var t=[],n=0,o=0,a=!1,s=0;s<e.length;s++){var r=e[s],l=e[s+1];t[n]||(t[n]=[]),t[n][o]||(t[n][o]=""),'"'==r&&a&&'"'==l?(t[n][o]+=r,s++):'"'!=r?","!=r||a?"\r"!=r||"\n"!=l||a?"\r"!=r&&"\n"!=r||a?t[n][o]+=r:(o=0,n++):(o=0,n++,s++):o++:a=!a}return t},json:function(e){try{return JSON.parse(e)}catch(t){return console.warn("JSON Import Error - File contents is invalid JSON",t),Promise.reject()}}};var ef=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},o.subscribers={},o.touchSubscribers={},o.columnSubscribers={},o.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null},group:{tap:null,tapDbl:null,tapHold:null}},o.registerColumnOption("headerClick"),o.registerColumnOption("headerDblClick"),o.registerColumnOption("headerContext"),o.registerColumnOption("headerMouseEnter"),o.registerColumnOption("headerMouseLeave"),o.registerColumnOption("headerMouseOver"),o.registerColumnOption("headerMouseOut"),o.registerColumnOption("headerMouseMove"),o.registerColumnOption("headerTap"),o.registerColumnOption("headerDblTap"),o.registerColumnOption("headerTapHold"),o.registerColumnOption("cellClick"),o.registerColumnOption("cellDblClick"),o.registerColumnOption("cellContext"),o.registerColumnOption("cellMouseEnter"),o.registerColumnOption("cellMouseLeave"),o.registerColumnOption("cellMouseOver"),o.registerColumnOption("cellMouseOut"),o.registerColumnOption("cellMouseMove"),o.registerColumnOption("cellTap"),o.registerColumnOption("cellDblTap"),o.registerColumnOption("cellTapHold"),o}return o(s,[{key:"initialize",value:function(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this))}},{key:"cellContentsSelectionFixer",value:function(e,t){if(!this.table.modExists("edit")||this.table.modules.edit.currentCell!==this){e.preventDefault();try{if(document.selection)(n=document.body.createTextRange()).moveToElementText(this.element),n.select();else if(window.getSelection){var n;(n=document.createRange()).selectNode(this.element),window.getSelection().removeAllRanges(),window.getSelection().addRange(n)}}catch(o){}}}},{key:"initializeExternalEvents",value:function(){for(var e in this.eventMap)this.subscriptionChangeExternal(e,this.subscriptionChanged.bind(this,e))}},{key:"subscriptionChanged",value:function(e,t){t?this.subscribers[e]||(this.eventMap[e].includes("-")?(this.subscribers[e]=this.handle.bind(this,e),this.subscribe(this.eventMap[e],this.subscribers[e])):this.subscribeTouchEvents(e)):this.eventMap[e].includes("-")?!this.subscribers[e]||this.columnSubscribers[e]||this.subscribedExternal(e)||(this.unsubscribe(this.eventMap[e],this.subscribers[e]),delete this.subscribers[e]):this.unsubscribeTouchEvents(e)}},{key:"subscribeTouchEvents",value:function(e){var t=this.eventMap[e];this.touchSubscribers[t+"-touchstart"]||(this.touchSubscribers[t+"-touchstart"]=this.handleTouch.bind(this,t,"start"),this.touchSubscribers[t+"-touchend"]=this.handleTouch.bind(this,t,"end"),this.subscribe(t+"-touchstart",this.touchSubscribers[t+"-touchstart"]),this.subscribe(t+"-touchend",this.touchSubscribers[t+"-touchend"])),this.subscribers[e]=!0}},{key:"unsubscribeTouchEvents",value:function(e){var t=!0,n=this.eventMap[e];if(this.subscribers[e]&&!this.subscribedExternal(e)){for(var o in delete this.subscribers[e],this.eventMap)this.eventMap[o]===n&&this.subscribers[o]&&(t=!1);t&&(this.unsubscribe(n+"-touchstart",this.touchSubscribers[n+"-touchstart"]),this.unsubscribe(n+"-touchend",this.touchSubscribers[n+"-touchend"]),delete this.touchSubscribers[n+"-touchstart"],delete this.touchSubscribers[n+"-touchend"])}}},{key:"initializeColumn",value:function(e){var t=e.definition;for(var n in this.eventMap)t[n]&&(this.subscriptionChanged(n,!0),this.columnSubscribers[n]||(this.columnSubscribers[n]=[]),this.columnSubscribers[n].push(e))}},{key:"handle",value:function(e,t,n){this.dispatchEvent(e,t,n)}},{key:"handleTouch",value:function(e,t,n,o){var a=this,s=this.touchWatchers[e];switch("column"===e&&(e="header"),t){case"start":s.tap=!0,clearTimeout(s.tapHold),s.tapHold=setTimeout(function(){clearTimeout(s.tapHold),s.tapHold=null,s.tap=null,clearTimeout(s.tapDbl),s.tapDbl=null,a.dispatchEvent(e+"TapHold",n,o)},1e3);break;case"end":s.tap&&(s.tap=null,this.dispatchEvent(e+"Tap",n,o)),s.tapDbl?(clearTimeout(s.tapDbl),s.tapDbl=null,this.dispatchEvent(e+"DblTap",n,o)):s.tapDbl=setTimeout(function(){clearTimeout(s.tapDbl),s.tapDbl=null},300),clearTimeout(s.tapHold),s.tapHold=null}}},{key:"dispatchEvent",value:function(e,t,n){var o,a=n.getComponent();this.columnSubscribers[e]&&(n instanceof f?o=n.column.definition[e]:n instanceof g&&(o=n.definition[e]),o&&o(t,a)),this.dispatchExternal(e,t,a)}}]),s}();ef.moduleName="interaction";var eg=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).watchKeys=null,n.pressedKeys=null,n.keyupBinding=!1,n.keydownBinding=!1,n.registerTableOption("keybindings",{}),n.registerTableOption("tabEndNewRow",!1),n}return o(r,[{key:"initialize",value:function(){var e=this.table.options.keybindings,t={};this.watchKeys={},this.pressedKeys=[],!1!==e&&(Object.assign(t,r.bindings),Object.assign(t,e),this.mapBindings(t),this.bindEvents()),this.subscribe("table-destroy",this.clearBindings.bind(this))}},{key:"mapBindings",value:function(t){var n=this,o=function(o){r.actions[o]?t[o]&&("object"!==e(t[o])&&(t[o]=[t[o]]),t[o].forEach(function(e){(Array.isArray(e)?e:[e]).forEach(function(e){n.mapBinding(o,e)})})):console.warn("Key Binding Error - no such action:",o)};for(var a in t)o(a)}},{key:"mapBinding",value:function(e,t){var n=this,o={action:r.actions[e],keys:[],ctrl:!1,shift:!1,meta:!1};t.toString().toLowerCase().split(" ").join("").split("+").forEach(function(e){switch(e){case"ctrl":o.ctrl=!0;break;case"shift":o.shift=!0;break;case"meta":o.meta=!0;break;default:e=isNaN(e)?e.toUpperCase().charCodeAt(0):parseInt(e),o.keys.push(e),n.watchKeys[e]||(n.watchKeys[e]=[]),n.watchKeys[e].push(o)}})}},{key:"bindEvents",value:function(){var e=this;this.keyupBinding=function(t){var n=t.keyCode,o=e.watchKeys[n];o&&(e.pressedKeys.push(n),o.forEach(function(n){e.checkBinding(t,n)}))},this.keydownBinding=function(t){var n=t.keyCode;if(e.watchKeys[n]){var o=e.pressedKeys.indexOf(n);o>-1&&e.pressedKeys.splice(o,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}},{key:"clearBindings",value:function(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}},{key:"checkBinding",value:function(e,t){var n=this,o=!0;return e.ctrlKey==t.ctrl&&e.shiftKey==t.shift&&e.metaKey==t.meta&&(t.keys.forEach(function(e){-1==n.pressedKeys.indexOf(e)&&(o=!1)}),o&&t.action.call(this,e),!0)}}]),r}();eg.moduleName="keybindings",eg.bindings={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35,undo:["ctrl + 90","meta + 90"],redo:["ctrl + 89","meta + 89"],copyToClipboard:["ctrl + 67","meta + 89"]},eg.actions={keyBlock:function(e){e.stopPropagation(),e.preventDefault()},scrollPageUp:function(e){var t=this.table.rowManager,n=t.scrollTop-t.element.clientHeight;t.element.scrollHeight,e.preventDefault(),t.displayRowsCount&&(n>=0?t.element.scrollTop=n:t.scrollToRow(t.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(e){var t=this.table.rowManager,n=t.scrollTop+t.element.clientHeight,o=t.element.scrollHeight;e.preventDefault(),t.displayRowsCount&&(n<=o?t.element.scrollTop=n:t.scrollToRow(t.getDisplayRows()[t.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(e){var t=this.table.rowManager;e.preventDefault(),t.displayRowsCount&&t.scrollToRow(t.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(e){var t=this.table.rowManager;e.preventDefault(),t.displayRowsCount&&t.scrollToRow(t.getDisplayRows()[t.displayRowsCount-1]),this.table.element.focus()},navPrev:function(e){this.dispatch("keybinding-nav-prev",e)},navNext:function(e){this.dispatch("keybinding-nav-next",e)},navLeft:function(e){this.dispatch("keybinding-nav-left",e)},navRight:function(e){this.dispatch("keybinding-nav-right",e)},navUp:function(e){this.dispatch("keybinding-nav-up",e)},navDown:function(e){this.dispatch("keybinding-nav-down",e)},undo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.undo()))},redo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.redo()))},copyToClipboard:function(e){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}};var ev=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).menuContainer=null,o.nestedMenuBlock=!1,o.currentComponent=null,o.rootPopup=null,o.columnSubscribers={},o.registerTableOption("menuContainer",void 0),o.registerTableOption("rowContextMenu",!1),o.registerTableOption("rowClickMenu",!1),o.registerTableOption("groupContextMenu",!1),o.registerTableOption("groupClickMenu",!1),o.registerColumnOption("headerContextMenu"),o.registerColumnOption("headerClickMenu"),o.registerColumnOption("headerMenu"),o.registerColumnOption("headerMenuIcon"),o.registerColumnOption("contextMenu"),o.registerColumnOption("clickMenu"),o}return o(s,[{key:"initialize",value:function(){this.deprecationCheck(),this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}},{key:"deprecationCheck",value:function(){void 0!==this.table.options.menuContainer&&(console.warn("Use of the menuContainer option is now deprecated. Please use the popupContainer option instead"),this.table.options.popupContainer=this.table.options.menuContainer)}},{key:"initializeRowWatchers",value:function(){this.table.options.rowContextMenu&&(this.subscribe("row-contextmenu",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu)),this.table.on("rowTapHold",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu))),this.table.options.rowClickMenu&&this.subscribe("row-click",this.loadMenuEvent.bind(this,this.table.options.rowClickMenu))}},{key:"initializeGroupWatchers",value:function(){this.table.options.groupContextMenu&&(this.subscribe("group-contextmenu",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu)),this.table.on("groupTapHold",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu))),this.table.options.groupClickMenu&&this.subscribe("group-click",this.loadMenuEvent.bind(this,this.table.options.groupClickMenu))}},{key:"initializeColumn",value:function(e){var t=e.definition;t.headerContextMenu&&!this.columnSubscribers.headerContextMenu&&(this.columnSubscribers.headerContextMenu=this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextMenu),this.table.on("headerTapHold",this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"))),t.headerClickMenu&&!this.columnSubscribers.headerClickMenu&&(this.columnSubscribers.headerClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerClickMenu"),this.subscribe("column-click",this.columnSubscribers.headerClickMenu)),t.headerMenu&&this.initializeColumnHeaderMenu(e),t.contextMenu&&!this.columnSubscribers.contextMenu&&(this.columnSubscribers.contextMenu=this.loadMenuTableCellEvent.bind(this,"contextMenu"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextMenu),this.table.on("cellTapHold",this.loadMenuTableCellEvent.bind(this,"contextMenu"))),t.clickMenu&&!this.columnSubscribers.clickMenu&&(this.columnSubscribers.clickMenu=this.loadMenuTableCellEvent.bind(this,"clickMenu"),this.subscribe("cell-click",this.columnSubscribers.clickMenu))}},{key:"initializeColumnHeaderMenu",value:function(e){var t,n=this,o=e.definition.headerMenuIcon;(t=document.createElement("span")).classList.add("tabulator-header-popup-button"),o?("function"==typeof o&&(o=o(e.getComponent())),o instanceof HTMLElement?t.appendChild(o):t.innerHTML=o):t.innerHTML="&vellip;",t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n.loadMenuEvent(e.definition.headerMenu,t,e)}),e.titleElement.insertBefore(t,e.titleElement.firstChild)}},{key:"loadMenuTableCellEvent",value:function(e,t,n){n._cell&&(n=n._cell),n.column.definition[e]&&this.loadMenuEvent(n.column.definition[e],t,n)}},{key:"loadMenuTableColumnEvent",value:function(e,t,n){n._column&&(n=n._column),n.definition[e]&&this.loadMenuEvent(n.definition[e],t,n)}},{key:"loadMenuEvent",value:function(e,t,n){n._group?n=n._group:n._row&&(n=n._row),e="function"==typeof e?e.call(this.table,t,n.getComponent()):e,this.loadMenu(t,n,e)}},{key:"loadMenu",value:function(e,t,n,o,a){var s,r=this,l=!(e instanceof MouseEvent),u=document.createElement("div");if(u.classList.add("tabulator-menu"),l||e.preventDefault(),n&&n.length){if(o)s=a.child(u);else{if(this.nestedMenuBlock){if(this.rootPopup)return}else this.nestedMenuBlock=setTimeout(function(){r.nestedMenuBlock=!1},100);this.rootPopup&&this.rootPopup.hide(),this.rootPopup=s=this.popup(u)}n.forEach(function(e){var n=document.createElement("div"),o=e.label,a=e.disabled;e.separator?n.classList.add("tabulator-menu-separator"):(n.classList.add("tabulator-menu-item"),"function"==typeof o&&(o=o.call(r.table,t.getComponent())),o instanceof Node?n.appendChild(o):n.innerHTML=o,"function"==typeof a&&(a=a.call(r.table,t.getComponent())),a?(n.classList.add("tabulator-menu-item-disabled"),n.addEventListener("click",function(e){e.stopPropagation()})):e.menu&&e.menu.length?n.addEventListener("click",function(o){o.stopPropagation(),r.loadMenu(o,t,e.menu,n,s)}):e.action&&n.addEventListener("click",function(n){e.action(n,t.getComponent())}),e.menu&&e.menu.length&&n.classList.add("tabulator-menu-item-submenu")),u.appendChild(n)}),u.addEventListener("click",function(e){r.rootPopup.hide()}),s.show(o||e),s===this.rootPopup&&(this.rootPopup.hideOnBlur(function(){r.rootPopup=null,r.currentComponent&&(r.dispatchExternal("menuClosed",r.currentComponent.getComponent()),r.currentComponent=null)}),this.currentComponent=t,this.dispatchExternal("menuOpened",t.getComponent()))}}}]),s}();ev.moduleName="menu";var eb=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).placeholderElement=o.createPlaceholderElement(),o.hoverElement=!1,o.checkTimeout=!1,o.checkPeriod=250,o.moving=!1,o.toCol=!1,o.toColAfter=!1,o.startX=0,o.autoScrollMargin=40,o.autoScrollStep=5,o.autoScrollTimeout=!1,o.touchMove=!1,o.moveHover=o.moveHover.bind(l(o)),o.endMove=o.endMove.bind(l(o)),o.registerTableOption("movableColumns",!1),o}return o(s,[{key:"createPlaceholderElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-col"),e.classList.add("tabulator-col-placeholder"),e}},{key:"initialize",value:function(){this.table.options.movableColumns&&this.subscribe("column-init",this.initializeColumn.bind(this))}},{key:"initializeColumn",value:function(e){var t,n=this,o={};e.modules.frozen||(t=e.getElement(),o.mousemove=(function(o){e.parent===n.moving.parent&&((n.touchMove?o.touches[0].pageX:o.pageX)-v.elOffset(t).left+n.table.columnManager.element.scrollLeft>e.getWidth()/2?n.toCol===e&&n.toColAfter||(t.parentNode.insertBefore(n.placeholderElement,t.nextSibling),n.moveColumn(e,!0)):(n.toCol!==e||n.toColAfter)&&(t.parentNode.insertBefore(n.placeholderElement,t),n.moveColumn(e,!1)))}).bind(n),t.addEventListener("mousedown",function(t){n.touchMove=!1,1===t.which&&(n.checkTimeout=setTimeout(function(){n.startMove(t,e)},n.checkPeriod))}),t.addEventListener("mouseup",function(e){1===e.which&&n.checkTimeout&&clearTimeout(n.checkTimeout)}),n.bindTouchEvents(e)),e.modules.moveColumn=o}},{key:"bindTouchEvents",value:function(e){var t,n,o,a,s,r,l=this,u=e.getElement(),h=!1;u.addEventListener("touchstart",function(u){l.checkTimeout=setTimeout(function(){l.touchMove=!0,o=(t=e.nextColumn())?t.getWidth()/2:0,a=(n=e.prevColumn())?n.getWidth()/2:0,s=0,r=0,h=!1,l.startMove(u,e)},l.checkPeriod)},{passive:!0}),u.addEventListener("touchmove",function(u){var c,d;l.moving&&(l.moveHover(u),h||(h=u.touches[0].pageX),(c=u.touches[0].pageX-h)>0?t&&c-s>o&&(d=t)!==e&&(h=u.touches[0].pageX,d.getElement().parentNode.insertBefore(l.placeholderElement,d.getElement().nextSibling),l.moveColumn(d,!0)):n&&-c-r>a&&(d=n)!==e&&(h=u.touches[0].pageX,d.getElement().parentNode.insertBefore(l.placeholderElement,d.getElement()),l.moveColumn(d,!1)),d&&(t=d.nextColumn(),s=o,o=t?t.getWidth()/2:0,n=d.prevColumn(),r=a,a=n?n.getWidth()/2:0))},{passive:!0}),u.addEventListener("touchend",function(e){l.checkTimeout&&clearTimeout(l.checkTimeout),l.moving&&l.endMove(e)})}},{key:"startMove",value:function(e,t){var n=t.getElement(),o=this.table.columnManager.getElement(),a=this.table.columnManager.getHeadersElement();this.moving=t,this.startX=(this.touchMove?e.touches[0].pageX:e.pageX)-v.elOffset(n).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",n.parentNode.insertBefore(this.placeholderElement,n),n.parentNode.removeChild(n),this.hoverElement=n.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.table.columnManager.getElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=o.clientHeight-a.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(e)}},{key:"_bindMouseMove",value:function(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveColumn.mousemove)})}},{key:"_unbindMouseMove",value:function(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveColumn.mousemove)})}},{key:"moveColumn",value:function(e,t){var n=this.moving.getCells();this.toCol=e,this.toColAfter=t,t?e.getCells().forEach(function(e,t){var o=e.getElement(!0);o.parentNode&&n[t]&&o.parentNode.insertBefore(n[t].getElement(),o.nextSibling)}):e.getCells().forEach(function(e,t){var o=e.getElement(!0);o.parentNode&&n[t]&&o.parentNode.insertBefore(n[t].getElement(),o)})}},{key:"endMove",value:function(e){(1===e.which||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}},{key:"moveHover",value:function(e){var t,n=this,o=this.table.columnManager.getElement(),a=o.scrollLeft,s=(this.touchMove?e.touches[0].pageX:e.pageX)-v.elOffset(o).left+a;this.hoverElement.style.left=s-this.startX+"px",s-a<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(function(){t=Math.max(0,a-5),n.table.rowManager.getElement().scrollLeft=t,n.autoScrollTimeout=!1},1))),a+o.clientWidth-s<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(function(){t=Math.min(o.clientWidth,a+5),n.table.rowManager.getElement().scrollLeft=t,n.autoScrollTimeout=!1},1)))}}]),s}();eb.moduleName="moveColumn";var ey=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).placeholderElement=n.createPlaceholderElement(),n.hoverElement=!1,n.checkTimeout=!1,n.checkPeriod=150,n.moving=!1,n.toRow=!1,n.toRowAfter=!1,n.hasHandle=!1,n.startY=0,n.startX=0,n.moveHover=n.moveHover.bind(l(n)),n.endMove=n.endMove.bind(l(n)),n.tableRowDropEvent=!1,n.touchMove=!1,n.connection=!1,n.connectionSelectorsTables=!1,n.connectionSelectorsElements=!1,n.connectionElements=[],n.connections=[],n.connectedTable=!1,n.connectedRow=!1,n.registerTableOption("movableRows",!1),n.registerTableOption("movableRowsConnectedTables",!1),n.registerTableOption("movableRowsConnectedElements",!1),n.registerTableOption("movableRowsSender",!1),n.registerTableOption("movableRowsReceiver","insert"),n.registerColumnOption("rowHandle"),n}return o(r,[{key:"createPlaceholderElement",value:function(){var e=document.createElement("div");return e.classList.add("tabulator-row"),e.classList.add("tabulator-row-placeholder"),e}},{key:"initialize",value:function(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}},{key:"initializeGroupHeader",value:function(e){var t=this,n={};n.mouseup=(function(e){t.tableRowDrop(e,row)}).bind(t),n.mousemove=(function(n){var o;n.pageY-v.elOffset(e.element).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?t.toRow===e&&t.toRowAfter||((o=e.getElement()).parentNode.insertBefore(t.placeholderElement,o.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(o=e.getElement()).previousSibling&&(o.parentNode.insertBefore(t.placeholderElement,o),t.moveRow(e,!1))}).bind(t),e.modules.moveRow=n}},{key:"initializeRow",value:function(e){var t,n=this,o={};o.mouseup=(function(t){n.tableRowDrop(t,e)}).bind(n),o.mousemove=(function(t){var o=e.getElement();t.pageY-v.elOffset(o).top+n.table.rowManager.element.scrollTop>e.getHeight()/2?n.toRow===e&&n.toRowAfter||(o.parentNode.insertBefore(n.placeholderElement,o.nextSibling),n.moveRow(e,!0)):(n.toRow!==e||n.toRowAfter)&&(o.parentNode.insertBefore(n.placeholderElement,o),n.moveRow(e,!1))}).bind(n),this.hasHandle||((t=e.getElement()).addEventListener("mousedown",function(t){1===t.which&&(n.checkTimeout=setTimeout(function(){n.startMove(t,e)},n.checkPeriod))}),t.addEventListener("mouseup",function(e){1===e.which&&n.checkTimeout&&clearTimeout(n.checkTimeout)}),this.bindTouchEvents(e,e.getElement())),e.modules.moveRow=o}},{key:"initializeColumn",value:function(e){e.definition.rowHandle&&!1!==this.table.options.movableRows&&(this.hasHandle=!0)}},{key:"initializeCell",value:function(e){if(e.column.definition.rowHandle&&!1!==this.table.options.movableRows){var t=this,n=e.getElement(!0);n.addEventListener("mousedown",function(n){1===n.which&&(t.checkTimeout=setTimeout(function(){t.startMove(n,e.row)},t.checkPeriod))}),n.addEventListener("mouseup",function(e){1===e.which&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e.row,n)}}},{key:"bindTouchEvents",value:function(e,t){var n,o,a,s,r,l,u=this,h=!1;t.addEventListener("touchstart",function(t){u.checkTimeout=setTimeout(function(){u.touchMove=!0,a=(n=e.nextRow())?n.getHeight()/2:0,s=(o=e.prevRow())?o.getHeight()/2:0,r=0,l=0,h=!1,u.startMove(t,e)},u.checkPeriod)},{passive:!0}),this.moving,this.toRow,this.toRowAfter,t.addEventListener("touchmove",function(t){var c,d;u.moving&&(t.preventDefault(),u.moveHover(t),h||(h=t.touches[0].pageY),(c=t.touches[0].pageY-h)>0?n&&c-r>a&&(d=n)!==e&&(h=t.touches[0].pageY,d.getElement().parentNode.insertBefore(u.placeholderElement,d.getElement().nextSibling),u.moveRow(d,!0)):o&&-c-l>s&&(d=o)!==e&&(h=t.touches[0].pageY,d.getElement().parentNode.insertBefore(u.placeholderElement,d.getElement()),u.moveRow(d,!1)),d&&(n=d.nextRow(),r=a,a=n?n.getHeight()/2:0,o=d.prevRow(),l=s,s=o?o.getHeight()/2:0))}),t.addEventListener("touchend",function(e){u.checkTimeout&&clearTimeout(u.checkTimeout),u.moving&&(u.endMove(e),u.touchMove=!1)})}},{key:"_bindMouseMove",value:function(){this.table.rowManager.getDisplayRows().forEach(function(e){("row"===e.type||"group"===e.type)&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveRow.mousemove)})}},{key:"_unbindMouseMove",value:function(){this.table.rowManager.getDisplayRows().forEach(function(e){("row"===e.type||"group"===e.type)&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveRow.mousemove)})}},{key:"startMove",value:function(e,t){var n=t.getElement();this.setStartPosition(e,t),this.moving=t,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(t)):(n.parentNode.insertBefore(this.placeholderElement,n),n.parentNode.removeChild(n)),this.hoverElement=n.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.dispatchExternal("rowMoving",t.getComponent()),this.moveHover(e)}},{key:"setStartPosition",value:function(e,t){var n,o,a=this.touchMove?e.touches[0].pageX:e.pageX,s=this.touchMove?e.touches[0].pageY:e.pageY;n=t.getElement(),this.connection?(o=n.getBoundingClientRect(),this.startX=o.left-a+window.pageXOffset,this.startY=o.top-s+window.pageYOffset):this.startY=s-n.getBoundingClientRect().top}},{key:"endMove",value:function(e){e&&1!==e.which&&!this.touchMove||(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow?this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter):this.dispatchExternal("rowMoveCancelled",this.moving.getComponent()),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}},{key:"moveRow",value:function(e,t){this.toRow=e,this.toRowAfter=t}},{key:"moveHover",value:function(e){this.connection?this.moveHoverConnections.call(this,e):this.moveHoverTable.call(this,e)}},{key:"moveHoverTable",value:function(e){var t=this.table.rowManager.getElement(),n=t.scrollTop,o=(this.touchMove?e.touches[0].pageY:e.pageY)-t.getBoundingClientRect().top+n;this.hoverElement.style.top=o-this.startY+"px"}},{key:"moveHoverConnections",value:function(e){this.hoverElement.style.left=this.startX+(this.touchMove?e.touches[0].pageX:e.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?e.touches[0].pageY:e.pageY)+"px"}},{key:"elementRowDrop",value:function(e,t,n){this.dispatchExternal("movableRowsElementDrop",e,t,!!n&&n.getComponent())}},{key:"connectToTables",value:function(e){var t,n=this;this.connectionSelectorsTables&&(t=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",t),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:e})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach(function(e){"string"==typeof e?n.connectionElements=n.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(e))):n.connectionElements.push(e)}),this.connectionElements.forEach(function(e){var t=function(t){n.elementRowDrop(t,e,n.moving)};e.addEventListener("mouseup",t),e.tabulatorElementDropEvent=t,e.classList.add("tabulator-movingrow-receiving")}))}},{key:"disconnectFromTables",value:function(){var e;this.connectionSelectorsTables&&(e=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",e),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach(function(e){e.classList.remove("tabulator-movingrow-receiving"),e.removeEventListener("mouseup",e.tabulatorElementDropEvent),delete e.tabulatorElementDropEvent})}},{key:"connect",value:function(e,t){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=e,this.connectedRow=t,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(function(e){"row"===e.type&&e.modules.moveRow&&e.modules.moveRow.mouseup&&e.getElement().addEventListener("mouseup",e.modules.moveRow.mouseup)}),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",t,e),!0)}},{key:"disconnect",value:function(e){e===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(function(e){"row"===e.type&&e.modules.moveRow&&e.modules.moveRow.mouseup&&e.getElement().removeEventListener("mouseup",e.modules.moveRow.mouseup)}),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",e)):console.warn("Move Row Error - trying to disconnect from non connected table")}},{key:"dropComplete",value:function(t,n,o){var a=!1;if(o){switch(e(this.table.options.movableRowsSender)){case"string":a=this.senders[this.table.options.movableRowsSender];break;case"function":a=this.table.options.movableRowsSender}a?a.call(this,this.moving.getComponent(),n?n.getComponent():void 0,t):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),n?n.getComponent():void 0,t)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),n?n.getComponent():void 0,t);this.endMove()}},{key:"tableRowDrop",value:function(t,n){var o=!1,a=!1;switch(t.stopImmediatePropagation(),e(this.table.options.movableRowsReceiver)){case"string":o=this.receivers[this.table.options.movableRowsReceiver];break;case"function":o=this.table.options.movableRowsReceiver}o?a=o.call(this,this.connectedRow.getComponent(),n?n.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),a?this.dispatchExternal("movableRowsReceived",this.connectedRow.getComponent(),n?n.getComponent():void 0,this.connectedTable):this.dispatchExternal("movableRowsReceivedFailed",this.connectedRow.getComponent(),n?n.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:n,success:a})}},{key:"commsReceived",value:function(e,t,n){switch(t){case"connect":return this.connect(e,n.row);case"disconnect":return this.disconnect(e);case"dropcomplete":return this.dropComplete(e,n.row,n.success)}}}]),r}();ey.prototype.receivers={insert:function(e,t,n){return this.table.addRow(e.getData(),void 0,t),!0},add:function(e,t,n){return this.table.addRow(e.getData()),!0},update:function(e,t,n){return!!t&&(t.update(e.getData()),!0)},replace:function(e,t,n){return!!t&&(this.table.addRow(e.getData(),void 0,t),t.delete(),!0)}},ey.prototype.senders={delete:function(e,t,n){e.delete()}},ey.moduleName="moveRow";var ew=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).allowedTypes=["","data","edit","clipboard"],n.enabled=!0,n.registerColumnOption("mutator"),n.registerColumnOption("mutatorParams"),n.registerColumnOption("mutatorData"),n.registerColumnOption("mutatorDataParams"),n.registerColumnOption("mutatorEdit"),n.registerColumnOption("mutatorEditParams"),n.registerColumnOption("mutatorClipboard"),n.registerColumnOption("mutatorClipboardParams"),n.registerColumnOption("mutateLink"),n}return o(r,[{key:"initialize",value:function(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("cell-value-changed",this.mutateLink.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}},{key:"rowDataChanged",value:function(e,t,n){return this.transformRow(t,"data",n)}},{key:"initializeColumn",value:function(e){var t=this,n=!1,o={};this.allowedTypes.forEach(function(a){var s,r="mutator"+(a.charAt(0).toUpperCase()+a.slice(1));e.definition[r]&&(s=t.lookupMutator(e.definition[r]))&&(n=!0,o[r]={mutator:s,params:e.definition[r+"Params"]||{}})}),n&&(e.modules.mutate=o)}},{key:"lookupMutator",value:function(t){var n=!1;switch(e(t)){case"string":r.mutators[t]?n=r.mutators[t]:console.warn("Mutator Error - No such mutator found, ignoring: ",t);break;case"function":n=t}return n}},{key:"transformRow",value:function(e,t,n){var o,a="mutator"+(t.charAt(0).toUpperCase()+t.slice(1));return this.enabled&&this.table.columnManager.traverse(function(s){var r,l,u;s.modules.mutate&&(r=s.modules.mutate[a]||s.modules.mutate.mutator||!1)&&(o=s.getFieldValue(void 0!==n?n:e),"data"!=t&&void 0===o||(u=s.getComponent(),l="function"==typeof r.params?r.params(o,e,t,u):r.params,s.setFieldValue(e,r.mutator(o,e,t,l,u))))}),e}},{key:"transformCell",value:function(e,t){if(e.column.modules.mutate){var n=e.column.modules.mutate.mutatorEdit||e.column.modules.mutate.mutator||!1,o={};if(n)return o=Object.assign(o,e.row.getData()),e.column.setFieldValue(o,t),n.mutator(t,o,"edit",n.params,e.getComponent())}return t}},{key:"mutateLink",value:function(e){var t=e.column.definition.mutateLink;t&&(Array.isArray(t)||(t=[t]),t.forEach(function(t){var n=e.row.getCell(t);n&&n.setValue(n.getValue(),!0,!0)}))}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}}]),r}();ew.moduleName="mutator",ew.mutators={};var eC=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).mode="local",n.progressiveLoad=!1,n.element=null,n.pageCounterElement=null,n.pageCounter=null,n.size=0,n.page=1,n.count=5,n.max=1,n.remoteRowCountEstimate=null,n.displayIndex=0,n.initialLoad=!0,n.dataChanging=!1,n.pageSizes=[],n.registerTableOption("pagination",!1),n.registerTableOption("paginationMode","local"),n.registerTableOption("paginationSize",!1),n.registerTableOption("paginationInitialPage",1),n.registerTableOption("paginationCounter",!1),n.registerTableOption("paginationCounterElement",!1),n.registerTableOption("paginationButtonCount",5),n.registerTableOption("paginationSizeSelector",!1),n.registerTableOption("paginationElement",!1),n.registerTableOption("paginationAddRow","page"),n.registerTableOption("progressiveLoad",!1),n.registerTableOption("progressiveLoadDelay",0),n.registerTableOption("progressiveLoadScrollMargin",0),n.registerTableFunction("setMaxPage",n.setMaxPage.bind(l(n))),n.registerTableFunction("setPage",n.setPage.bind(l(n))),n.registerTableFunction("setPageToRow",n.userSetPageToRow.bind(l(n))),n.registerTableFunction("setPageSize",n.userSetPageSize.bind(l(n))),n.registerTableFunction("getPageSize",n.getPageSize.bind(l(n))),n.registerTableFunction("previousPage",n.previousPage.bind(l(n))),n.registerTableFunction("nextPage",n.nextPage.bind(l(n))),n.registerTableFunction("getPage",n.getPage.bind(l(n))),n.registerTableFunction("getPageMax",n.getPageMax.bind(l(n))),n.registerComponentFunction("row","pageTo",n.setPageToRow.bind(l(n))),n}return o(r,[{key:"initialize",value:function(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("footer-redraw",this.footerRedraw.bind(this)),"page"==this.table.options.paginationAddRow&&this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),"remote"===this.table.options.paginationMode&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePageCounter(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),"scroll"===this.table.options.progressiveLoad&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}},{key:"rowAddingPosition",value:function(e,t){var n,o=this.table.rowManager,a=o.getDisplayRows();return t?a.length?n=a[0]:o.activeRows.length&&(n=o.activeRows[o.activeRows.length-1],t=!1):a.length&&(n=a[a.length-1],t=!(a.length<this.size)),{index:n,top:t}}},{key:"calculatePageSizes",value:function(){var e,t;this.table.options.paginationSize?this.size=this.table.options.paginationSize:((e=document.createElement("div")).classList.add("tabulator-row"),e.style.visibility="hidden",(t=document.createElement("div")).classList.add("tabulator-cell"),t.innerHTML="Page Row Test",e.appendChild(t),this.table.rowManager.getTableElement().appendChild(e),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/e.offsetHeight),this.table.rowManager.getTableElement().removeChild(e)),this.dispatchExternal("pageSizeChanged",this.size),this.generatePageSizeSelectList()}},{key:"initialLoadComplete",value:function(){this.initialLoad=!1}},{key:"remotePageParams",value:function(e,t,n,o){return!this.initialLoad&&((!this.progressiveLoad||n)&&(this.progressiveLoad||this.dataChanging)||this.reset(!0)),o.page=this.page,this.size&&(o.size=this.size),o}},{key:"userSetPageToRow",value:function(e){return this.table.options.pagination&&(e=this.rowManager.findRow(e))?this.setPageToRow(e):Promise.reject()}},{key:"userSetPageSize",value:function(e){return!!this.table.options.pagination&&(this.setPageSize(e),this.setPage(1))}},{key:"scrollVertical",value:function(e,t){var n;t||this.table.dataLoader.loading||(n=this.table.rowManager.getElement()).scrollHeight-n.clientHeight-e<(this.table.options.progressiveLoadScrollMargin||2*n.clientHeight)&&this.nextPage().catch(function(){})}},{key:"restOnRenderBefore",value:function(e,t){return t||"local"===this.mode&&this.reset(),e}},{key:"rowsUpdated",value:function(){this.refreshData(!0,"all")}},{key:"createElements",value:function(){var e;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),(e=document.createElement("button")).classList.add("tabulator-page"),e.setAttribute("type","button"),e.setAttribute("role","button"),e.setAttribute("aria-label",""),e.setAttribute("title",""),this.firstBut=e.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=e.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=e.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=e.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}},{key:"generatePageSizeSelectList",value:function(){var e=this,t=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))t=this.table.options.paginationSizeSelector,this.pageSizes=t,-1==this.pageSizes.indexOf(this.size)&&t.unshift(this.size);else if(-1==this.pageSizes.indexOf(this.size)){t=[];for(var n=1;n<5;n++)t.push(this.size*n);this.pageSizes=t}else t=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);t.forEach(function(t){var n=document.createElement("option");n.value=t,!0===t?e.langBind("pagination|all",function(e){n.innerHTML=e}):n.innerHTML=t,e.pageSizeSelect.appendChild(n)}),this.pageSizeSelect.value=this.size}}},{key:"initializePageCounter",value:function(){var e=this.table.options.paginationCounter,t=null;e&&((t="function"==typeof e?e:r.pageCounters[e])?(this.pageCounter=t,this.pageCounterElement=document.createElement("span"),this.pageCounterElement.classList.add("tabulator-page-counter")):console.warn("Pagination Error - No such page counter found: ",e))}},{key:"initializePaginator",value:function(e){var t,n,o=this;e||(this.langBind("pagination|first",function(e){o.firstBut.innerHTML=e}),this.langBind("pagination|first_title",function(e){o.firstBut.setAttribute("aria-label",e),o.firstBut.setAttribute("title",e)}),this.langBind("pagination|prev",function(e){o.prevBut.innerHTML=e}),this.langBind("pagination|prev_title",function(e){o.prevBut.setAttribute("aria-label",e),o.prevBut.setAttribute("title",e)}),this.langBind("pagination|next",function(e){o.nextBut.innerHTML=e}),this.langBind("pagination|next_title",function(e){o.nextBut.setAttribute("aria-label",e),o.nextBut.setAttribute("title",e)}),this.langBind("pagination|last",function(e){o.lastBut.innerHTML=e}),this.langBind("pagination|last_title",function(e){o.lastBut.setAttribute("aria-label",e),o.lastBut.setAttribute("title",e)}),this.firstBut.addEventListener("click",function(){o.setPage(1)}),this.prevBut.addEventListener("click",function(){o.previousPage()}),this.nextBut.addEventListener("click",function(){o.nextPage()}),this.lastBut.addEventListener("click",function(){o.setPage(o.max)}),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(t=document.createElement("label"),this.langBind("pagination|page_size",function(e){o.pageSizeSelect.setAttribute("aria-label",e),o.pageSizeSelect.setAttribute("title",e),t.innerHTML=e}),this.element.appendChild(t),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",function(e){o.setPageSize("true"==o.pageSizeSelect.value||o.pageSizeSelect.value),o.setPage(1)})),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),this.table.options.paginationElement||e||(this.table.options.paginationCounter&&(this.table.options.paginationCounterElement?this.table.options.paginationCounterElement instanceof HTMLElement?this.table.options.paginationCounterElement.appendChild(this.pageCounterElement):"string"==typeof this.table.options.paginationCounterElement&&((n=document.querySelector(this.table.options.paginationCounterElement))?n.appendChild(this.pageCounterElement):console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:",this.table.options.paginationCounterElement)):this.footerAppend(this.pageCounterElement)),this.footerAppend(this.element)),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}},{key:"initializeProgressive",value:function(e){this.initializePaginator(!0),this.mode="progressive_"+e,this.progressiveLoad=!0}},{key:"trackChanges",value:function(){this.dispatch("page-changed")}},{key:"setDisplayIndex",value:function(e){this.displayIndex=e}},{key:"getDisplayIndex",value:function(){return this.displayIndex}},{key:"setMaxRows",value:function(e){this.max=e?!0===this.size?1:Math.ceil(e/this.size):1,this.page>this.max&&(this.page=this.max)}},{key:"reset",value:function(e){this.initialLoad||("local"==this.mode||e)&&(this.page=1)}},{key:"setMaxPage",value:function(e){e=parseInt(e),this.max=e||1,this.page>this.max&&(this.page=this.max,this.trigger())}},{key:"setPage",value:function(e){switch(e){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return(e=parseInt(e))>0&&e<=this.max||"local"!==this.mode?(this.page=e,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",e),Promise.reject())}},{key:"setPageToRow",value:function(e){var t=this.table.rowManager.getDisplayRows(this.displayIndex-1).indexOf(e);if(t>-1){var n=!0===this.size?1:Math.ceil((t+1)/this.size);return this.setPage(n)}return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}},{key:"setPageSize",value:function(e){!0!==e&&(e=parseInt(e)),e>0&&(this.size=e,this.dispatchExternal("pageSizeChanged",e)),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}},{key:"_setPageCounter",value:function(t,n,o){var a;if(this.pageCounter)switch("remote"===this.mode&&(n=this.size,o=(this.page-1)*this.size+1,t=this.remoteRowCountEstimate),e(a=this.pageCounter.call(this,n,o,this.page,t,this.max))){case"object":if(a instanceof Node){for(;this.pageCounterElement.firstChild;)this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);this.pageCounterElement.appendChild(a)}else this.pageCounterElement.innerHTML="",null!=a&&console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:",a);break;case"undefined":case"null":this.pageCounterElement.innerHTML="";break;default:this.pageCounterElement.innerHTML=a}}},{key:"_setPageButtons",value:function(){for(var e=Math.floor((this.count-1)/2),t=Math.ceil((this.count-1)/2),n=this.max-this.page+e+1<this.count?this.max-this.count+1:Math.max(this.page-e,1),o=this.page<=t?Math.min(this.count,this.max):Math.min(this.page+t,this.max);this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);1==this.page?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(var a=n;a<=o;a++)a>0&&a<=this.max&&this.pagesElement.appendChild(this._generatePageButton(a));this.footerRedraw()}},{key:"_generatePageButton",value:function(e){var t=this,n=document.createElement("button");return n.classList.add("tabulator-page"),e==this.page&&n.classList.add("active"),n.setAttribute("type","button"),n.setAttribute("role","button"),this.langBind("pagination|page_title",function(t){n.setAttribute("aria-label",t+" "+e),n.setAttribute("title",t+" "+e)}),n.setAttribute("data-page",e),n.textContent=e,n.addEventListener("click",function(n){t.setPage(e)}),n}},{key:"previousPage",value:function(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}},{key:"nextPage",value:function(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}},{key:"getPage",value:function(){return this.page}},{key:"getPageMax",value:function(){return this.max}},{key:"getPageSize",value:function(e){return this.size}},{key:"getMode",value:function(){return this.mode}},{key:"getRows",value:function(e){var t,n,o,a,s=0,r=e.filter(function(e){return"row"===e.type});if("local"==this.mode){t=[],this.setMaxRows(e.length),!0===this.size?(n=0,o=e.length):o=(n=this.size*(this.page-1))+parseInt(this.size),this._setPageButtons();for(var l=n;l<o;l++){var u=e[l];u&&(t.push(u),"row"===u.type&&(a||(a=u),s++))}return this._setPageCounter(r.length,s,a?r.indexOf(a)+1:0),t}return this._setPageButtons(),this._setPageCounter(r.length),e.slice(0)}},{key:"trigger",value:function(){var e,t=this;switch(this.mode){case"local":return e=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(e),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally(function(){t.dataChanging=!1});case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}},{key:"_parseRemoteData",value:function(e){var t,n=this;if(void 0===e.last_page&&console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").last_page||"last_page")+"' property"),e.data){if(this.max=parseInt(e.last_page)||1,this.remoteRowCountEstimate=void 0!==e.last_row?e.last_row:e.last_page*this.size-(this.page==e.last_page?this.size-e.data.length:0),this.progressiveLoad){switch(this.mode){case"progressive_load":1==this.page?this.table.rowManager.setData(e.data,!1,1==this.page):this.table.rowManager.addRows(e.data),this.page<this.max&&setTimeout(function(){n.nextPage()},this.table.options.progressiveLoadDelay);break;case"progressive_scroll":e=1===this.page?e.data:this.table.rowManager.getData().concat(e.data),this.table.rowManager.setData(e,1!==this.page,1==this.page),t=this.table.options.progressiveLoadScrollMargin||2*this.table.rowManager.element.clientHeight,this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+t&&this.page<this.max&&setTimeout(function(){n.nextPage()})}return!1}this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").data||"data")+"' property");return e.data}},{key:"footerRedraw",value:function(){var e=this.table.footerManager.containerElement;Math.ceil(e.clientWidth)-e.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(e.clientWidth)-e.scrollWidth<0&&(this.pagesElement.style.display="none"))}}]),r}();eC.moduleName="page",eC.pageCounters={rows:function(e,t,n,o,a){var s=document.createElement("span"),r=document.createElement("span"),l=document.createElement("span"),u=document.createElement("span"),h=document.createElement("span"),c=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",function(e){r.innerHTML=e}),this.table.modules.localize.langBind("pagination|counter|of",function(e){u.innerHTML=e}),this.table.modules.localize.langBind("pagination|counter|rows",function(e){c.innerHTML=e}),o?(l.innerHTML=" "+t+"-"+Math.min(t+e-1,o)+" ",h.innerHTML=" "+o+" ",s.appendChild(r),s.appendChild(l),s.appendChild(u),s.appendChild(h),s.appendChild(c)):(l.innerHTML=" 0 ",s.appendChild(r),s.appendChild(l),s.appendChild(c)),s},pages:function(e,t,n,o,a){var s=document.createElement("span"),r=document.createElement("span"),l=document.createElement("span"),u=document.createElement("span"),h=document.createElement("span"),c=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",function(e){r.innerHTML=e}),l.innerHTML=" "+n+" ",this.table.modules.localize.langBind("pagination|counter|of",function(e){u.innerHTML=e}),h.innerHTML=" "+a+" ",this.table.modules.localize.langBind("pagination|counter|pages",function(e){c.innerHTML=e}),s.appendChild(r),s.appendChild(l),s.appendChild(u),s.appendChild(h),s.appendChild(c),s}};var ek=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).mode="",o.id="",o.defWatcherBlock=!1,o.config={},o.readFunc=!1,o.writeFunc=!1,o.registerTableOption("persistence",!1),o.registerTableOption("persistenceID",""),o.registerTableOption("persistenceMode",!0),o.registerTableOption("persistenceReaderFunc",!1),o.registerTableOption("persistenceWriterFunc",!1),o}return o(s,[{key:"localStorageTest",value:function(){var e="_tabulator_test";try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(t){return!1}}},{key:"initialize",value:function(){if(this.table.options.persistence){var e,t=this.table.options.persistenceMode,n=this.table.options.persistenceID;this.mode=!0!==t?t:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?"function"==typeof this.table.options.persistenceReaderFunc?this.readFunc=this.table.options.persistenceReaderFunc:s.readers[this.table.options.persistenceReaderFunc]?this.readFunc=s.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):s.readers[this.mode]?this.readFunc=s.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?"function"==typeof this.table.options.persistenceWriterFunc?this.writeFunc=this.table.options.persistenceWriterFunc:s.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=s.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):s.writers[this.mode]?this.writeFunc=s.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(n||this.table.element.getAttribute("id")||""),this.config={sort:!0===this.table.options.persistence||this.table.options.persistence.sort,filter:!0===this.table.options.persistence||this.table.options.persistence.filter,group:!0===this.table.options.persistence||this.table.options.persistence.group,page:!0===this.table.options.persistence||this.table.options.persistence.page,columns:!0===this.table.options.persistence?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(e=this.retreiveData("page"))&&(void 0!==e.paginationSize&&(!0===this.config.page||this.config.page.size)&&(this.table.options.paginationSize=e.paginationSize),void 0!==e.paginationInitialPage&&(!0===this.config.page||this.config.page.page)&&(this.table.options.paginationInitialPage=e.paginationInitialPage)),this.config.group&&(e=this.retreiveData("group"))&&(void 0!==e.groupBy&&(!0===this.config.group||this.config.group.groupBy)&&(this.table.options.groupBy=e.groupBy),void 0!==e.groupStartOpen&&(!0===this.config.group||this.config.group.groupStartOpen)&&(this.table.options.groupStartOpen=e.groupStartOpen),void 0!==e.groupHeader&&(!0===this.config.group||this.config.group.groupHeader)&&(this.table.options.groupHeader=e.groupHeader)),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns"))),this.subscribe("table-built",this.tableBuilt.bind(this),0),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}},{key:"eventSave",value:function(e){this.config[e]&&this.save(e)}},{key:"tableBuilt",value:function(){var e,t;this.table.options,this.config.sort&&!1==!(e=this.load("sort"))&&(this.table.options.initialSort=e),this.config.filter&&!1==!(t=this.load("filter"))&&(this.table.options.initialFilter=t)}},{key:"tableRedraw",value:function(e){e&&this.config.columns&&this.save("columns")}},{key:"getColumnLayout",value:function(){return this.parseColumns(this.table.columnManager.getColumns())}},{key:"setColumnLayout",value:function(e){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,e)),!0}},{key:"initializeColumn",value:function(e){var t;this.config.columns&&(this.defWatcherBlock=!0,t=e.getDefinition(),(!0===this.config.columns?Object.keys(t):this.config.columns).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e),o=t[e];n&&Object.defineProperty(t,e,{set:function(e){o=e,this.defWatcherBlock||this.save("columns"),n.set&&n.set(e)},get:function(){return n.get&&n.get(),o}})}),this.defWatcherBlock=!1)}},{key:"load",value:function(e,t){var n=this.retreiveData(e);return t&&(n=n?this.mergeDefinition(t,n):t),n}},{key:"retreiveData",value:function(e){return!!this.readFunc&&this.readFunc(this.id,e)}},{key:"mergeDefinition",value:function(e,t){var n=this,o=[];return(t=t||[]).forEach(function(t,a){var s,r=n._findColumn(e,t);r&&(!0===n.config.columns||null==n.config.columns?(s=Object.keys(r)).push("width"):s=n.config.columns,s.forEach(function(e){"columns"!==e&&void 0!==t[e]&&(r[e]=t[e])}),r.columns&&(r.columns=n.mergeDefinition(r.columns,t.columns)),o.push(r))}),e.forEach(function(e,a){n._findColumn(t,e)||(o.length>a?o.splice(a,0,e):o.push(e))}),o}},{key:"_findColumn",value:function(e,t){var n=t.columns?"group":t.field?"field":"object";return e.find(function(e){switch(n){case"group":return e.title===t.title&&e.columns.length===t.columns.length;case"field":return e.field===t.field;case"object":return e===t}})}},{key:"save",value:function(e){var t={};switch(e){case"columns":t=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":t=this.table.modules.filter.getFilters();break;case"sort":t=this.validateSorters(this.table.modules.sort.getSort());break;case"group":t=this.getGroupConfig();break;case"page":t=this.getPageConfig()}this.writeFunc&&this.writeFunc(this.id,e,t)}},{key:"validateSorters",value:function(e){return e.forEach(function(e){e.column=e.field,delete e.field}),e}},{key:"getGroupConfig",value:function(){var e={};return this.config.group&&((!0===this.config.group||this.config.group.groupBy)&&(e.groupBy=this.table.options.groupBy),(!0===this.config.group||this.config.group.groupStartOpen)&&(e.groupStartOpen=this.table.options.groupStartOpen),(!0===this.config.group||this.config.group.groupHeader)&&(e.groupHeader=this.table.options.groupHeader)),e}},{key:"getPageConfig",value:function(){var e={};return this.config.page&&((!0===this.config.page||this.config.page.size)&&(e.paginationSize=this.table.modules.page.getPageSize()),(!0===this.config.page||this.config.page.page)&&(e.paginationInitialPage=this.table.modules.page.getPage())),e}},{key:"parseColumns",value:function(e){var t=this,n=[],o=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return e.forEach(function(e){var a,s={},r=e.getDefinition();e.isGroup?(s.title=r.title,s.columns=t.parseColumns(e.getColumns())):(s.field=e.getField(),!0===t.config.columns||null==t.config.columns?(a=Object.keys(r)).push("width"):a=t.config.columns,a.forEach(function(t){switch(t){case"width":s.width=e.getWidth();break;case"visible":s.visible=e.visible;break;default:"function"!=typeof r[t]&&-1===o.indexOf(t)&&(s[t]=r[t])}})),n.push(s)}),n}}]),s}();ek.moduleName="persistence",ek.moduleInitOrder=-10,ek.readers={local:function(e,t){var n=localStorage.getItem(e+"-"+t);return!!n&&JSON.parse(n)},cookie:function(e,t){var n,o,a=document.cookie,s=e+"-"+t,r=a.indexOf(s+"=");return r>-1&&((n=(a=a.slice(r)).indexOf(";"))>-1&&(a=a.slice(0,n)),o=a.replace(s+"=","")),!!o&&JSON.parse(o)}},ek.writers={local:function(e,t,n){localStorage.setItem(e+"-"+t,JSON.stringify(n))},cookie:function(e,t,n){var o=new Date;o.setDate(o.getDate()+1e4),document.cookie=e+"-"+t+"="+JSON.stringify(n)+"; expires="+o.toUTCString()}};var eE=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).columnSubscribers={},o.registerTableOption("rowContextPopup",!1),o.registerTableOption("rowClickPopup",!1),o.registerTableOption("groupContextPopup",!1),o.registerTableOption("groupClickPopup",!1),o.registerColumnOption("headerContextPopup"),o.registerColumnOption("headerClickPopup"),o.registerColumnOption("headerPopup"),o.registerColumnOption("headerPopupIcon"),o.registerColumnOption("contextPopup"),o.registerColumnOption("clickPopup"),o}return o(s,[{key:"initialize",value:function(){this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}},{key:"initializeRowWatchers",value:function(){this.table.options.rowContextPopup&&(this.subscribe("row-contextmenu",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup)),this.table.on("rowTapHold",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup))),this.table.options.rowClickPopup&&this.subscribe("row-click",this.loadPopupEvent.bind(this,this.table.options.rowClickPopup))}},{key:"initializeGroupWatchers",value:function(){this.table.options.groupContextPopup&&(this.subscribe("group-contextmenu",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup)),this.table.on("groupTapHold",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup))),this.table.options.groupClickPopup&&this.subscribe("group-click",this.loadPopupEvent.bind(this,this.table.options.groupClickPopup))}},{key:"initializeColumn",value:function(e){var t=e.definition;t.headerContextPopup&&!this.columnSubscribers.headerContextPopup&&(this.columnSubscribers.headerContextPopup=this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextPopup),this.table.on("headerTapHold",this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"))),t.headerClickPopup&&!this.columnSubscribers.headerClickPopup&&(this.columnSubscribers.headerClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerClickPopup"),this.subscribe("column-click",this.columnSubscribers.headerClickPopup)),t.headerPopup&&this.initializeColumnHeaderPopup(e),t.contextPopup&&!this.columnSubscribers.contextPopup&&(this.columnSubscribers.contextPopup=this.loadPopupTableCellEvent.bind(this,"contextPopup"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextPopup),this.table.on("cellTapHold",this.loadPopupTableCellEvent.bind(this,"contextPopup"))),t.clickPopup&&!this.columnSubscribers.clickPopup&&(this.columnSubscribers.clickPopup=this.loadPopupTableCellEvent.bind(this,"clickPopup"),this.subscribe("cell-click",this.columnSubscribers.clickPopup))}},{key:"initializeColumnHeaderPopup",value:function(e){var t,n=this,o=e.definition.headerPopupIcon;(t=document.createElement("span")).classList.add("tabulator-header-popup-button"),o?("function"==typeof o&&(o=o(e.getComponent())),o instanceof HTMLElement?t.appendChild(o):t.innerHTML=o):t.innerHTML="&vellip;",t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n.loadPopupEvent(e.definition.headerPopup,t,e)}),e.titleElement.insertBefore(t,e.titleElement.firstChild)}},{key:"loadPopupTableCellEvent",value:function(e,t,n){n._cell&&(n=n._cell),n.column.definition[e]&&this.loadPopupEvent(n.column.definition[e],t,n)}},{key:"loadPopupTableColumnEvent",value:function(e,t,n){n._column&&(n=n._column),n.definition[e]&&this.loadPopupEvent(n.definition[e],t,n)}},{key:"loadPopupEvent",value:function(e,t,n){var o;n._group?n=n._group:n._row&&(n=n._row),e="function"==typeof e?e.call(this.table,t,n.getComponent(),function(e){o=e}):e,this.loadPopup(t,n,e,o)}},{key:"loadPopup",value:function(e,t,n,o){var a,s,r=this,l=!(e instanceof MouseEvent);n instanceof HTMLElement?a=n:(a=document.createElement("div")).innerHTML=n,a.classList.add("tabulator-popup"),a.addEventListener("click",function(e){e.stopPropagation()}),l||e.preventDefault(),s=this.popup(a),"function"==typeof o&&s.renderCallback(o),s.show(e).hideOnBlur(function(){r.dispatchExternal("popupClosed",t.getComponent())}),this.dispatchExternal("popupOpened",t.getComponent())}}]),s}();eE.moduleName="popup";var e$=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).element=!1,o.manualBlock=!1,o.registerTableOption("printAsHtml",!1),o.registerTableOption("printFormatter",!1),o.registerTableOption("printHeader",!1),o.registerTableOption("printFooter",!1),o.registerTableOption("printStyled",!0),o.registerTableOption("printRowRange","visible"),o.registerTableOption("printConfig",{}),o.registerColumnOption("print"),o.registerColumnOption("titlePrint"),o}return o(s,[{key:"initialize",value:function(){this.table.options.printAsHtml&&(window.addEventListener("beforeprint",this.replaceTable.bind(this)),window.addEventListener("afterprint",this.cleanup.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}},{key:"replaceTable",value:function(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.genereateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}},{key:"cleanup",value:function(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}},{key:"printFullscreen",value:function(e,t,n){var o,a,s=window.scrollX,r=window.scrollY,l=document.createElement("div"),u=document.createElement("div"),h=this.table.modules.export.genereateTable(void 0!==n?n:this.table.options.printConfig,void 0!==t?t:this.table.options.printStyled,e||this.table.options.printRowRange,"print");this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(l.classList.add("tabulator-print-header"),"string"==typeof(o="function"==typeof this.table.options.printHeader?this.table.options.printHeader.call(this.table):this.table.options.printHeader)?l.innerHTML=o:l.appendChild(o),this.element.appendChild(l)),this.element.appendChild(h),this.table.options.printFooter&&(u.classList.add("tabulator-print-footer"),"string"==typeof(a="function"==typeof this.table.options.printFooter?this.table.options.printFooter.call(this.table):this.table.options.printFooter)?u.innerHTML=a:u.appendChild(a),this.element.appendChild(u)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,h),window.print(),this.cleanup(),window.scrollTo(s,r),this.manualBlock=!1}}]),s}();e$.moduleName="print";var e_=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).data=!1,o.blocked=!1,o.origFuncs={},o.currentVersion=0,o.registerTableOption("reactiveData",!1),o}return o(s,[{key:"initialize",value:function(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this)),this.subscribe("cell-value-save-after",this.unblock.bind(this)),this.subscribe("row-data-save-before",this.block.bind(this)),this.subscribe("row-data-save-after",this.unblock.bind(this)),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}},{key:"watchData",value:function(e){var t,n=this;this.currentVersion++,t=this.currentVersion,this.unwatchData(),this.data=e,this.origFuncs.push=e.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var o=Array.from(arguments);return n.blocked||t!==n.currentVersion||o.forEach(function(e){n.table.rowManager.addRowActual(e,!1)}),n.origFuncs.push.apply(e,arguments)}}),this.origFuncs.unshift=e.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var o=Array.from(arguments);return n.blocked||t!==n.currentVersion||o.forEach(function(e){n.table.rowManager.addRowActual(e,!0)}),n.origFuncs.unshift.apply(e,arguments)}}),this.origFuncs.shift=e.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var o;return n.blocked||t!==n.currentVersion||n.data.length&&(o=n.table.rowManager.getRowFromDataObject(n.data[0]))&&o.deleteActual(),n.origFuncs.shift.call(e)}}),this.origFuncs.pop=e.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var o;return n.blocked||t!==n.currentVersion||n.data.length&&(o=n.table.rowManager.getRowFromDataObject(n.data[n.data.length-1]))&&o.deleteActual(),n.origFuncs.pop.call(e)}}),this.origFuncs.splice=e.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var o,a=Array.from(arguments),s=a[0]<0?e.length+a[0]:a[0],r=a[1],l=!!a[2]&&a.slice(2);if(!n.blocked&&t===n.currentVersion){if(l&&((o=!!e[s]&&n.table.rowManager.getRowFromDataObject(e[s]))?l.forEach(function(e){n.table.rowManager.addRowActual(e,!0,o,!0)}):(l=l.slice().reverse()).forEach(function(e){n.table.rowManager.addRowActual(e,!0,!1,!0)})),0!==r){var u=e.slice(s,void 0===a[1]?a[1]:s+r);u.forEach(function(e,t){var o=n.table.rowManager.getRowFromDataObject(e);o&&o.deleteActual(t!==u.length-1)})}(l||0!==r)&&n.table.rowManager.reRenderInPosition()}return n.origFuncs.splice.apply(e,arguments)}})}},{key:"unwatchData",value:function(){if(!1!==this.data)for(var e in this.origFuncs)Object.defineProperty(this.data,e,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}},{key:"watchRow",value:function(e){var t=e.getData();for(var n in this.blocked=!0,t)this.watchKey(e,t,n);this.table.options.dataTree&&this.watchTreeChildren(e),this.blocked=!1}},{key:"watchTreeChildren",value:function(e){var t=arguments,n=e.getData()[this.table.options.dataTreeChildField],o={};function a(){this.table.modules.dataTree.initializeRow(e),this.table.modules.dataTree.layoutRow(e),this.table.rowManager.refreshActiveData("tree",!1,!0)}n&&(o.push=n.push,Object.defineProperty(n,"push",{enumerable:!1,configurable:!0,value:function(){var e=o.push.apply(n,t);return a(),e}}),o.unshift=n.unshift,Object.defineProperty(n,"unshift",{enumerable:!1,configurable:!0,value:function(){var e=o.unshift.apply(n,t);return a(),e}}),o.shift=n.shift,Object.defineProperty(n,"shift",{enumerable:!1,configurable:!0,value:function(){var e=o.shift.call(n);return a(),e}}),o.pop=n.pop,Object.defineProperty(n,"pop",{enumerable:!1,configurable:!0,value:function(){var e=o.pop.call(n);return a(),e}}),o.splice=n.splice,Object.defineProperty(n,"splice",{enumerable:!1,configurable:!0,value:function(){var e=o.splice.apply(n,t);return a(),e}}))}},{key:"watchKey",value:function(e,t,n){var o=this,a=Object.getOwnPropertyDescriptor(t,n),s=t[n],r=this.currentVersion;Object.defineProperty(t,n,{set:function(t){if(s=t,!o.blocked&&r===o.currentVersion){var l={};l[n]=t,e.updateData(l)}a.set&&a.set(t)},get:function(){return a.get&&a.get(),s}})}},{key:"unwatchRow",value:function(e){var t=e.getData();for(var n in t)Object.defineProperty(t,n,{value:t[n]})}},{key:"block",value:function(){this.blocked=!0}},{key:"unblock",value:function(){this.blocked=!1}}]),s}();e_.moduleName="reactiveData";var eR=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).startColumn=!1,o.startX=!1,o.startWidth=!1,o.latestX=!1,o.handle=null,o.initialNextColumn=null,o.nextColumn=null,o.initialized=!1,o.registerColumnOption("resizable",!0),o.registerTableOption("resizableColumnFit",!1),o}return o(s,[{key:"initialize",value:function(){this.subscribe("column-rendered",this.layoutColumnHeader.bind(this))}},{key:"initializeEventWatchers",value:function(){this.initialized||(this.subscribe("cell-rendered",this.layoutCellHandles.bind(this)),this.subscribe("cell-delete",this.deInitializeComponent.bind(this)),this.subscribe("cell-height",this.resizeHandle.bind(this)),this.subscribe("column-moved",this.columnLayoutUpdated.bind(this)),this.subscribe("column-hide",this.deInitializeColumn.bind(this)),this.subscribe("column-show",this.columnLayoutUpdated.bind(this)),this.subscribe("column-delete",this.deInitializeComponent.bind(this)),this.subscribe("column-height",this.resizeHandle.bind(this)),this.initialized=!0)}},{key:"layoutCellHandles",value:function(e){"row"===e.row.type&&(this.deInitializeComponent(e),this.initializeColumn("cell",e,e.column,e.element))}},{key:"layoutColumnHeader",value:function(e){e.definition.resizable&&(this.initializeEventWatchers(),this.deInitializeComponent(e),this.initializeColumn("header",e,e,e.element))}},{key:"columnLayoutUpdated",value:function(e){var t=e.prevColumn();this.reinitializeColumn(e),t&&this.reinitializeColumn(t)}},{key:"reinitializeColumn",value:function(e){e.cells.forEach(function(e){e.modules.resize&&e.modules.resize.handleEl&&e.element.after(e.modules.resize.handleEl)}),e.modules.resize&&e.modules.resize.handleEl&&e.element.after(e.modules.resize.handleEl)}},{key:"initializeColumn",value:function(e,t,n,o){var a=this,s=n.definition.resizable,r={},l=n.getLastColumn();if("header"===e&&(r={variableHeight:"textarea"==n.definition.formatter||n.definition.variableHeight}),(!0===s||s==e)&&this._checkResizability(l)){var u=document.createElement("span");u.className="tabulator-col-resize-handle",u.addEventListener("click",function(e){e.stopPropagation()});var h=function(e){a.startColumn=n,a.initialNextColumn=a.nextColumn=l.nextColumn(),a._mouseDown(e,l,u)};u.addEventListener("mousedown",h),u.addEventListener("touchstart",h,{passive:!0}),u.addEventListener("dblclick",function(e){var t=l.getWidth();e.stopPropagation(),l.reinitializeWidth(!0),t!==l.getWidth()&&(a.dispatch("column-resized",l),a.table.externalEvents.dispatch("columnResized",l.getComponent()))}),r.handleEl=u,o.parentNode&&o.after(u)}t.modules.resize=r}},{key:"deInitializeColumn",value:function(e){var t=this;this.deInitializeComponent(e),e.cells.forEach(function(e){t.deInitializeComponent(e)})}},{key:"deInitializeComponent",value:function(e){var t;e.modules.resize&&(t=e.modules.resize.handleEl)&&t.parentElement&&t.parentElement.removeChild(t)}},{key:"resizeHandle",value:function(e,t){e.modules.resize&&e.modules.resize.handleEl&&(e.modules.resize.handleEl.style.height=t)}},{key:"_checkResizability",value:function(e){return e.definition.resizable}},{key:"_mouseDown",value:function(e,t,n){var o=this;function a(e){var n,a,s=void 0===e.screenX?e.touches[0].screenX:e.screenX,r=s-o.startX,l=s-o.latestX;if(o.latestX=s,o.table.rtl&&(r=-r,l=-l),n=t.width==t.minWidth||t.width==t.maxWidth,t.setWidth(o.startWidth+r),a=t.width==t.minWidth||t.width==t.maxWidth,l<0&&(o.nextColumn=o.initialNextColumn),o.table.options.resizableColumnFit&&o.nextColumn&&(!n||!a)){var u=o.nextColumn.getWidth();l>0&&u<=o.nextColumn.minWidth&&(o.nextColumn=o.nextColumn.nextColumn()),o.nextColumn&&o.nextColumn.setWidth(o.nextColumn.getWidth()-l)}o.table.columnManager.renderer.rerenderColumns(!0),!o.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights()}function s(e){o.startColumn.modules.edit&&(o.startColumn.modules.edit.blocked=!1),o.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights(),document.body.removeEventListener("mouseup",s),document.body.removeEventListener("mousemove",a),n.removeEventListener("touchmove",a),n.removeEventListener("touchend",s),o.table.element.classList.remove("tabulator-block-select"),o.startWidth!==t.getWidth()&&(o.dispatch("column-resized",t),o.table.externalEvents.dispatch("columnResized",t.getComponent()))}o.table.element.classList.add("tabulator-block-select"),e.stopPropagation(),o.startColumn.modules.edit&&(o.startColumn.modules.edit.blocked=!0),o.startX=void 0===e.screenX?e.touches[0].screenX:e.screenX,o.latestX=o.startX,o.startWidth=t.getWidth(),document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",s),n.addEventListener("touchmove",a,{passive:!0}),n.addEventListener("touchend",s)}}]),s}();eR.moduleName="resizeColumns";var ex=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).startColumn=!1,o.startY=!1,o.startHeight=!1,o.handle=null,o.prevHandle=null,o.registerTableOption("resizableRows",!1),o}return o(s,[{key:"initialize",value:function(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}},{key:"initializeRow",value:function(e){var t=this,n=e.getElement(),o=document.createElement("div");o.className="tabulator-row-resize-handle";var a=document.createElement("div");a.className="tabulator-row-resize-handle prev",o.addEventListener("click",function(e){e.stopPropagation()});var s=function(n){t.startRow=e,t._mouseDown(n,e,o)};o.addEventListener("mousedown",s),o.addEventListener("touchstart",s,{passive:!0}),a.addEventListener("click",function(e){e.stopPropagation()});var r=function(n){var o=t.table.rowManager.prevDisplayRow(e);o&&(t.startRow=o,t._mouseDown(n,o,a))};a.addEventListener("mousedown",r),a.addEventListener("touchstart",r,{passive:!0}),n.appendChild(o),n.appendChild(a)}},{key:"_mouseDown",value:function(e,t,n){var o=this;function a(e){t.setHeight(o.startHeight+((void 0===e.screenY?e.touches[0].screenY:e.screenY)-o.startY))}function s(e){document.body.removeEventListener("mouseup",a),document.body.removeEventListener("mousemove",a),n.removeEventListener("touchmove",a),n.removeEventListener("touchend",s),o.table.element.classList.remove("tabulator-block-select"),o.dispatchExternal("rowResized",t.getComponent())}o.table.element.classList.add("tabulator-block-select"),e.stopPropagation(),o.startY=void 0===e.screenY?e.touches[0].screenY:e.screenY,o.startHeight=t.getHeight(),document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",s),n.addEventListener("touchmove",a,{passive:!0}),n.addEventListener("touchend",s)}}]),s}();ex.moduleName="resizeRows";var eT=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).binding=!1,o.observer=!1,o.containerObserver=!1,o.tableHeight=0,o.tableWidth=0,o.containerHeight=0,o.containerWidth=0,o.autoResize=!1,o.registerTableOption("autoResize",!0),o}return o(s,[{key:"initialize",value:function(){var e=this;if(this.table.options.autoResize){var t,n=this.table;this.tableHeight=n.element.clientHeight,this.tableWidth=n.element.clientWidth,n.element.parentNode&&(this.containerHeight=n.element.parentNode.clientHeight,this.containerWidth=n.element.parentNode.clientWidth),"undefined"!=typeof ResizeObserver&&"virtual"===n.rowManager.getRenderMode()?(this.autoResize=!0,this.observer=new ResizeObserver(function(t){if(!n.browserMobile||n.browserMobile&&!n.modules.edit.currentCell){var o=Math.floor(t[0].contentRect.height),a=Math.floor(t[0].contentRect.width);e.tableHeight==o&&e.tableWidth==a||(e.tableHeight=o,e.tableWidth=a,n.element.parentNode&&(e.containerHeight=n.element.parentNode.clientHeight,e.containerWidth=n.element.parentNode.clientWidth),e.table.columnManager.renderer.rerenderColumns(!0),n.redraw())}}),this.observer.observe(n.element),t=window.getComputedStyle(n.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(t.getPropertyValue("max-height")||t.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver(function(t){if(!n.browserMobile||n.browserMobile&&!n.modules.edit.currentCell){var o=Math.floor(t[0].contentRect.height),a=Math.floor(t[0].contentRect.width);e.containerHeight==o&&e.containerWidth==a||(e.containerHeight=o,e.containerWidth=a,e.tableHeight=n.element.clientHeight,e.tableWidth=n.element.clientWidth),n.columnManager.renderer.rerenderColumns(!0),n.redraw()}}),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){n.browserMobile&&(!n.browserMobile||n.modules.edit.currentCell)||(n.columnManager.renderer.rerenderColumns(!0),n.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}},{key:"tableResized",value:function(){this.table.rowManager.redraw()}},{key:"clearBindings",value:function(){this.binding&&window.removeEventListener("resize",this.binding),this.observer&&this.observer.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}]),s}();eT.moduleName="resizeTable";var eL=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).columns=[],o.hiddenColumns=[],o.mode="",o.index=0,o.collapseFormatter=[],o.collapseStartOpen=!0,o.collapseHandleColumn=!1,o.registerTableOption("responsiveLayout",!1),o.registerTableOption("responsiveLayoutCollapseStartOpen",!0),o.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),o.registerTableOption("responsiveLayoutCollapseFormatter",!1),o.registerColumnOption("responsive"),o}return o(s,[{key:"initialize",value:function(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),"collapse"===this.table.options.responsiveLayout&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}},{key:"tableRedraw",value:function(e){-1===["fitColumns","fitDataStretch"].indexOf(this.layoutMode())&&(e||this.update())}},{key:"initializeResponsivity",value:function(){var e=this,t=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.table.columnManager.columnsByIndex.forEach(function(n,o){n.modules.responsive&&n.modules.responsive.order&&n.modules.responsive.visible&&(n.modules.responsive.index=o,t.push(n),n.visible||"collapse"!==e.mode||e.hiddenColumns.push(n))}),t=(t=t.reverse()).sort(function(e,t){return t.modules.responsive.order-e.modules.responsive.order||t.modules.responsive.index-e.modules.responsive.index}),this.columns=t,"collapse"===this.mode&&this.generateCollapsedContent();var n,o=h(this.table.columnManager.columnsByIndex);try{for(o.s();!(n=o.n()).done;){var a=n.value;if("responsiveCollapse"==a.definition.formatter){this.collapseHandleColumn=a;break}}}catch(s){o.e(s)}finally{o.f()}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}},{key:"initializeColumn",value:function(e){var t=e.getDefinition();e.modules.responsive={order:void 0===t.responsive?1:t.responsive,visible:!1!==t.visible}}},{key:"initializeRow",value:function(e){var t;"calc"!==e.type&&((t=document.createElement("div")).classList.add("tabulator-responsive-collapse"),e.modules.responsiveLayout={element:t,open:this.collapseStartOpen},this.collapseStartOpen||(t.style.display="none"))}},{key:"layoutRow",value:function(e){var t=e.getElement();e.modules.responsiveLayout&&(t.appendChild(e.modules.responsiveLayout.element),this.generateCollapsedRowContent(e))}},{key:"updateColumnVisibility",value:function(e,t){!t&&e.modules.responsive&&(e.modules.responsive.visible=e.visible,this.initializeResponsivity())}},{key:"hideColumn",value:function(e){var t=this.hiddenColumns.length;e.hide(!1,!0),"collapse"===this.mode&&(this.hiddenColumns.unshift(e),this.generateCollapsedContent(),this.collapseHandleColumn&&!t&&this.collapseHandleColumn.show())}},{key:"showColumn",value:function(e){var t;e.show(!1,!0),e.setWidth(e.getWidth()),"collapse"===this.mode&&((t=this.hiddenColumns.indexOf(e))>-1&&this.hiddenColumns.splice(t,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}},{key:"update",value:function(){for(var e=!0;e;){var t="fitColumns"==this.table.modules.layout.getMode()?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),n=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-t;if(n<0){var o=this.columns[this.index];o?(this.hideColumn(o),this.index++):e=!1}else{var a=this.columns[this.index-1];a&&n>0&&n>=a.getWidth()?(this.showColumn(a),this.index--):e=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}}},{key:"generateCollapsedContent",value:function(){var e=this;this.table.rowManager.getDisplayRows().forEach(function(t){e.generateCollapsedRowContent(t)})}},{key:"generateCollapsedRowContent",value:function(e){var t,n;if(e.modules.responsiveLayout){for(t=e.modules.responsiveLayout.element;t.firstChild;)t.removeChild(t.firstChild);(n=this.collapseFormatter(this.generateCollapsedRowData(e)))&&t.appendChild(n)}}},{key:"generateCollapsedRowData",value:function(e){var t,n=this,o=e.getData(),a=[];return this.hiddenColumns.forEach(function(s){var r=s.getFieldValue(o);s.definition.title&&s.field&&(s.modules.format&&n.table.options.responsiveLayoutCollapseUseFormatters?(t={value:!1,data:{},getValue:function(){return r},getData:function(){return o},getElement:function(){return document.createElement("div")},getRow:function(){return e.getComponent()},getColumn:function(){return s.getComponent()}},a.push({field:s.field,title:s.definition.title,value:s.modules.format.formatter.call(n.table.modules.format,t,s.modules.format.params,function(e){e()})})):a.push({field:s.field,title:s.definition.title,value:r}))}),a}},{key:"formatCollapsedData",value:function(e){var t=document.createElement("table");return e.forEach(function(e){var n,o=document.createElement("tr"),a=document.createElement("td"),s=document.createElement("td"),r=document.createElement("strong");a.appendChild(r),this.langBind("columns|"+e.field,function(t){r.innerHTML=t||e.title}),e.value instanceof Node?((n=document.createElement("div")).appendChild(e.value),s.appendChild(n)):s.innerHTML=e.value,o.appendChild(a),o.appendChild(s),t.appendChild(o)},this),Object.keys(e).length?t:""}}]),s}();eL.moduleName="responsiveLayout";var eM=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).selecting=!1,n.lastClickedRow=!1,n.selectPrev=[],n.selectedRows=[],n.headerCheckboxElement=null,n.registerTableOption("selectable","highlight"),n.registerTableOption("selectableRangeMode","drag"),n.registerTableOption("selectableRollingSelection",!0),n.registerTableOption("selectablePersistence",!0),n.registerTableOption("selectableCheck",function(e,t){return!0}),n.registerTableFunction("selectRow",n.selectRows.bind(l(n))),n.registerTableFunction("deselectRow",n.deselectRows.bind(l(n))),n.registerTableFunction("toggleSelectRow",n.toggleRow.bind(l(n))),n.registerTableFunction("getSelectedRows",n.getSelectedRows.bind(l(n))),n.registerTableFunction("getSelectedData",n.getSelectedData.bind(l(n))),n.registerComponentFunction("row","select",n.selectRows.bind(l(n))),n.registerComponentFunction("row","deselect",n.deselectRows.bind(l(n))),n.registerComponentFunction("row","toggleSelect",n.toggleRow.bind(l(n))),n.registerComponentFunction("row","isSelected",n.isRowSelected.bind(l(n))),n}return o(r,[{key:"initialize",value:function(){!1!==this.table.options.selectable&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectable&&!this.table.options.selectablePersistence&&this.subscribe("data-refreshing",this.deselectRows.bind(this)))}},{key:"rowRetrieve",value:function(e,t){return"selected"===e?this.selectedRows:t}},{key:"rowDeleted",value:function(e){this._deselectRow(e,!0)}},{key:"clearSelectionData",value:function(e){this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],!0!==e&&this._rowSelectionChanged()}},{key:"initializeRow",value:function(e){var t=this,n=e.getElement(),o=function e(){setTimeout(function(){t.selecting=!1},50),document.body.removeEventListener("mouseup",e)};e.modules.select={selected:!1},t.table.options.selectableCheck.call(this.table,e.getComponent())?(n.classList.add("tabulator-selectable"),n.classList.remove("tabulator-unselectable"),t.table.options.selectable&&"highlight"!=t.table.options.selectable&&("click"===t.table.options.selectableRangeMode?n.addEventListener("click",this.handleComplexRowClick.bind(this,e)):(n.addEventListener("click",function(n){t.table.modExists("edit")&&t.table.modules.edit.getCurrentCell()||t.table._clearSelection(),t.selecting||t.toggleRow(e)}),n.addEventListener("mousedown",function(n){if(n.shiftKey)return t.table._clearSelection(),t.selecting=!0,t.selectPrev=[],document.body.addEventListener("mouseup",o),document.body.addEventListener("keyup",o),t.toggleRow(e),!1}),n.addEventListener("mouseenter",function(n){t.selecting&&(t.table._clearSelection(),t.toggleRow(e),t.selectPrev[1]==e&&t.toggleRow(t.selectPrev[0]))}),n.addEventListener("mouseout",function(n){t.selecting&&(t.table._clearSelection(),t.selectPrev.unshift(e))})))):(n.classList.add("tabulator-unselectable"),n.classList.remove("tabulator-selectable"))}},{key:"handleComplexRowClick",value:function(e,t){var n=this;if(t.shiftKey){this.table._clearSelection(),this.lastClickedRow=this.lastClickedRow||e;var o=this.table.rowManager.getDisplayRowIndex(this.lastClickedRow),a=this.table.rowManager.getDisplayRowIndex(e),s=o<=a?o:a,r=o>=a?o:a,l=this.table.rowManager.getDisplayRows().slice(0).splice(s,r-s+1);t.ctrlKey||t.metaKey?(l.forEach(function(t){t!==n.lastClickedRow&&(!0===n.table.options.selectable||n.isRowSelected(e)?n.toggleRow(t):n.selectedRows.length<n.table.options.selectable&&n.toggleRow(t))}),this.lastClickedRow=e):(this.deselectRows(void 0,!0),!0!==this.table.options.selectable&&l.length>this.table.options.selectable&&(l=l.slice(0,this.table.options.selectable)),this.selectRows(l)),this.table._clearSelection()}else t.ctrlKey||t.metaKey?(this.toggleRow(e),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.selectRows(e),this.lastClickedRow=e)}},{key:"toggleRow",value:function(e){this.table.options.selectableCheck.call(this.table,e.getComponent())&&(e.modules.select&&e.modules.select.selected?this._deselectRow(e):this._selectRow(e))}},{key:"selectRows",value:function(t){var n,o=this;switch(e(t)){case"undefined":this.table.rowManager.rows.forEach(function(e){o._selectRow(e,!0,!0)}),this._rowSelectionChanged();break;case"string":(n=this.table.rowManager.findRow(t))?this._selectRow(n,!0,!0):this.table.rowManager.getRows(t).forEach(function(e){o._selectRow(e,!0,!0)}),this._rowSelectionChanged();break;default:Array.isArray(t)?(t.forEach(function(e){o._selectRow(e,!0,!0)}),this._rowSelectionChanged()):this._selectRow(t,!1,!0)}}},{key:"_selectRow",value:function(e,t,n){if(!isNaN(this.table.options.selectable)&&!0!==this.table.options.selectable&&!n&&this.selectedRows.length>=this.table.options.selectable){if(!this.table.options.selectableRollingSelection)return!1;this._deselectRow(this.selectedRows[0])}var o=this.table.rowManager.findRow(e);o?-1==this.selectedRows.indexOf(o)&&(o.getElement().classList.add("tabulator-selected"),o.modules.select||(o.modules.select={}),o.modules.select.selected=!0,o.modules.select.checkboxEl&&(o.modules.select.checkboxEl.checked=!0),this.selectedRows.push(o),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(o,!0),this.dispatchExternal("rowSelected",o.getComponent()),this._rowSelectionChanged(t)):t||console.warn("Selection Error - No such row found, ignoring selection:"+e)}},{key:"isRowSelected",value:function(e){return -1!==this.selectedRows.indexOf(e)}},{key:"deselectRows",value:function(e,t){var n,o=this;if(void 0===e){n=o.selectedRows.length;for(var a=0;a<n;a++)o._deselectRow(o.selectedRows[0],!0);n&&o._rowSelectionChanged(t)}else Array.isArray(e)?(e.forEach(function(e){o._deselectRow(e,!0)}),o._rowSelectionChanged(t)):o._deselectRow(e,t)}},{key:"_deselectRow",value:function(e,t){var n,o=this.table.rowManager.findRow(e);o?(n=this.selectedRows.findIndex(function(e){return e==o}))>-1&&(o.getElement().classList.remove("tabulator-selected"),o.modules.select||(o.modules.select={}),o.modules.select.selected=!1,o.modules.select.checkboxEl&&(o.modules.select.checkboxEl.checked=!1),this.selectedRows.splice(n,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(o,!1),this.dispatchExternal("rowDeselected",o.getComponent()),this._rowSelectionChanged(t)):t||console.warn("Deselection Error - No such row found, ignoring selection:"+e)}},{key:"getSelectedData",value:function(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getData())}),e}},{key:"getSelectedRows",value:function(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getComponent())}),e}},{key:"_rowSelectionChanged",value:function(e){this.headerCheckboxElement&&(0===this.selectedRows.length?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),e||this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows())}},{key:"registerRowSelectCheckbox",value:function(e,t){e._row.modules.select||(e._row.modules.select={}),e._row.modules.select.checkboxEl=t}},{key:"registerHeaderSelectCheckbox",value:function(e){this.headerCheckboxElement=e}},{key:"childRowSelection",value:function(e,t){var n=this.table.modules.dataTree.getChildren(e,!0);if(t){var o,a=h(n);try{for(a.s();!(o=a.n()).done;){var s=o.value;this._selectRow(s,!0)}}catch(r){a.e(r)}finally{a.f()}}else{var l,u=h(n);try{for(u.s();!(l=u.n()).done;){var c=l.value;this._deselectRow(c,!0)}}catch(d){u.e(d)}finally{u.f()}}}}]),r}();eM.moduleName="selectRow";var eD=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).sortList=[],n.changed=!1,n.registerTableOption("sortMode","local"),n.registerTableOption("initialSort",!1),n.registerTableOption("columnHeaderSortMulti",!0),n.registerTableOption("sortOrderReverse",!1),n.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),n.registerColumnOption("sorter"),n.registerColumnOption("sorterParams"),n.registerColumnOption("headerSort",!0),n.registerColumnOption("headerSortStartingDir"),n.registerColumnOption("headerSortTristate"),n}return o(r,[{key:"initialize",value:function(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),"remote"===this.table.options.sortMode&&this.subscribe("data-params",this.remoteSortParams.bind(this))}},{key:"tableBuilt",value:function(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}},{key:"remoteSortParams",value:function(e,t,n,o){var a=this.getSort();return a.forEach(function(e){delete e.column}),o.sort=a,o}},{key:"userSetSort",value:function(e,t){this.setSort(e,t),this.refreshSort()}},{key:"clearSort",value:function(){this.clear(),this.refreshSort()}},{key:"initializeColumn",value:function(t){var n,o,a=this,s=!1;switch(e(t.definition.sorter)){case"string":r.sorters[t.definition.sorter]?s=r.sorters[t.definition.sorter]:console.warn("Sort Error - No such sorter found: ",t.definition.sorter);break;case"function":s=t.definition.sorter}t.modules.sort={sorter:s,dir:"none",params:t.definition.sorterParams||{},startingDir:t.definition.headerSortStartingDir||"asc",tristate:t.definition.headerSortTristate},!1!==t.definition.headerSort&&((n=t.getElement()).classList.add("tabulator-sortable"),(o=document.createElement("div")).classList.add("tabulator-col-sorter"),"object"==e(this.table.options.headerSortElement)?o.appendChild(this.table.options.headerSortElement):o.innerHTML=this.table.options.headerSortElement,t.titleHolderElement.appendChild(o),t.modules.sort.element=o,n.addEventListener("click",function(e){var n="",o=[],s=!1;if(t.modules.sort){if(t.modules.sort.tristate)n="none"==t.modules.sort.dir?t.modules.sort.startingDir:t.modules.sort.dir==t.modules.sort.startingDir?"asc"==t.modules.sort.dir?"desc":"asc":"none";else switch(t.modules.sort.dir){case"asc":n="desc";break;case"desc":n="asc";break;default:n=t.modules.sort.startingDir}a.table.options.columnHeaderSortMulti&&(e.shiftKey||e.ctrlKey)?((s=(o=a.getSort()).findIndex(function(e){return e.field===t.getField()}))>-1?(o[s].dir=n,s!=o.length-1&&(s=o.splice(s,1)[0],"none"!=n&&o.push(s))):"none"!=n&&o.push({column:t,dir:n}),a.setSort(o)):"none"==n?a.clear():a.setSort(t,n),a.refreshSort()}}))}},{key:"refreshSort",value:function(){"remote"===this.table.options.sortMode?this.reloadData():this.refreshData(!0)}},{key:"hasChanged",value:function(){var e=this.changed;return this.changed=!1,e}},{key:"getSort",value:function(){var e=[];return this.sortList.forEach(function(t){t.column&&e.push({column:t.column.getComponent(),field:t.column.getField(),dir:t.dir})}),e}},{key:"setSort",value:function(e,t){var n=this,o=[];Array.isArray(e)||(e=[{column:e,dir:t}]),e.forEach(function(e){var t;(t=n.table.columnManager.findColumn(e.column))?(e.column=t,o.push(e),n.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",e.column)}),n.sortList=o,this.dispatch("sort-changed")}},{key:"clear",value:function(){this.setSort([])}},{key:"findSorter",value:function(t){var n,o=this.table.rowManager.activeRows[0],a="string";if(o&&(o=o.getData(),t.getField()))switch(e(n=t.getFieldValue(o))){case"undefined":a="string";break;case"boolean":a="boolean";break;default:isNaN(n)||""===n?n.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(a="alphanum"):a="number"}return r.sorters[a]}},{key:"sort",value:function(e){var t=this,n=this.table.options.sortOrderReverse?t.sortList.slice().reverse():t.sortList,o=[],a=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",t.getSort()),t.clearColumnHeaders(),"remote"!==this.table.options.sortMode?(n.forEach(function(e,n){var a=e.column.modules.sort;e.column&&a&&(a.sorter||(a.sorter=t.findSorter(e.column)),e.params="function"==typeof a.params?a.params(e.column.getComponent(),e.dir):a.params,o.push(e)),t.setColumnHeader(e.column,e.dir)}),o.length&&t._sortItems(e,o)):n.forEach(function(e,n){t.setColumnHeader(e.column,e.dir)}),this.subscribedExternal("dataSorted")&&(e.forEach(function(e){a.push(e.getComponent())}),this.dispatchExternal("dataSorted",t.getSort(),a)),e}},{key:"clearColumnHeaders",value:function(){this.table.columnManager.getRealColumns().forEach(function(e){e.modules.sort&&(e.modules.sort.dir="none",e.getElement().setAttribute("aria-sort","none"))})}},{key:"setColumnHeader",value:function(e,t){e.modules.sort.dir=t,e.getElement().setAttribute("aria-sort",t)}},{key:"_sortItems",value:function(e,t){var n=this,o=t.length-1;e.sort(function(e,a){for(var s,r=o;r>=0;r--){var l=t[r];if(0!==(s=n._sortRow(e,a,l.column,l.dir,l.params)))break}return s})}},{key:"_sortRow",value:function(e,t,n,o,a){var s,r,l="asc"==o?e:t,u="asc"==o?t:e;return e=void 0!==(e=n.getFieldValue(l.getData()))?e:"",t=void 0!==(t=n.getFieldValue(u.getData()))?t:"",s=l.getComponent(),r=u.getComponent(),n.modules.sort.sorter.call(this,e,t,s,r,n.getComponent(),o,a)}}]),r}();eD.moduleName="sort",eD.sorters={number:function(e,t,n,o,a,s,r){var l=r.alignEmptyValues,u=r.decimalSeparator,h=r.thousandSeparator,c=0;if(e=String(e),t=String(t),h&&(e=e.split(h).join(""),t=t.split(h).join("")),u&&(e=e.split(u).join("."),t=t.split(u).join(".")),e=parseFloat(e),t=parseFloat(t),isNaN(e))c=isNaN(t)?0:-1;else{if(!isNaN(t))return e-t;c=1}return("top"===l&&"desc"===s||"bottom"===l&&"asc"===s)&&(c*=-1),c},string:function(t,n,o,a,s,r,l){var u,h=l.alignEmptyValues,c=0;if(t){if(n){switch(e(l.locale)){case"boolean":l.locale&&(u=this.langLocale());break;case"string":u=l.locale}return String(t).toLowerCase().localeCompare(String(n).toLowerCase(),u)}c=1}else c=n?-1:0;return("top"===h&&"desc"===r||"bottom"===h&&"asc"===r)&&(c*=-1),c},boolean:function(e,t,n,o,a,s,r){return(!0===e||"true"===e||"True"===e||1===e?1:0)-(!0===t||"true"===t||"True"===t||1===t?1:0)},array:function(e,t,n,o,a,s,r){var l=r.type||"length",u=r.alignEmptyValues,h=0;function c(e){switch(l){case"length":return e.length;case"sum":return e.reduce(function(e,t){return e+t});case"max":return Math.max.apply(null,e);case"min":return Math.min.apply(null,e);case"avg":return e.reduce(function(e,t){return e+t})/e.length}}if(Array.isArray(e)){if(Array.isArray(t))return(e?c(e):0)-(t?c(t):0);u=1}else u=Array.isArray(t)?-1:0;return("top"===u&&"desc"===s||"bottom"===u&&"asc"===s)&&(h*=-1),h},exists:function(e,t,n,o,a,s,r){return(void 0===e?0:1)-(void 0===t?0:1)},alphanum:function(e,t,n,o,a,s,r){var l,u,h,c,d,p=0,m=/(\d+)|(\D+)/g,f=/\d/,g=r.alignEmptyValues,v=0;if(e||0===e){if(t||0===t){if(isFinite(e)&&isFinite(t))return e-t;if((l=String(e).toLowerCase())===(u=String(t).toLowerCase()))return 0;if(!f.test(l)||!f.test(u))return l>u?1:-1;for(l=l.match(m),u=u.match(m),d=l.length>u.length?u.length:l.length;p<d;)if((h=l[p])!==(c=u[p++]))return isFinite(h)&&isFinite(c)?("0"===h.charAt(0)&&(h="."+h),"0"===c.charAt(0)&&(c="."+c),h-c):h>c?1:-1;return l.length>u.length}v=1}else v=t||0===t?-1:0;return("top"===g&&"desc"===s||"bottom"===g&&"asc"===s)&&(v*=-1),v}};var ez=function(e){a(s,H);var n=u(s);function s(e){var o;return t(this,s),(o=n.call(this,e)).tooltipSubscriber=null,o.headerSubscriber=null,o.timeout=null,o.popupInstance=null,o.registerTableOption("tooltipGenerationMode",void 0),o.registerTableOption("tooltipDelay",300),o.registerColumnOption("tooltip"),o.registerColumnOption("headerTooltip"),o}return o(s,[{key:"initialize",value:function(){this.deprecationCheck(),this.subscribe("column-init",this.initializeColumn.bind(this))}},{key:"deprecationCheck",value:function(){void 0!==this.table.options.tooltipGenerationMode&&console.warn("Use of the tooltipGenerationMode option is now deprecated. This option is no longer needed as tooltips are always generated on hover now")}},{key:"initializeColumn",value:function(e){e.definition.headerTooltip&&!this.headerSubscriber&&(this.headerSubscriber=!0,this.subscribe("column-mousemove",this.mousemoveCheck.bind(this,"headerTooltip")),this.subscribe("column-mouseout",this.mouseoutCheck.bind(this,"headerTooltip"))),e.definition.tooltip&&!this.tooltipSubscriber&&(this.tooltipSubscriber=!0,this.subscribe("cell-mousemove",this.mousemoveCheck.bind(this,"tooltip")),this.subscribe("cell-mouseout",this.mouseoutCheck.bind(this,"tooltip")))}},{key:"mousemoveCheck",value:function(e,t,n){var o="tooltip"===e?n.column.definition.tooltip:n.definition.headerTooltip;o&&(this.clearPopup(),this.timeout=setTimeout(this.loadTooltip.bind(this,t,n,o),this.table.options.tooltipDelay))}},{key:"mouseoutCheck",value:function(e,t,n){this.popupInstance||this.clearPopup()}},{key:"clearPopup",value:function(e,t,n){clearTimeout(this.timeout),this.timeout=null,this.popupInstance&&this.popupInstance.hide()}},{key:"loadTooltip",value:function(e,t,n){var o,a,s,r=this;"function"==typeof n&&(n=n(e,t.getComponent(),function(e){a=e})),n instanceof HTMLElement?o=n:(o=document.createElement("div"),!0===n&&(t instanceof f?n=t.value:t.definition.field?this.langBind("columns|"+t.definition.field,function(e){o.innerHTML=n=e||t.definition.title}):n=t.definition.title),o.innerHTML=n),(n||0===n||"0"===n||!1===n)&&(o.classList.add("tabulator-tooltip"),o.addEventListener("mousemove",function(e){return e.preventDefault()}),this.popupInstance=this.popup(o),"function"==typeof a&&this.popupInstance.renderCallback(a),s=this.popupInstance.containerEventCoords(e),this.popupInstance.show(s.x+15,s.y+15).hideOnBlur(function(){r.dispatchExternal("TooltipClosed",t.getComponent()),r.popupInstance=null}),this.dispatchExternal("TooltipOpened",t.getComponent()))}}]),s}();ez.moduleName="tooltip";var eP=function(n){a(r,H);var s=u(r);function r(e){var n;return t(this,r),(n=s.call(this,e)).invalidCells=[],n.registerTableOption("validationMode","blocking"),n.registerColumnOption("validator"),n.registerTableFunction("getInvalidCells",n.getInvalidCells.bind(l(n))),n.registerTableFunction("clearCellValidation",n.userClearCellValidation.bind(l(n))),n.registerTableFunction("validate",n.userValidate.bind(l(n))),n.registerComponentFunction("cell","isValid",n.cellIsValid.bind(l(n))),n.registerComponentFunction("cell","clearValidation",n.clearValidation.bind(l(n))),n.registerComponentFunction("cell","validate",n.cellValidate.bind(l(n))),n.registerComponentFunction("column","validate",n.columnValidate.bind(l(n))),n.registerComponentFunction("row","validate",n.rowValidate.bind(l(n))),n}return o(r,[{key:"initialize",value:function(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("edit-success",this.editValidate.bind(this)),this.subscribe("edit-editor-clear",this.editorClear.bind(this)),this.subscribe("edit-edited-clear",this.editedClear.bind(this))}},{key:"editValidate",value:function(e,t,n){var o=this,a="manual"===this.table.options.validationMode||this.validate(e.column.modules.validate,e,t);return!0!==a&&setTimeout(function(){e.getElement().classList.add("tabulator-validation-fail"),o.dispatchExternal("validationFailed",e.getComponent(),t,a)}),a}},{key:"editorClear",value:function(e,t){t&&e.column.modules.validate&&this.cellValidate(e),e.getElement().classList.remove("tabulator-validation-fail")}},{key:"editedClear",value:function(e){e.modules.validate&&(e.modules.validate.invalid=!1)}},{key:"cellIsValid",value:function(e){return e.modules.validate&&e.modules.validate.invalid||!0}},{key:"cellValidate",value:function(e){return this.validate(e.column.modules.validate,e,e.getValue())}},{key:"columnValidate",value:function(e){var t=this,n=[];return e.cells.forEach(function(e){t.cellValidate(e)||n.push(e.getComponent())}),!n.length||n}},{key:"rowValidate",value:function(e){var t=this,n=[];return e.cells.forEach(function(e){t.cellValidate(e)||n.push(e.getComponent())}),!n.length||n}},{key:"userClearCellValidation",value:function(e){var t=this;e||(e=this.getInvalidCells()),Array.isArray(e)||(e=[e]),e.forEach(function(e){t.clearValidation(e._getSelf())})}},{key:"userValidate",value:function(e){var t=[];return this.table.rowManager.rows.forEach(function(e){var n=(e=e.getComponent()).validate();!0!==n&&(t=t.concat(n))}),!t.length||t}},{key:"initializeColumnCheck",value:function(e){void 0!==e.definition.validator&&this.initializeColumn(e)}},{key:"initializeColumn",value:function(e){var t,n=this,o=[];e.definition.validator&&(Array.isArray(e.definition.validator)?e.definition.validator.forEach(function(e){(t=n._extractValidator(e))&&o.push(t)}):(t=this._extractValidator(e.definition.validator))&&o.push(t),e.modules.validate=!!o.length&&o)}},{key:"_extractValidator",value:function(t){var n,o,a;switch(e(t)){case"string":return(a=t.indexOf(":"))>-1?(n=t.substring(0,a),o=t.substring(a+1)):n=t,this._buildValidator(n,o);case"function":return this._buildValidator(t);case"object":return this._buildValidator(t.type,t.parameters)}}},{key:"_buildValidator",value:function(e,t){var n="function"==typeof e?e:r.validators[e];return n?{type:"function"==typeof e?"function":e,func:n,params:t}:(console.warn("Validator Setup Error - No matching validator found:",e),!1)}},{key:"validate",value:function(e,t,n){var o=this,a=[],s=this.invalidCells.indexOf(t);return e&&e.forEach(function(e){e.func.call(o,t.getComponent(),n,e.params)||a.push({type:e.type,parameters:e.params})}),t.modules.validate||(t.modules.validate={}),a.length?(t.modules.validate.invalid=a,"manual"!==this.table.options.validationMode&&t.getElement().classList.add("tabulator-validation-fail"),-1==s&&this.invalidCells.push(t)):(t.modules.validate.invalid=!1,t.getElement().classList.remove("tabulator-validation-fail"),s>-1&&this.invalidCells.splice(s,1)),!a.length||a}},{key:"getInvalidCells",value:function(){var e=[];return this.invalidCells.forEach(function(t){e.push(t.getComponent())}),e}},{key:"clearValidation",value:function(e){var t;e.modules.validate&&e.modules.validate.invalid&&(e.getElement().classList.remove("tabulator-validation-fail"),e.modules.validate.invalid=!1,(t=this.invalidCells.indexOf(e))>-1&&this.invalidCells.splice(t,1))}}]),r}();eP.moduleName="validate",eP.validators={integer:function(e,t,n){return""===t||null==t||"number"==typeof(t=Number(t))&&isFinite(t)&&Math.floor(t)===t},float:function(e,t,n){return""===t||null==t||"number"==typeof(t=Number(t))&&isFinite(t)&&t%1!=0},numeric:function(e,t,n){return""===t||null==t||!isNaN(t)},string:function(e,t,n){return""===t||null==t||isNaN(t)},max:function(e,t,n){return""===t||null==t||parseFloat(t)<=n},min:function(e,t,n){return""===t||null==t||parseFloat(t)>=n},starts:function(e,t,n){return""===t||null==t||String(t).toLowerCase().startsWith(String(n).toLowerCase())},ends:function(e,t,n){return""===t||null==t||String(t).toLowerCase().endsWith(String(n).toLowerCase())},minLength:function(e,t,n){return""===t||null==t||String(t).length>=n},maxLength:function(e,t,n){return""===t||null==t||String(t).length<=n},in:function(e,t,n){return""===t||null==t||("string"==typeof n&&(n=n.split("|")),""===t||n.indexOf(t)>-1)},regex:function(e,t,n){return""===t||null==t||RegExp(n).test(t)},unique:function(e,t,n){if(""===t||null==t)return!0;var o=!0,a=e.getData(),s=e.getColumn()._getSelf();return this.table.rowManager.rows.forEach(function(e){var n=e.getData();n!==a&&t==s.getFieldValue(n)&&(o=!1)}),o},required:function(e,t,n){return""!==t&&null!=t}};var eS=Object.freeze({__proto__:null,AccessorModule:j,AjaxModule:q,ClipboardModule:X,ColumnCalcsModule:Y,DataTreeModule:J,DownloadModule:Q,EditModule:et,ExportModule:eo,FilterModule:ea,FormatModule:es,FrozenColumnsModule:er,FrozenRowsModule:el,GroupRowsModule:ec,HistoryModule:ed,HtmlTableImportModule:ep,ImportModule:em,InteractionModule:ef,KeybindingsModule:eg,MenuModule:ev,MoveColumnsModule:eb,MoveRowsModule:ey,MutatorModule:ew,PageModule:eC,PersistenceModule:ek,PopupModule:eE,PrintModule:e$,ReactiveDataModule:e_,ResizeColumnsModule:eR,ResizeRowsModule:ex,ResizeTableModule:eT,ResponsiveLayoutModule:eL,SelectRowModule:eM,SortModule:eD,TooltipModule:ez,ValidateModule:eP}),eF=function(e){a(o,G);var n=u(o);function o(){return t(this,o),n.apply(this,arguments)}return o}();return new N(eF,eS),eF});